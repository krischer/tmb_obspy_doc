<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.taup.slowness_model &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.taup.slowness_model</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Slowness model class.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>

<span class="kn">from</span> <span class="nn">copy</span> <span class="k">import</span> <span class="n">deepcopy</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">obspy.core.util.decorator</span> <span class="k">import</span> <span class="n">deprecated</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">_DEFAULT_VALUES</span>
<span class="kn">from</span> <span class="nn">.helper_classes</span> <span class="k">import</span> <span class="p">(</span><span class="n">CriticalDepth</span><span class="p">,</span> <span class="n">DepthRange</span><span class="p">,</span> <span class="n">SlownessLayer</span><span class="p">,</span>
                             <span class="n">SlownessModelError</span><span class="p">,</span> <span class="n">SplitLayerInfo</span><span class="p">,</span> <span class="n">TimeDist</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.slowness_layer</span> <span class="k">import</span> <span class="p">(</span><span class="n">bullen_depth_for</span><span class="p">,</span>
                             <span class="n">bullen_radial_slowness</span><span class="p">,</span> <span class="n">create_from_vlayer</span><span class="p">,</span>
                             <span class="n">evaluate_at_bullen</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.velocity_layer</span> <span class="k">import</span> <span class="p">(</span><span class="n">VelocityLayer</span><span class="p">,</span> <span class="n">evaluate_velocity_at_bottom</span><span class="p">,</span>
                             <span class="n">evaluate_velocity_at_top</span><span class="p">)</span>


<div class="viewcode-block" id="_fix_critical_depths"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model._fix_critical_depths.html#obspy.taup.slowness_model._fix_critical_depths">[docs]</a><span class="k">def</span> <span class="nf">_fix_critical_depths</span><span class="p">(</span><span class="n">critical_depths</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;p_layer_num&#39;</span> <span class="k">if</span> <span class="n">is_p_wave</span> <span class="k">else</span> <span class="s1">&#39;s_layer_num&#39;</span>

    <span class="n">mask</span> <span class="o">=</span> <span class="n">critical_depths</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">layer_num</span>
    <span class="n">critical_depths</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="SlownessModel"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.html#obspy.taup.slowness_model.SlownessModel">[docs]</a><span class="k">class</span> <span class="nc">SlownessModel</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Storage and methods for generating slowness-depth pairs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="SlownessModel.__init__"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.__init__.html#obspy.taup.slowness_model.SlownessModel.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">v_mod</span><span class="p">,</span> <span class="n">min_delta_p</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">max_delta_p</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span>
                 <span class="n">max_depth_interval</span><span class="o">=</span><span class="mi">115</span><span class="p">,</span>
                 <span class="n">max_range_interval</span><span class="o">=</span><span class="mf">2.5</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span><span class="p">,</span>
                 <span class="n">max_interp_error</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">allow_inner_core_s</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                 <span class="n">slowness_tolerance</span><span class="o">=</span><span class="n">_DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;slowness_tolerance&quot;</span><span class="p">],</span>
                 <span class="n">skip_model_creation</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># NB if the following are actually cleared (lists are mutable) every</span>
        <span class="c1"># time create_sample is called, maybe it would be better to just put</span>
        <span class="c1"># these initialisations into the relevant methods? They do have to be</span>
        <span class="c1"># persistent across method calls in create_sample though, so don&#39;t.</span>

        <span class="c1"># Stores the layer number for layers in the velocity model with a</span>
        <span class="c1"># critical point at their top. These form the &quot;branches&quot; of slowness</span>
        <span class="c1"># sampling.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># will be list of CriticalDepth objects</span>
        <span class="c1"># Store depth ranges that contains a high slowness zone for P/S. Stored</span>
        <span class="c1"># as DepthRange objects, containing the top depth and bottom depth.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># will be list of DepthRanges</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Stores depth ranges that are fluid, ie S velocity is zero. Stored as</span>
        <span class="c1"># DepthRange objects, containing the top depth and bottom depth.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluid_layer_depths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># For methods that have an is_p_wave parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span> <span class="o">=</span> <span class="n">v_mod</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_delta_p</span> <span class="o">=</span> <span class="n">min_delta_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_delta_p</span> <span class="o">=</span> <span class="n">max_delta_p</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_depth_interval</span> <span class="o">=</span> <span class="n">max_depth_interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_range_interval</span> <span class="o">=</span> <span class="n">max_range_interval</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_interp_error</span> <span class="o">=</span> <span class="n">max_interp_error</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">allow_inner_core_s</span> <span class="o">=</span> <span class="n">allow_inner_core_s</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">slowness_tolerance</span> <span class="o">=</span> <span class="n">slowness_tolerance</span>
        <span class="k">if</span> <span class="n">skip_model_creation</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_sample</span><span class="p">()</span></div>

<div class="viewcode-block" id="SlownessModel.__str__"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.__str__.html#obspy.taup.slowness_model.SlownessModel.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">desc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
            <span class="s2">&quot;radius_of_planet=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> max_delta_p=&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_delta_p</span><span class="p">),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> min_delta_p=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">min_delta_p</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> max_depth_interval=&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_depth_interval</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> max_range_interval=&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_range_interval</span><span class="p">),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> allow_inner_core_s=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">allow_inner_core_s</span><span class="p">),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> slownessTolerance=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">slowness_tolerance</span><span class="p">),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> get_num_layers(&#39;P&#39;)=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_num_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> get_num_layers(&#39;S&#39;)=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_num_layers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> fluid_layer_depths.size()=&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fluid_layer_depths</span><span class="p">)),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> high_slowness_layer_depths_p.size()=&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span><span class="p">)),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> high_slowness_layer_depths_s.size()=&quot;</span><span class="p">,</span>
            <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span><span class="p">)),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> critical_depths.size()=&quot;</span><span class="p">,</span>
            <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">))</span>
             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="s1">&#39;N/A&#39;</span><span class="p">),</span>
            <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">])</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;**** Critical Depth Layers ************************</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">)</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">**** Fluid Layer Depths ************************</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">fl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluid_layer_depths</span><span class="p">:</span>
            <span class="n">desc</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fl</span><span class="o">.</span><span class="n">top_depth</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fl</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">**** P High Slowness Layer Depths ****************</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">fl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span><span class="p">:</span>
            <span class="n">desc</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fl</span><span class="o">.</span><span class="n">top_depth</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fl</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">**** S High Slowness Layer Depths ****************</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">fl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span><span class="p">:</span>
            <span class="n">desc</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">fl</span><span class="o">.</span><span class="n">top_depth</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;,&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">fl</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="n">desc</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">**** P Layers ****************</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">:</span>
            <span class="n">desc</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">desc</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;createSample&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;create_sample&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">createSample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;createSample&#39; has been renamed to</span>
<span class="sd">        &#39;create_sample&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_sample</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.create_sample"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.create_sample.html#obspy.taup.slowness_model.SlownessModel.create_sample">[docs]</a>    <span class="k">def</span> <span class="nf">create_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create slowness-depth layers from a velocity model.</span>

<span class="sd">        This method takes a velocity model and creates a vector containing</span>
<span class="sd">        slowness-depth layers that, hopefully, adequately sample both slowness</span>
<span class="sd">        and depth so that the travel time as a function of distance can be</span>
<span class="sd">        reconstructed from the theta function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Some checks on the velocity model</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;velModel.get_num_layers()==0&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                <span class="s2">&quot;Unable to handle zero S velocity layers at surface. &quot;</span>
                <span class="s2">&quot;This should be fixed at some point, but is a limitation of &quot;</span>
                <span class="s2">&quot;TauP at this point.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;start create_sample&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;find_critical_points&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">find_critical_points</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;coarse_sample&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">coarse_sample</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ray_paramCheck&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ray_param_inc_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;depth_inc_check&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth_inc_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;distance_check&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distance_check</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;fix_critical_points&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fix_critical_points</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;create_sample seems to be done successfully.&quot;</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;findCriticalPoints&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;find_critical_points&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">findCriticalPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;findCriticalPoints&#39; has been renamed to</span>
<span class="sd">        &#39;find_critical_points&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_critical_points</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.find_critical_points"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.find_critical_points.html#obspy.taup.slowness_model.SlownessModel.find_critical_points">[docs]</a>    <span class="k">def</span> <span class="nf">find_critical_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find all critical points within a velocity model.</span>

<span class="sd">        Critical points are first order discontinuities in velocity/slowness,</span>
<span class="sd">        local extrema in slowness. A high slowness zone is a low velocity zone,</span>
<span class="sd">        but it is possible to have a slightly low velocity zone within a</span>
<span class="sd">        spherical planet that is not a high slowness zone and thus does not</span>
<span class="sd">        exhibit any of the pathological behavior of a low velocity zone.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">high_slowness_zone_p</span> <span class="o">=</span> <span class="n">DepthRange</span><span class="p">()</span>
        <span class="n">high_slowness_zone_s</span> <span class="o">=</span> <span class="n">DepthRange</span><span class="p">()</span>
        <span class="n">fluid_zone</span> <span class="o">=</span> <span class="n">DepthRange</span><span class="p">()</span>
        <span class="n">in_fluid_zone</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">below_outer_core</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">in_high_slowness_zone_p</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">in_high_slowness_zone_s</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># just some very big values (java had max possible of type,</span>
        <span class="c1"># but these should do)</span>
        <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="mf">1.1e300</span>
        <span class="n">min_s_so_far</span> <span class="o">=</span> <span class="mf">1.1e300</span>
        <span class="c1"># First remove any critical points previously stored</span>
        <span class="c1"># so these are effectively re-initialised... it&#39;s probably silly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">),</span>
                                        <span class="n">dtype</span><span class="o">=</span><span class="n">CriticalDepth</span><span class="p">)</span>
        <span class="n">cd_count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># lists of DepthRange</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fluid_layer_depths</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># Initialize the current velocity layer</span>
        <span class="c1"># to be zero thickness layer with values at the surface</span>
        <span class="n">curr_v_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">curr_v_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span>
            <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span>
            <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_p_velocity&#39;</span><span class="p">],</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_p_velocity&#39;</span><span class="p">],</span>
            <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">],</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">],</span>
            <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_density&#39;</span><span class="p">],</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_density&#39;</span><span class="p">],</span>
            <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_qp&#39;</span><span class="p">],</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_qp&#39;</span><span class="p">],</span>
            <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_qs&#39;</span><span class="p">],</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_qs&#39;</span><span class="p">])],</span>
            <span class="n">dtype</span><span class="o">=</span><span class="n">VelocityLayer</span><span class="p">)</span>

        <span class="n">curr_s_layer</span> <span class="o">=</span> <span class="n">create_from_vlayer</span><span class="p">(</span>
            <span class="n">v_layer</span><span class="o">=</span><span class="n">curr_v_layer</span><span class="p">,</span>
            <span class="n">is_p_wave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">,</span>
            <span class="n">radius_of_planet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
            <span class="n">is_spherical</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">)</span>
        <span class="n">curr_p_layer</span> <span class="o">=</span> <span class="n">create_from_vlayer</span><span class="p">(</span>
            <span class="n">v_layer</span><span class="o">=</span><span class="n">curr_v_layer</span><span class="p">,</span>
            <span class="n">is_p_wave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">,</span>
            <span class="n">radius_of_planet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
            <span class="n">is_spherical</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">)</span>

        <span class="c1"># We know that the top is always a critical slowness so add 0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="n">cd_count</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">cd_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Check to see if starting in fluid zone.</span>
        <span class="k">if</span> <span class="n">in_fluid_zone</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">in_fluid_zone</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">fluid_zone</span> <span class="o">=</span> <span class="n">DepthRange</span><span class="p">(</span><span class="n">top_depth</span><span class="o">=</span><span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
            <span class="n">curr_s_layer</span> <span class="o">=</span> <span class="n">curr_p_layer</span>
        <span class="k">if</span> <span class="n">min_s_so_far</span> <span class="o">&gt;</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]:</span>
            <span class="n">min_s_so_far</span> <span class="o">=</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span>
        <span class="c1"># P is not a typo, it represents slowness, not P-wave speed.</span>
        <span class="k">if</span> <span class="n">min_p_so_far</span> <span class="o">&gt;</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]:</span>
            <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
            <span class="n">prev_v_layer</span> <span class="o">=</span> <span class="n">curr_v_layer</span>
            <span class="n">prev_s_layer</span> <span class="o">=</span> <span class="n">curr_s_layer</span>
            <span class="n">prev_p_layer</span> <span class="o">=</span> <span class="n">curr_p_layer</span>
            <span class="c1"># Could make the following a deep copy, but not necessary.</span>
            <span class="c1"># Also don&#39;t just replace layer here and in the loop</span>
            <span class="c1"># control with curr_v_layer, or the reference to the first</span>
            <span class="c1"># zero thickness layer that has been initialised above</span>
            <span class="c1"># will break.</span>
            <span class="n">curr_v_layer</span> <span class="o">=</span> <span class="n">layer</span>
            <span class="c1"># Check again if in fluid zone</span>
            <span class="k">if</span> <span class="n">in_fluid_zone</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">in_fluid_zone</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">fluid_zone</span> <span class="o">=</span> <span class="n">DepthRange</span><span class="p">(</span><span class="n">top_depth</span><span class="o">=</span><span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
            <span class="c1"># If already in fluid zone, check if exited (java line 909)</span>
            <span class="k">if</span> <span class="n">in_fluid_zone</span> <span class="ow">is</span> <span class="kc">True</span> <span class="ow">and</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">prev_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">iocb_depth</span><span class="p">:</span>
                    <span class="n">below_outer_core</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">in_fluid_zone</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">fluid_zone</span><span class="o">.</span><span class="n">bot_depth</span> <span class="o">=</span> <span class="n">prev_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">fluid_layer_depths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fluid_zone</span><span class="p">)</span>

            <span class="n">curr_p_layer</span> <span class="o">=</span> <span class="n">create_from_vlayer</span><span class="p">(</span>
                <span class="n">v_layer</span><span class="o">=</span><span class="n">curr_v_layer</span><span class="p">,</span>
                <span class="n">is_p_wave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">,</span>
                <span class="n">radius_of_planet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
                <span class="n">is_spherical</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">)</span>

            <span class="c1"># If we are in a fluid zone ( S velocity = 0.0 ) or if we are below</span>
            <span class="c1"># the outer core and allow_inner_core_s=false then use the P</span>
            <span class="c1"># velocity structure to look for critical points.</span>
            <span class="k">if</span> <span class="n">in_fluid_zone</span> \
                    <span class="ow">or</span> <span class="p">(</span><span class="n">below_outer_core</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_inner_core_s</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>
                <span class="n">curr_s_layer</span> <span class="o">=</span> <span class="n">curr_p_layer</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">curr_s_layer</span> <span class="o">=</span> <span class="n">create_from_vlayer</span><span class="p">(</span>
                    <span class="n">v_layer</span><span class="o">=</span><span class="n">curr_v_layer</span><span class="p">,</span>
                    <span class="n">is_p_wave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">,</span>
                    <span class="n">radius_of_planet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
                    <span class="n">is_spherical</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">prev_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> \
                    <span class="ow">or</span> <span class="n">prev_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]:</span>
                <span class="c1"># a first order discontinuity</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="n">cd_count</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span>
                    <span class="n">layer_num</span><span class="p">,</span>
                    <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                    <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">cd_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First order discontinuity, depth =&#39;</span> <span class="o">+</span>
                          <span class="nb">str</span><span class="p">(</span><span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]))</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;between&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">prev_p_layer</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">curr_p_layer</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">in_high_slowness_zone_s</span> <span class="ow">and</span> \
                        <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_s_so_far</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top of current layer is the bottom&quot;</span>
                              <span class="s2">&quot; of a high slowness zone.&quot;</span><span class="p">)</span>
                    <span class="n">high_slowness_zone_s</span><span class="o">.</span><span class="n">bot_depth</span> <span class="o">=</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">high_slowness_zone_s</span><span class="p">)</span>
                    <span class="n">in_high_slowness_zone_s</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">if</span> <span class="n">in_high_slowness_zone_p</span> <span class="ow">and</span> \
                        <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_p_so_far</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Top of current layer is the bottom&quot;</span>
                              <span class="s2">&quot; of a high slowness zone.&quot;</span><span class="p">)</span>
                    <span class="n">high_slowness_zone_p</span><span class="o">.</span><span class="n">bot_depth</span> <span class="o">=</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">high_slowness_zone_p</span><span class="p">)</span>
                    <span class="n">in_high_slowness_zone_p</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="c1"># Update min_p_so_far and min_s_so_far as all total reflections</span>
                <span class="c1"># off of the top of the discontinuity are ok even though below</span>
                <span class="c1"># the discontinuity could be the start of a high slowness zone.</span>
                <span class="k">if</span> <span class="n">min_p_so_far</span> <span class="o">&gt;</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]:</span>
                    <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">min_s_so_far</span> <span class="o">&gt;</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]:</span>
                    <span class="n">min_s_so_far</span> <span class="o">=</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span>

                <span class="k">if</span> <span class="n">in_high_slowness_zone_s</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="n">prev_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="ow">or</span>
                        <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]):</span>
                    <span class="c1"># start of a high slowness zone S</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found S high slowness at first order &quot;</span> <span class="o">+</span>
                              <span class="s2">&quot;discontinuity, layer = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">layer_num</span><span class="p">))</span>
                    <span class="n">in_high_slowness_zone_s</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">high_slowness_zone_s</span> <span class="o">=</span> \
                        <span class="n">DepthRange</span><span class="p">(</span><span class="n">top_depth</span><span class="o">=</span><span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
                    <span class="n">high_slowness_zone_s</span><span class="o">.</span><span class="n">ray_param</span> <span class="o">=</span> <span class="n">min_s_so_far</span>
                <span class="k">if</span> <span class="n">in_high_slowness_zone_p</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span> <span class="p">(</span>
                        <span class="n">prev_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="ow">or</span>
                        <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]):</span>
                    <span class="c1"># start of a high slowness zone P</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found P high slowness at first order &quot;</span> <span class="o">+</span>
                              <span class="s2">&quot;discontinuity, layer = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">layer_num</span><span class="p">))</span>
                    <span class="n">in_high_slowness_zone_p</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">high_slowness_zone_p</span> <span class="o">=</span> \
                        <span class="n">DepthRange</span><span class="p">(</span><span class="n">top_depth</span><span class="o">=</span><span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
                    <span class="n">high_slowness_zone_p</span><span class="o">.</span><span class="n">ray_param</span> <span class="o">=</span> <span class="n">min_p_so_far</span>

            <span class="k">elif</span> <span class="p">((</span><span class="n">prev_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">*</span>
                  <span class="p">(</span><span class="n">prev_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                      <span class="p">(</span><span class="n">prev_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">*</span>
                      <span class="p">(</span><span class="n">prev_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># local slowness extrema, java l 1005</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="n">cd_count</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span>
                    <span class="n">layer_num</span><span class="p">,</span>
                    <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                    <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">cd_count</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;local slowness extrema, depth=&quot;</span> <span class="o">+</span>
                          <span class="nb">str</span><span class="p">(</span><span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]))</span>
                <span class="c1"># here is line 1014 of the java src!</span>
                <span class="k">if</span> <span class="n">in_high_slowness_zone_p</span> <span class="ow">is</span> <span class="kc">False</span> \
                        <span class="ow">and</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;start of a P high slowness zone, local &quot;</span>
                              <span class="s2">&quot;slowness extrema,min_p_so_far= &quot;</span> <span class="o">+</span>
                              <span class="nb">str</span><span class="p">(</span><span class="n">min_p_so_far</span><span class="p">))</span>
                    <span class="n">in_high_slowness_zone_p</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">high_slowness_zone_p</span> <span class="o">=</span> \
                        <span class="n">DepthRange</span><span class="p">(</span><span class="n">top_depth</span><span class="o">=</span><span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
                    <span class="n">high_slowness_zone_p</span><span class="o">.</span><span class="n">ray_param</span> <span class="o">=</span> <span class="n">min_p_so_far</span>
                <span class="k">if</span> <span class="n">in_high_slowness_zone_s</span> <span class="ow">is</span> <span class="kc">False</span> \
                        <span class="ow">and</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;start of a S high slowness zone, local &quot;</span>
                              <span class="s2">&quot;slowness extrema, min_s_so_far= &quot;</span> <span class="o">+</span>
                              <span class="nb">str</span><span class="p">(</span><span class="n">min_s_so_far</span><span class="p">))</span>
                    <span class="n">in_high_slowness_zone_s</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">high_slowness_zone_s</span> <span class="o">=</span> \
                        <span class="n">DepthRange</span><span class="p">(</span><span class="n">top_depth</span><span class="o">=</span><span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
                    <span class="n">high_slowness_zone_s</span><span class="o">.</span><span class="n">ray_param</span> <span class="o">=</span> <span class="n">min_s_so_far</span>

            <span class="k">if</span> <span class="n">in_high_slowness_zone_p</span> <span class="ow">and</span> \
                    <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_p_so_far</span><span class="p">:</span>
                <span class="c1"># P: layer contains the bottom of a high slowness zone. java</span>
                <span class="c1">#  l 1043</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;layer contains the bottom of a P &quot;</span> <span class="o">+</span>
                          <span class="s2">&quot;high slowness zone. min_p_so_far=&quot;</span> <span class="o">+</span>
                          <span class="nb">str</span><span class="p">(</span><span class="n">min_p_so_far</span><span class="p">),</span> <span class="n">curr_p_layer</span><span class="p">)</span>
                <span class="n">high_slowness_zone_p</span><span class="o">.</span><span class="n">bot_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth_from_layers</span><span class="p">(</span>
                    <span class="n">min_p_so_far</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">high_slowness_zone_p</span><span class="p">)</span>
                <span class="n">in_high_slowness_zone_p</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">if</span> <span class="n">in_high_slowness_zone_s</span> <span class="ow">and</span> \
                    <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">min_s_so_far</span><span class="p">:</span>
                <span class="c1"># S: layer contains the bottom of a high slowness zone. java</span>
                <span class="c1">#  l 1043</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;layer contains the bottom of a S &quot;</span> <span class="o">+</span>
                          <span class="s2">&quot;high slowness zone. min_s_so_far=&quot;</span> <span class="o">+</span>
                          <span class="nb">str</span><span class="p">(</span><span class="n">min_s_so_far</span><span class="p">),</span> <span class="n">curr_s_layer</span><span class="p">)</span>
                <span class="c1"># in fluid layers we want to check p_wave structure</span>
                <span class="c1"># when looking for S wave critical points</span>
                <span class="n">por_s</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span>
                         <span class="k">if</span> <span class="n">curr_s_layer</span> <span class="o">==</span> <span class="n">curr_p_layer</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>
                <span class="n">high_slowness_zone_s</span><span class="o">.</span><span class="n">bot_depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth_from_layers</span><span class="p">(</span>
                    <span class="n">min_s_so_far</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">por_s</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">high_slowness_zone_s</span><span class="p">)</span>
                <span class="n">in_high_slowness_zone_s</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">min_p_so_far</span> <span class="o">&gt;</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]:</span>
                <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">min_p_so_far</span> <span class="o">&gt;</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]:</span>
                <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="n">curr_p_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">min_s_so_far</span> <span class="o">&gt;</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]:</span>
                <span class="n">min_s_so_far</span> <span class="o">=</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">min_s_so_far</span> <span class="o">&gt;</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]:</span>
                <span class="n">min_s_so_far</span> <span class="o">=</span> <span class="n">curr_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">and</span> <span class="n">in_high_slowness_zone_s</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In S high slowness zone, layer_num = &quot;</span> <span class="o">+</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">layer_num</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; min_s_so_far=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">min_s_so_far</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">and</span> <span class="n">in_high_slowness_zone_p</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;In P high slowness zone, layer_num = &quot;</span> <span class="o">+</span>
                      <span class="nb">str</span><span class="p">(</span><span class="n">layer_num</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; min_p_so_far=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">min_p_so_far</span><span class="p">))</span>

        <span class="c1"># We know that the bottommost depth is always a critical slowness,</span>
        <span class="c1"># so we add v_mod.get_num_layers()</span>
        <span class="c1"># java line 1094</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="n">cd_count</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="p">),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">cd_count</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="c1"># Check if the bottommost depth is contained within a high slowness</span>
        <span class="c1"># zone, might happen in a flat non-whole-planet model</span>
        <span class="k">if</span> <span class="n">in_high_slowness_zone_s</span><span class="p">:</span>
            <span class="n">high_slowness_zone_s</span><span class="o">.</span><span class="n">bot_depth</span> <span class="o">=</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">high_slowness_zone_s</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">in_high_slowness_zone_p</span><span class="p">:</span>
            <span class="n">high_slowness_zone_p</span><span class="o">.</span><span class="n">bot_depth</span> <span class="o">=</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">high_slowness_zone_p</span><span class="p">)</span>

        <span class="c1"># Check if the bottommost depth is contained within a fluid zone, this</span>
        <span class="c1"># would be the case if we have a non whole planet model with the bottom</span>
        <span class="c1"># in the outer core or if allow_inner_core_s == false and we want to</span>
        <span class="c1"># use the P velocity structure in the inner core.</span>
        <span class="k">if</span> <span class="n">in_fluid_zone</span><span class="p">:</span>
            <span class="n">fluid_zone</span><span class="o">.</span><span class="n">bot_depth</span> <span class="o">=</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fluid_layer_depths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fluid_zone</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[:</span><span class="n">cd_count</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;getNumLayers&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;get_num_layers&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getNumLayers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;getNumLayers&#39; has been renamed to</span>
<span class="sd">        &#39;get_num_layers&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_num_layers</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.get_num_layers"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.get_num_layers.html#obspy.taup.slowness_model.SlownessModel.get_num_layers">[docs]</a>    <span class="k">def</span> <span class="nf">get_num_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Number of slowness layers.</span>

<span class="sd">        This is meant to return the number of P or S layers.</span>

<span class="sd">        :param is_p_wave: Return P layer count (``True``) or S layer count</span>
<span class="sd">            (``False``).</span>
<span class="sd">        :type is_p_wave: bool</span>
<span class="sd">        :returns: Number of slowness layers.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;findDepth_from_depths&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;find_depth_from_depths&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">findDepth_from_depths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;findDepth_from_depths&#39; has been renamed to</span>
<span class="sd">        &#39;find_depth_from_depths&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth_from_depths</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;findDepth_from_layers&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;find_depth_from_layers&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">findDepth_from_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;findDepth_from_layers&#39; has been renamed to</span>
<span class="sd">        &#39;find_depth_from_layers&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth_from_layers</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.find_depth_from_depths"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.find_depth_from_depths.html#obspy.taup.slowness_model.SlownessModel.find_depth_from_depths">[docs]</a>    <span class="k">def</span> <span class="nf">find_depth_from_depths</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ray_param</span><span class="p">,</span> <span class="n">top_depth</span><span class="p">,</span> <span class="n">bot_depth</span><span class="p">,</span>
                               <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find depth corresponding to a slowness between two given depths.</span>

<span class="sd">        The given depths are converted to layer numbers before calling</span>
<span class="sd">        :meth:`find_depth_from_layers`.</span>

<span class="sd">        :param ray_param: Slowness (aka ray parameter) to find, in s/km.</span>
<span class="sd">        :type ray_param: float</span>
<span class="sd">        :param top_depth: Top depth to search, in km.</span>
<span class="sd">        :type top_depth: float</span>
<span class="sd">        :param bot_depth: Bottom depth to search, in km.</span>
<span class="sd">        :type bot_depth: float</span>
<span class="sd">        :param is_p_wave: ``True`` if P wave or ``False`` for S wave.</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: Depth (in km) corresponding to the desired slowness.</span>
<span class="sd">        :rtype: float</span>

<span class="sd">        :raises SlownessModelError:</span>
<span class="sd">            If ``top_critical_layer &gt; bot_critical_layer``</span>
<span class="sd">            because there are no layers to search, or if there is an increase</span>
<span class="sd">            in slowness, i.e., a negative velocity gradient, that just balances</span>
<span class="sd">            the decrease in slowness due to the spherical planet, or if the ray</span>
<span class="sd">            parameter ``p`` is not contained within the specified layer range.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">top_layer_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layer_number_below</span><span class="p">(</span><span class="n">top_depth</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">top_layer_num</span><span class="p">][</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">top_depth</span><span class="p">:</span>
            <span class="n">top_layer_num</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">bot_layer_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layer_number_above</span><span class="p">(</span><span class="n">bot_depth</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">find_depth_from_layers</span><span class="p">(</span><span class="n">ray_param</span><span class="p">,</span> <span class="n">top_layer_num</span><span class="p">,</span>
                                           <span class="n">bot_layer_num</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span></div>

<div class="viewcode-block" id="SlownessModel.find_depth_from_layers"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.find_depth_from_layers.html#obspy.taup.slowness_model.SlownessModel.find_depth_from_layers">[docs]</a>    <span class="k">def</span> <span class="nf">find_depth_from_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">top_critical_layer</span><span class="p">,</span> <span class="n">bot_critical_layer</span><span class="p">,</span>
                               <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find depth corresponding to a slowness p between two velocity layers.</span>

<span class="sd">        Here, slowness is defined as ``(radius_of_planet-depth) / velocity``,</span>
<span class="sd">        and sometimes called ray parameter. Both the top and the bottom</span>
<span class="sd">        velocity layers are included. We also check to see if the slowness is</span>
<span class="sd">        less than the bottom slowness of these layers but greater than the top</span>
<span class="sd">        slowness of the next deeper layer. This corresponds to a total</span>
<span class="sd">        reflection. In this case a check needs to be made to see if this is an</span>
<span class="sd">        S wave reflecting off of a fluid layer, use P velocity below in this</span>
<span class="sd">        case. We assume that slowness is monotonic within these layers and</span>
<span class="sd">        therefore there is only one depth with the given slowness. This means</span>
<span class="sd">        we return the first depth that we find.</span>

<span class="sd">        :param p: Slowness (aka ray parameter) to find, in s/km.</span>
<span class="sd">        :type p: float</span>
<span class="sd">        :param top_critical_layer: Top layer number to search.</span>
<span class="sd">        :type top_critical_layer: int</span>
<span class="sd">        :param bot_critical_layer: Bottom layer number to search.</span>
<span class="sd">        :type bot_critical_layer: int</span>
<span class="sd">        :param is_p_wave: ``True`` if P wave or ``False`` for S wave.</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: Depth (in km) corresponding to the desired slowness.</span>
<span class="sd">        :rtype: float</span>

<span class="sd">        :raises SlownessModelError: If</span>
<span class="sd">            ``top_critical_layer &gt; bot_critical_layer``</span>
<span class="sd">            because there are no layers to search, or if there is an increase</span>
<span class="sd">            in slowness, i.e., a negative velocity gradient, that just balances</span>
<span class="sd">            the decrease in slowness due to the spherical planet, or if the ray</span>
<span class="sd">            parameter ``p`` is not contained within the specified layer range.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># top_p = 1.1e300  # dummy numbers</span>
        <span class="c1"># bot_p = 1.1e300</span>
        <span class="n">wave_type</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span> <span class="k">if</span> <span class="n">is_p_wave</span> <span class="k">else</span> <span class="s1">&#39;S&#39;</span>

        <span class="k">if</span> <span class="n">top_critical_layer</span> <span class="o">&gt;</span> <span class="n">bot_critical_layer</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                <span class="s2">&quot;findDepth: no layers to search (wrong layer num?)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">layer_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">top_critical_layer</span><span class="p">,</span> <span class="n">bot_critical_layer</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">vel_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">layer_num</span><span class="p">]</span>
            <span class="n">top_velocity</span> <span class="o">=</span> <span class="n">evaluate_velocity_at_top</span><span class="p">(</span><span class="n">vel_layer</span><span class="p">,</span> <span class="n">wave_type</span><span class="p">)</span>
            <span class="n">bot_velocity</span> <span class="o">=</span> <span class="n">evaluate_velocity_at_bottom</span><span class="p">(</span><span class="n">vel_layer</span><span class="p">,</span> <span class="n">wave_type</span><span class="p">)</span>
            <span class="n">top_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_slowness</span><span class="p">(</span><span class="n">top_velocity</span><span class="p">,</span> <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
            <span class="n">bot_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_slowness</span><span class="p">(</span><span class="n">bot_velocity</span><span class="p">,</span> <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">])</span>
            <span class="c1"># Check to see if we are within &#39;chatter level&#39; (numerical</span>
            <span class="c1"># error) of the top or bottom and if so then return that depth.</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">top_p</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slowness_tolerance</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">bot_p</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slowness_tolerance</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">top_p</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">bot_p</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Found layer containing p.</span>
                <span class="c1"># We interpolate assuming that velocity is linear within</span>
                <span class="c1"># this interval. So slope is the slope for velocity versus</span>
                <span class="c1"># depth.</span>
                <span class="n">slope</span> <span class="o">=</span> <span class="p">(</span><span class="n">bot_velocity</span> <span class="o">-</span> <span class="n">top_velocity</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                    <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
                <span class="n">depth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">top_velocity</span><span class="p">,</span>
                                         <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span> <span class="n">slope</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">depth</span>
            <span class="k">elif</span> <span class="n">layer_num</span> <span class="o">==</span> <span class="n">top_critical_layer</span> \
                    <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">top_p</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slowness_tolerance</span><span class="p">:</span>
                <span class="c1"># Check to see if p is just outside the topmost layer. If so</span>
                <span class="c1"># then return the top depth.</span>
                <span class="k">return</span> <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span>

            <span class="c1"># Is p a total reflection? bot_p is the slowness at the bottom</span>
            <span class="c1"># of the last velocity layer from the previous loop, set top_p</span>
            <span class="c1"># to be the slowness at the top of the next layer.</span>
            <span class="k">if</span> <span class="n">layer_num</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">vel_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">layer_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
                <span class="n">top_velocity</span> <span class="o">=</span> <span class="n">evaluate_velocity_at_top</span><span class="p">(</span><span class="n">vel_layer</span><span class="p">,</span> <span class="n">wave_type</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">is_p_wave</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span>
                        <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_in_fluid</span><span class="p">(</span><span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]))):</span>
                    <span class="c1"># Special case for S waves above a fluid. If top next</span>
                    <span class="c1"># layer is in a fluid then we should set top_velocity to</span>
                    <span class="c1"># be the P velocity at the top of the layer.</span>
                    <span class="n">top_velocity</span> <span class="o">=</span> <span class="n">evaluate_velocity_at_top</span><span class="p">(</span><span class="n">vel_layer</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">)</span>

                <span class="n">top_p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_slowness</span><span class="p">(</span><span class="n">top_velocity</span><span class="p">,</span> <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">bot_p</span> <span class="o">&gt;=</span> <span class="n">p</span> <span class="o">&gt;=</span> <span class="n">top_p</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">vel_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span>

        <span class="c1"># noinspection PyUnboundLocalVariable</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">bot_p</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slowness_tolerance</span><span class="p">:</span>
            <span class="c1"># java line 1275</span>
            <span class="c1"># Check to see if p is just outside the bottommost layer. If so</span>
            <span class="c1"># than return the bottom depth.</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; p is just outside the bottommost layer. This probably &quot;</span>
                  <span class="s2">&quot;shouldn&#39;t be allowed to happen!&quot;</span><span class="p">)</span>
            <span class="c1"># noinspection PyUnboundLocalVariable</span>
            <span class="k">return</span> <span class="n">vel_layer</span><span class="o">.</span><span class="n">getBotDepth</span><span class="p">()</span>
        <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
            <span class="s2">&quot;slowness p=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">+</span>
            <span class="s2">&quot; is not contained within the specified layers.&quot;</span> <span class="o">+</span>
            <span class="s2">&quot; top_critical_layer=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">top_critical_layer</span><span class="p">)</span> <span class="o">+</span>
            <span class="s2">&quot; bot_critical_layer=&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">bot_critical_layer</span><span class="p">))</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;toSlowness&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;to_slowness&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">toSlowness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;toSlowness&#39; has been renamed to</span>
<span class="sd">        &#39;to_slowness&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_slowness</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.to_slowness"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.to_slowness.html#obspy.taup.slowness_model.SlownessModel.to_slowness">[docs]</a>    <span class="k">def</span> <span class="nf">to_slowness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">velocity</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert velocity at some depth to slowness.</span>

<span class="sd">        :param velocity: The velocity to convert, in km/s.</span>
<span class="sd">        :type velocity: float</span>
<span class="sd">        :param depth: The depth (in km) at which to perform the calculation.</span>
<span class="sd">            Must be less than the radius of the planet defined in this</span>
<span class="sd">            model, or the result is undefined.</span>
<span class="sd">        :type depth: float</span>

<span class="sd">        :returns: The slowness, in s/km.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">velocity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                <span class="s2">&quot;to_slowness: velocity can&#39;t be zero, at depth&quot;</span> <span class="o">+</span>
                <span class="nb">str</span><span class="p">(</span><span class="n">depth</span><span class="p">),</span>
                <span class="s2">&quot;Maybe related to using S velocities in outer core?&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span> <span class="o">-</span> <span class="n">depth</span><span class="p">)</span> <span class="o">/</span> <span class="n">velocity</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;depthInFluid&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;depth_in_fluid&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">depthInFluid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;depthInFluid&#39; has been renamed to</span>
<span class="sd">        &#39;depth_in_fluid&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_in_fluid</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.interpolate"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.interpolate.html#obspy.taup.slowness_model.SlownessModel.interpolate">[docs]</a>    <span class="k">def</span> <span class="nf">interpolate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">top_velocity</span><span class="p">,</span> <span class="n">top_depth</span><span class="p">,</span> <span class="n">slope</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Interpolate slowness to depth within a layer.</span>

<span class="sd">        We interpolate assuming that velocity is linear within</span>
<span class="sd">        this interval.</span>

<span class="sd">        All parameters must be of the same shape.</span>

<span class="sd">        :param p: The slowness to interpolate, in s/km.</span>
<span class="sd">        :type p: :class:`float` or :class:`~numpy.ndarray`</span>
<span class="sd">        :param top_velocity: The velocity (in km/s) at the top of the layer.</span>
<span class="sd">        :type top_velocity: :class:`float` or :class:`~numpy.ndarray`</span>
<span class="sd">        :param top_depth: The depth (in km) for the top of the layer.</span>
<span class="sd">        :type top_depth: :class:`float` or :class:`~numpy.ndarray`</span>
<span class="sd">        :param slope: The slope (in (km/s)/km)  for velocity versus depth.</span>
<span class="sd">        :type slope: :class:`float` or :class:`~numpy.ndarray`</span>

<span class="sd">        :returns: The depth (in km) of the slowness below the layer boundary.</span>
<span class="sd">        :rtype: :class:`float` or :class:`~numpy.ndarray`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">denominator</span> <span class="o">=</span> <span class="n">p</span> <span class="o">*</span> <span class="n">slope</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">denominator</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                <span class="s2">&quot;Negative velocity gradient that just balances the slowness &quot;</span>
                <span class="s2">&quot;gradient of the spherical slowness, i.e. planet flattening. &quot;</span>
                <span class="s2">&quot;Instructions unclear; explode.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">depth</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span> <span class="o">+</span>
                     <span class="n">p</span> <span class="o">*</span> <span class="p">(</span><span class="n">top_depth</span> <span class="o">*</span> <span class="n">slope</span> <span class="o">-</span> <span class="n">top_velocity</span><span class="p">))</span> <span class="o">/</span> <span class="n">denominator</span>
            <span class="k">return</span> <span class="n">depth</span></div>

<div class="viewcode-block" id="SlownessModel.depth_in_fluid"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.depth_in_fluid.html#obspy.taup.slowness_model.SlownessModel.depth_in_fluid">[docs]</a>    <span class="k">def</span> <span class="nf">depth_in_fluid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine if the given depth is contained within a fluid zone.</span>

<span class="sd">        The fluid zone includes its upper boundary but not its lower boundary.</span>
<span class="sd">        The top and bottom of the fluid zone are not returned as a DepthRange,</span>
<span class="sd">        just like in the Java code, despite its claims to the contrary.</span>

<span class="sd">        :param depth: The depth to check, in km.</span>
<span class="sd">        :type depth: :class:`~numpy.ndarray`, dtype = :class:`float`</span>

<span class="sd">        :returns: ``True`` if the depth is within a fluid zone, ``False``</span>
<span class="sd">            otherwise.</span>
<span class="sd">        :rtype: :class:`~numpy.ndarray` (dtype = :class:`bool`)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">depth</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluid_layer_depths</span><span class="p">:</span>
            <span class="n">ret</span> <span class="o">|=</span> <span class="p">(</span><span class="n">elem</span><span class="o">.</span><span class="n">top_depth</span> <span class="o">&lt;=</span> <span class="n">depth</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="n">elem</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ret</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;coarseSample&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;coarse_sample&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">coarseSample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;coarseSample&#39; has been renamed to</span>
<span class="sd">        &#39;coarse_sample&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">coarse_sample</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.coarse_sample"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.coarse_sample.html#obspy.taup.slowness_model.SlownessModel.coarse_sample">[docs]</a>    <span class="k">def</span> <span class="nf">coarse_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a coarse slowness sampling of the velocity model (v_mod).</span>

<span class="sd">        The resultant slowness layers will satisfy the maximum depth increments</span>
<span class="sd">        as well as sampling each point specified within the VelocityModel. The</span>
<span class="sd">        P and S sampling will also be compatible.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span> <span class="o">=</span> <span class="n">create_from_vlayer</span><span class="p">(</span>
            <span class="n">v_layer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
            <span class="n">is_p_wave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">,</span>
            <span class="n">radius_of_planet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
            <span class="n">is_spherical</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">)</span>

        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span> <span class="o">=</span> <span class="n">create_from_vlayer</span><span class="p">(</span>
                <span class="n">v_layer</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">,</span>
                <span class="n">is_p_wave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">,</span>
                <span class="n">radius_of_planet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
                <span class="n">is_spherical</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_in_fluid</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_inner_core_s</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">|=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">iocb_depth</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

        <span class="c1"># Check for first order discontinuity. However, we only consider</span>
        <span class="c1"># S discontinuities in the inner core if allow_inner_core_s is true.</span>
        <span class="n">above</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">below</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
            <span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_p_velocity&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">below</span><span class="p">[</span><span class="s1">&#39;top_p_velocity&#39;</span><span class="p">],</span>
            <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_s_velocity&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">below</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">],</span>
                <span class="n">np</span><span class="o">.</span><span class="n">logical_or</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">allow_inner_core_s</span><span class="p">,</span>
                    <span class="n">below</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">iocb_depth</span><span class="p">)))</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">above</span> <span class="o">=</span> <span class="n">above</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">below</span> <span class="o">=</span> <span class="n">below</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

        <span class="c1"># If we are going from a fluid to a solid or solid to fluid, e.g., core</span>
        <span class="c1"># mantle or outer core to inner core then we need to use the P velocity</span>
        <span class="c1"># for determining the S discontinuity.</span>
        <span class="n">top_s_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_s_velocity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
                             <span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_p_velocity&#39;</span><span class="p">],</span>
                             <span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_s_velocity&#39;</span><span class="p">])</span>
        <span class="n">bot_s_vel</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">below</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
                             <span class="n">below</span><span class="p">[</span><span class="s1">&#39;top_p_velocity&#39;</span><span class="p">],</span>
                             <span class="n">below</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">])</span>

        <span class="c1"># Add the layer, with zero thickness but nonzero slowness step,</span>
        <span class="c1"># corresponding to the discontinuity.</span>
        <span class="n">curr_v_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">above</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">VelocityLayer</span><span class="p">)</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_p_velocity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_p_velocity&#39;</span><span class="p">]</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_p_velocity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">below</span><span class="p">[</span><span class="s1">&#39;top_p_velocity&#39;</span><span class="p">]</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">top_s_vel</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_s_velocity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_s_vel</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_density&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">_DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;density&quot;</span><span class="p">])</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_density&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">_DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;density&quot;</span><span class="p">])</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_qp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">_DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;qp&quot;</span><span class="p">])</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_qp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">_DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;qp&quot;</span><span class="p">])</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_qs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">_DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;qs&quot;</span><span class="p">])</span>
        <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;bot_qs&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">_DEFAULT_VALUES</span><span class="p">[</span><span class="s2">&quot;qs&quot;</span><span class="p">])</span>

        <span class="n">curr_p_layer</span> <span class="o">=</span> <span class="n">create_from_vlayer</span><span class="p">(</span>
            <span class="n">v_layer</span><span class="o">=</span><span class="n">curr_v_layer</span><span class="p">,</span>
            <span class="n">is_p_wave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">,</span>
            <span class="n">radius_of_planet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
            <span class="n">is_spherical</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">curr_p_layer</span><span class="p">)</span>

        <span class="n">curr_s_layer</span> <span class="o">=</span> <span class="n">create_from_vlayer</span><span class="p">(</span>
            <span class="n">v_layer</span><span class="o">=</span><span class="n">curr_v_layer</span><span class="p">,</span>
            <span class="n">is_p_wave</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">,</span>
            <span class="n">radius_of_planet</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
            <span class="n">is_spherical</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_spherical</span><span class="p">)</span>

        <span class="n">mask2</span> <span class="o">=</span> <span class="p">(</span><span class="n">above</span><span class="p">[</span><span class="s1">&#39;bot_s_velocity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">below</span><span class="p">[</span><span class="s1">&#39;top_s_velocity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_inner_core_s</span><span class="p">:</span>
            <span class="n">mask2</span> <span class="o">|=</span> <span class="n">curr_v_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">iocb_depth</span>
        <span class="n">curr_s_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask2</span><span class="p">,</span> <span class="n">curr_p_layer</span><span class="p">,</span> <span class="n">curr_s_layer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">curr_s_layer</span><span class="p">)</span>

        <span class="c1"># Make sure that all high slowness layers are sampled exactly</span>
        <span class="c1"># at their bottom</span>
        <span class="k">for</span> <span class="n">high_zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span><span class="p">:</span>
            <span class="n">s_layer_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_above</span><span class="p">(</span><span class="n">high_zone</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>
            <span class="n">high_s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">[</span><span class="n">s_layer_num</span><span class="p">]</span>
            <span class="k">while</span> <span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">high_zone</span><span class="o">.</span><span class="n">ray_param</span><span class="p">)</span> <span class="o">*</span>
                    <span class="p">(</span><span class="n">high_zone</span><span class="o">.</span><span class="n">ray_param</span> <span class="o">-</span> <span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">s_layer_num</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">high_s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">[</span><span class="n">s_layer_num</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">high_zone</span><span class="o">.</span><span class="n">ray_param</span> <span class="o">!=</span> <span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">high_zone</span><span class="o">.</span><span class="n">ray_param</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">high_zone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span><span class="p">:</span>
            <span class="n">s_layer_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_above</span><span class="p">(</span><span class="n">high_zone</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>
            <span class="n">high_s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">[</span><span class="n">s_layer_num</span><span class="p">]</span>
            <span class="k">while</span> <span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="ow">and</span> <span class="p">(</span>
                    <span class="p">(</span><span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">high_zone</span><span class="o">.</span><span class="n">ray_param</span><span class="p">)</span> <span class="o">*</span>
                    <span class="p">(</span><span class="n">high_zone</span><span class="o">.</span><span class="n">ray_param</span> <span class="o">-</span> <span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
                <span class="n">s_layer_num</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">high_s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">[</span><span class="n">s_layer_num</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">high_zone</span><span class="o">.</span><span class="n">ray_param</span> <span class="o">!=</span> <span class="n">high_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">high_zone</span><span class="o">.</span><span class="n">ray_param</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>

        <span class="c1"># Make sure P and S are consistent by adding discontinuities in one to</span>
        <span class="c1"># the other.</span>
        <span class="c1"># Numpy 1.6 compatibility</span>
        <span class="c1"># _tb = self.p_layers[[&#39;top_p&#39;, &#39;bot_p&#39;]]</span>
        <span class="n">_tb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">uniq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">_tb</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">uniq</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>

        <span class="c1"># Numpy 1.6 compatibility</span>
        <span class="c1"># _tb = self.p_layers[[&#39;top_p&#39;, &#39;bot_p&#39;]]</span>
        <span class="n">_tb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span>
                         <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
        <span class="n">uniq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">_tb</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">uniq</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;layerNumberAbove&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;layer_number_above&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">layerNumberAbove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;layerNumberAbove&#39; has been renamed to</span>
<span class="sd">        &#39;layer_number_above&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_above</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.layer_number_above"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.layer_number_above.html#obspy.taup.slowness_model.SlownessModel.layer_number_above">[docs]</a>    <span class="k">def</span> <span class="nf">layer_number_above</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the index of the slowness layer that contains the given depth.</span>

<span class="sd">        Note that if the depth is a layer boundary, it returns the shallower</span>
<span class="sd">        of the two or possibly more (since total reflections are zero</span>
<span class="sd">        thickness layers) layers.</span>

<span class="sd">        .. seealso:: :meth:`layer_number_below`</span>

<span class="sd">        :param depth: The depth to find, in km.</span>
<span class="sd">        :type depth: :class:`float` or :class:`~numpy.ndarray`</span>
<span class="sd">        :param is_p_wave: Whether to look at P (``True``) velocity or S</span>
<span class="sd">            (``False``) velocity.</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: The slowness layer containing the requested depth.</span>
<span class="sd">        :rtype: :class:`int` or :class:`~numpy.ndarray` (dtype = :class:`int`,</span>
<span class="sd">            shape = ``depth.shape``)</span>

<span class="sd">        :raises SlownessModelError: If no layer in the slowness model contains</span>
<span class="sd">            the given depth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span>

        <span class="c1"># Check to make sure depth is within the range available</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span> <span class="ow">or</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;No layer contains this depth&quot;</span><span class="p">)</span>

        <span class="n">found_layer_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span> <span class="n">depth</span><span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">found_layer_num</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">found_layer_num</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mask</span><span class="p">:</span>
                <span class="n">found_layer_num</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">found_layer_num</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">found_layer_num</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;layerNumberBelow&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;layer_number_below&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">layerNumberBelow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;layerNumberBelow&#39; has been renamed to</span>
<span class="sd">        &#39;layer_number_below&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_below</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.layer_number_below"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.layer_number_below.html#obspy.taup.slowness_model.SlownessModel.layer_number_below">[docs]</a>    <span class="k">def</span> <span class="nf">layer_number_below</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find the index of the slowness layer that contains the given depth.</span>

<span class="sd">        Note that if the depth is a layer boundary, it returns the deeper of</span>
<span class="sd">        the two or possibly more (since total reflections are zero thickness</span>
<span class="sd">        layers) layers.</span>

<span class="sd">        .. seealso:: :meth:`layer_number_above`</span>

<span class="sd">        :param depth: The depth to find, in km.</span>
<span class="sd">        :type depth: :class:`float` or :class:`~numpy.ndarray`</span>
<span class="sd">        :param is_p_wave: Whether to look at P (``True``) velocity or S</span>
<span class="sd">            (``False``) velocity.</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: The slowness layer containing the requested depth.</span>
<span class="sd">        :rtype: :class:`int` or :class:`~numpy.ndarray` (dtype = :class:`int`,</span>
<span class="sd">            shape = ``depth.shape``)</span>

<span class="sd">        :raises SlownessModelError: If no layer in the slowness model contains</span>
<span class="sd">            the given depth.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span>

        <span class="c1"># Check to make sure depth is within the range available</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">depth</span> <span class="o">&lt;</span> <span class="n">layers</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span> <span class="ow">or</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">depth</span> <span class="o">&gt;</span> <span class="n">layers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;No layer contains this depth&quot;</span><span class="p">)</span>

        <span class="n">found_layer_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">searchsorted</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">],</span> <span class="n">depth</span><span class="p">,</span>
                                          <span class="n">side</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="n">found_layer_num</span> <span class="o">==</span> <span class="n">layers</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isscalar</span><span class="p">(</span><span class="n">found_layer_num</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">mask</span><span class="p">:</span>
                <span class="n">found_layer_num</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">found_layer_num</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">found_layer_num</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;getSlownessLayer&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;get_slowness_layer&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getSlownessLayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;getSlownessLayer&#39; has been renamed to</span>
<span class="sd">        &#39;get_slowness_layer&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.get_slowness_layer"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.get_slowness_layer.html#obspy.taup.slowness_model.SlownessModel.get_slowness_layer">[docs]</a>    <span class="k">def</span> <span class="nf">get_slowness_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the Slowness_layer of the requested wave type.</span>

<span class="sd">        This is not meant to be a clone!</span>

<span class="sd">        :param layer: The number of the layer(s) to return.</span>
<span class="sd">        :type layer: :class:`int` or :class:`~numpy.ndarray` (dtype =</span>
<span class="sd">            :class:`int`)</span>
<span class="sd">        :param is_p_wave: Whether to return the P layer (``True``) or the S</span>
<span class="sd">            layer (``False``).</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: The slowness layer(s).</span>
<span class="sd">        :rtype: :class:`~numpy.ndarray` (dtype = :const:`Slowness_layer`,</span>
<span class="sd">            shape = ``layer_num.shape``)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">[</span><span class="n">layer</span><span class="p">]</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;addSlowness&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;add_slowness&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">addSlowness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;addSlowness&#39; has been renamed to</span>
<span class="sd">        &#39;add_slowness&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.add_slowness"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.add_slowness.html#obspy.taup.slowness_model.SlownessModel.add_slowness">[docs]</a>    <span class="k">def</span> <span class="nf">add_slowness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a ray parameter to the slowness sampling for the given wave type.</span>

<span class="sd">        Slowness layers are split as needed and P and S sampling are kept</span>
<span class="sd">        consistent within fluid layers. Note, this makes use of the velocity</span>
<span class="sd">        model, so all interpolation is linear in velocity, not in slowness!</span>

<span class="sd">        :param p: The slowness value to add, in s/km.</span>
<span class="sd">        :type p: float</span>
<span class="sd">        :param is_p_wave: Whether to add to the P wave (``True``) or the S wave</span>
<span class="sd">            (``False``) sampling.</span>
<span class="sd">        :type is_p_wave: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
            <span class="c1"># NB Unlike Java (unfortunately) these are not modified in place!</span>
            <span class="c1"># NumPy arrays cannot have values inserted in place.</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span>
            <span class="n">other_layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span>
            <span class="n">wave</span> <span class="o">=</span> <span class="s1">&#39;P&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span>
            <span class="n">other_layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span>
            <span class="n">wave</span> <span class="o">=</span> <span class="s1">&#39;S&#39;</span>

        <span class="c1"># If depths are the same only need top_velocity, and just to verify we</span>
        <span class="c1"># are not in a fluid.</span>
        <span class="n">nonzero</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
        <span class="n">above</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">evaluate_above</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">],</span> <span class="n">wave</span><span class="p">)</span>
        <span class="n">below</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">evaluate_below</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span> <span class="n">wave</span><span class="p">)</span>
        <span class="n">top_velocity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nonzero</span><span class="p">,</span> <span class="n">below</span><span class="p">,</span> <span class="n">above</span><span class="p">)</span>
        <span class="n">bot_velocity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">nonzero</span><span class="p">,</span> <span class="n">above</span><span class="p">,</span> <span class="n">below</span><span class="p">)</span>

        <span class="n">mask</span> <span class="o">=</span> <span class="p">((</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]))</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="c1"># Don&#39;t need to check for S waves in a fluid or in inner core if</span>
        <span class="c1"># allow_inner_core_s is False.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_p_wave</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">&amp;=</span> <span class="n">top_velocity</span> <span class="o">!=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_inner_core_s</span><span class="p">:</span>
                <span class="n">iocb_mask</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">iocb_depth</span>
                <span class="n">mask</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">iocb_mask</span>

        <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mask</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">bot_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">])</span>
        <span class="c1"># Not a zero thickness layer, so calculate the depth for</span>
        <span class="c1"># the ray parameter.</span>
        <span class="n">slope</span> <span class="o">=</span> <span class="p">((</span><span class="n">bot_velocity</span><span class="p">[</span><span class="n">nonzero</span><span class="p">]</span> <span class="o">-</span> <span class="n">top_velocity</span><span class="p">[</span><span class="n">nonzero</span><span class="p">])</span> <span class="o">/</span>
                 <span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">][</span><span class="n">nonzero</span><span class="p">]</span> <span class="o">-</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">][</span><span class="n">nonzero</span><span class="p">]))</span>
        <span class="n">bot_depth</span><span class="p">[</span><span class="n">nonzero</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">top_velocity</span><span class="p">[</span><span class="n">nonzero</span><span class="p">],</span>
                                              <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">][</span><span class="n">nonzero</span><span class="p">],</span>
                                              <span class="n">slope</span><span class="p">)</span>

        <span class="n">bot_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">index</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">SlownessLayer</span><span class="p">)</span>
        <span class="n">bot_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">bot_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_depth</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">bot_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">bot_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span>

        <span class="n">top_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">index</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">SlownessLayer</span><span class="p">)</span>
        <span class="n">top_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">top_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span>
        <span class="n">top_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
        <span class="n">top_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_depth</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>

        <span class="c1"># numpy 1.6 compatibility</span>
        <span class="n">other_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">other_layers</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span>
                               <span class="n">layers</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">layers</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_layer</span>
        <span class="n">layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">top_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">other_layers</span><span class="p">[</span><span class="n">other_index</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">bot_layer</span><span class="p">[</span><span class="n">other_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            <span class="n">other_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">other_layers</span><span class="p">,</span> <span class="n">other_index</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                                     <span class="n">top_layer</span><span class="p">[</span><span class="n">other_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>

        <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span> <span class="o">=</span> <span class="n">layers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span> <span class="o">=</span> <span class="n">other_layers</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span> <span class="o">=</span> <span class="n">layers</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span> <span class="o">=</span> <span class="n">other_layers</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;ray_paramIncCheck&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;ray_param_inc_check&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">ray_paramIncCheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;ray_paramIncCheck&#39; has been renamed to</span>
<span class="sd">        &#39;ray_param_inc_check&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ray_param_inc_check</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.ray_param_inc_check"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.ray_param_inc_check.html#obspy.taup.slowness_model.SlownessModel.ray_param_inc_check">[docs]</a>    <span class="k">def</span> <span class="nf">ray_param_inc_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check that no slowness layer&#39;s ray parameter interval is too large.</span>

<span class="sd">        The limit is determined by ``self.max_delta_p``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">]:</span>
            <span class="c1"># These might change with calls to add_slowness, so be sure we have</span>
            <span class="c1"># the correct copy.</span>
            <span class="k">if</span> <span class="n">wave</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">:</span>
                <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span>

            <span class="n">diff</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span>
            <span class="n">absdiff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span>

            <span class="n">mask</span> <span class="o">=</span> <span class="n">absdiff</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_delta_p</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">diff</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
            <span class="n">absdiff</span> <span class="o">=</span> <span class="n">absdiff</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
            <span class="n">top_p</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span>

            <span class="n">new_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">absdiff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_delta_p</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">new_count</span>

            <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">Np</span><span class="p">,</span> <span class="n">delta</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">top_p</span><span class="p">,</span> <span class="n">new_count</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Np</span><span class="p">):</span>
                    <span class="n">newp</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">j</span> <span class="o">*</span> <span class="n">delta</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">newp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">newp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;depthIncCheck&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;depth_inc_check&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">depthIncCheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;depthIncCheck&#39; has been renamed to</span>
<span class="sd">        &#39;depth_inc_check&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_inc_check</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.depth_inc_check"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.depth_inc_check.html#obspy.taup.slowness_model.SlownessModel.depth_inc_check">[docs]</a>    <span class="k">def</span> <span class="nf">depth_inc_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check that no slowness layer is too thick.</span>

<span class="sd">        The maximum is determined by ``self.max_depth_interval``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">]:</span>
            <span class="c1"># These might change with calls to add_slowness, so be sure we</span>
            <span class="c1"># have the correct copy.</span>
            <span class="k">if</span> <span class="n">wave</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">:</span>
                <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span>

            <span class="n">diff</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span>

            <span class="n">mask</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth_interval</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">diff</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
            <span class="n">top_depth</span> <span class="o">=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span>

            <span class="n">new_count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">diff</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth_interval</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">)</span>
            <span class="n">steps</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">/</span> <span class="n">new_count</span>

            <span class="k">for</span> <span class="n">start</span><span class="p">,</span> <span class="n">Nd</span><span class="p">,</span> <span class="n">delta</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">top_depth</span><span class="p">,</span> <span class="n">new_count</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
                <span class="n">new_depth</span> <span class="o">=</span> <span class="n">start</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Nd</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta</span>
                <span class="k">if</span> <span class="n">wave</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">:</span>
                    <span class="n">velocity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">evaluate_above</span><span class="p">(</span><span class="n">new_depth</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">)</span>

                    <span class="n">smask</span> <span class="o">=</span> <span class="n">velocity</span> <span class="o">==</span> <span class="mi">0</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">allow_inner_core_s</span><span class="p">:</span>
                        <span class="n">smask</span> <span class="o">|=</span> <span class="n">new_depth</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">iocb_depth</span>
                    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">smask</span><span class="p">):</span>
                        <span class="n">velocity</span><span class="p">[</span><span class="n">smask</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">evaluate_above</span><span class="p">(</span>
                            <span class="n">new_depth</span><span class="p">[</span><span class="n">smask</span><span class="p">],</span> <span class="s1">&#39;P&#39;</span><span class="p">)</span>
                    <span class="n">slowness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_slowness</span><span class="p">(</span><span class="n">velocity</span><span class="p">,</span> <span class="n">new_depth</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">slowness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_slowness</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">evaluate_above</span><span class="p">(</span><span class="n">new_depth</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">),</span>
                        <span class="n">new_depth</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">slowness</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;distanceCheck&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;distance_check&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">distanceCheck</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;distanceCheck&#39; has been renamed to</span>
<span class="sd">        &#39;distance_check&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_check</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.distance_check"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.distance_check.html#obspy.taup.slowness_model.SlownessModel.distance_check">[docs]</a>    <span class="k">def</span> <span class="nf">distance_check</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Check that no slowness layer is too wide or undersampled.</span>

<span class="sd">        The width must be less than ``self.max_range_interval`` and the</span>
<span class="sd">        (estimated) error due to linear interpolation must be less than</span>
<span class="sd">        ``self.max_interp_error``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">curr_wave_type</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">]:</span>
            <span class="n">is_curr_ok</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">is_prev_ok</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">prev_prev_id</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">prev_td</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">curr_td</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">curr_wave_type</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_num_layers</span><span class="p">(</span><span class="n">curr_wave_type</span><span class="p">):</span>
                <span class="n">prev_s_layer</span> <span class="o">=</span> <span class="n">s_layer</span>
                <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">curr_wave_type</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">depth_in_high_slowness</span><span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">],</span>
                                                <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span>
                                                <span class="n">curr_wave_type</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">and</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">depth_in_high_slowness</span><span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span>
                                                <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span>
                                                <span class="n">curr_wave_type</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="c1"># Don&#39;t calculate prevTD if we can avoid it</span>
                    <span class="k">if</span> <span class="n">is_curr_ok</span> <span class="ow">and</span> <span class="n">curr_td</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">is_prev_ok</span><span class="p">:</span>
                            <span class="n">prev_prev_id</span> <span class="o">=</span> <span class="n">prev_td</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">prev_prev_id</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">prev_td</span> <span class="o">=</span> <span class="n">curr_td</span>
                        <span class="n">is_prev_ok</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">prev_td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approx_distance</span><span class="p">(</span><span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span>
                                                       <span class="n">curr_wave_type</span><span class="p">)</span>
                        <span class="n">is_prev_ok</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">curr_td</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approx_distance</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span>
                                                   <span class="n">curr_wave_type</span><span class="p">)</span>
                    <span class="n">is_curr_ok</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="c1"># Check for jump of too great distance</span>
                    <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">prev_td</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">curr_td</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">])</span> <span class="o">&gt;</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">max_range_interval</span> <span class="ow">and</span>
                            <span class="nb">abs</span><span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">&gt;</span>
                            <span class="mi">2</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_delta_p</span><span class="p">):</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;At &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; Distance jump too great (&quot;</span>
                                  <span class="s2">&quot;&gt;max_range_interval &quot;</span> <span class="o">+</span>
                                  <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_range_interval</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;), adding &quot;</span>
                                  <span class="s2">&quot;slowness. &quot;</span><span class="p">)</span>
                        <span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>
                        <span class="n">curr_td</span> <span class="o">=</span> <span class="n">prev_td</span>
                        <span class="n">is_curr_ok</span> <span class="o">=</span> <span class="n">is_prev_ok</span>
                        <span class="n">prev_td</span> <span class="o">=</span> <span class="n">prev_prev_id</span>
                        <span class="n">prev_prev_id</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="n">is_prev_ok</span> <span class="o">=</span> <span class="n">prev_td</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Make guess as to error estimate due to linear</span>
                        <span class="c1"># interpolation if it is not ok, then we split both</span>
                        <span class="c1"># the previous and current slowness layers, this has</span>
                        <span class="c1"># the nice, if unintended, consequence of adding</span>
                        <span class="c1"># extra samples in the neighborhood of poorly</span>
                        <span class="c1"># sampled caustics.</span>
                        <span class="n">split_ray_param</span> <span class="o">=</span> \
                            <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                        <span class="n">all_but_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">approx_distance</span><span class="p">(</span>
                            <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">split_ray_param</span><span class="p">,</span> <span class="n">curr_wave_type</span><span class="p">)</span>
                        <span class="n">split_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span>
                            <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span>
                            <span class="n">split_ray_param</span><span class="p">,</span>
                            <span class="n">bullen_depth_for</span><span class="p">(</span><span class="n">s_layer</span><span class="p">,</span> <span class="n">split_ray_param</span><span class="p">,</span>
                                             <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">))],</span>
                            <span class="n">dtype</span><span class="o">=</span><span class="n">SlownessLayer</span><span class="p">)</span>
                        <span class="n">just_layer_time</span><span class="p">,</span> <span class="n">just_layer_dist</span> <span class="o">=</span> \
                            <span class="n">bullen_radial_slowness</span><span class="p">(</span>
                                <span class="n">split_layer</span><span class="p">,</span> <span class="n">split_ray_param</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">)</span>
                        <span class="n">split_time</span> <span class="o">=</span> \
                            <span class="n">all_but_layer</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">just_layer_time</span>
                        <span class="n">split_dist</span> <span class="o">=</span> \
                            <span class="n">all_but_layer</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">just_layer_dist</span>
                        <span class="c1"># Python standard division is not IEEE compliant,</span>
                        <span class="c1"># as The IEEE 754 standard specifies that every</span>
                        <span class="c1"># floating point arithmetic operation, including</span>
                        <span class="c1"># division by zero, has a well-defined result.</span>
                        <span class="c1"># Use numpy&#39;s division instead by using np.array:</span>
                        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">divide</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
                            <span class="n">diff</span> <span class="o">=</span> <span class="p">(</span><span class="n">curr_td</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">-</span>
                                    <span class="p">((</span><span class="n">split_time</span> <span class="o">-</span> <span class="n">prev_td</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span> <span class="o">*</span>
                                     <span class="p">((</span><span class="n">curr_td</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">prev_td</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">])</span> <span class="o">/</span>
                                      <span class="p">(</span><span class="n">split_dist</span> <span class="o">-</span> <span class="n">prev_td</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">]))</span> <span class="o">+</span>
                                     <span class="n">prev_td</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]))</span>
                        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_interp_error</span><span class="p">:</span>
                            <span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">prev_s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">+</span>
                                  <span class="n">prev_s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                            <span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">add_slowness</span><span class="p">(</span><span class="n">p2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>
                            <span class="n">curr_td</span> <span class="o">=</span> <span class="n">prev_prev_id</span>
                            <span class="n">is_curr_ok</span> <span class="o">=</span> <span class="n">curr_td</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                            <span class="n">is_prev_ok</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="c1"># Back up one step unless we are at the</span>
                                <span class="c1"># beginning, then stay put.</span>
                                <span class="n">j</span> <span class="o">-=</span> <span class="mi">1</span>
                                <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span>
                                    <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">0</span><span class="p">,</span> <span class="n">curr_wave_type</span><span class="p">)</span>
                                <span class="c1"># This s_layer will become prevSLayer in the</span>
                                <span class="c1"># next loop.</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">is_prev_ok</span> <span class="o">=</span> <span class="kc">False</span>
                                <span class="n">is_curr_ok</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
                            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">prev_prev_id</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">prev_td</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">curr_td</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">is_curr_ok</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">is_prev_ok</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of &quot;</span> <span class="o">+</span> <span class="p">(</span><span class="s2">&quot;P&quot;</span> <span class="k">if</span> <span class="n">curr_wave_type</span> <span class="k">else</span> <span class="s2">&quot;S&quot;</span><span class="p">)</span> <span class="o">+</span>
                      <span class="s2">&quot; slowness layers: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">))</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;depthInHighSlowness&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;depth_in_high_slowness&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">depthInHighSlowness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;depthInHighSlowness&#39; has been renamed to</span>
<span class="sd">        &#39;depth_in_high_slowness&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_in_high_slowness</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.depth_in_high_slowness"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.depth_in_high_slowness.html#obspy.taup.slowness_model.SlownessModel.depth_in_high_slowness">[docs]</a>    <span class="k">def</span> <span class="nf">depth_in_high_slowness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">ray_param</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine if depth and slowness are within a high slowness zone.</span>

<span class="sd">        Whether the high slowness zone includes its upper boundary and its</span>
<span class="sd">        lower boundaries depends upon the ray parameter. The slowness at the</span>
<span class="sd">        depth is needed because if depth happens to correspond to a</span>
<span class="sd">        discontinuity that marks the bottom of the high slowness zone but the</span>
<span class="sd">        ray is actually a total reflection then it is not part of the high</span>
<span class="sd">        slowness zone. The ray parameter that delimits the zone, i.e., it can</span>
<span class="sd">        turn at the top and the bottom, is in the zone at the top, but out of</span>
<span class="sd">        the zone at the bottom. (?)</span>

<span class="sd">        NOTE: I changed this method a bit by throwing out some seemingly</span>
<span class="sd">        useless copying of the values in temp_range, which I think are not used</span>
<span class="sd">        anywhere else.</span>

<span class="sd">        :param depth: The depth to check, in km.</span>
<span class="sd">        :type depth: float</span>
<span class="sd">        :param ray_param: The slowness to check, in s/km.</span>
<span class="sd">        :type ray_param: float</span>
<span class="sd">        :param is_p_wave: Whether to check the P wave (``True``) or the S wave</span>
<span class="sd">            (``False``).</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: ``True`` if within a high slowness zone, ``False`` otherwise.</span>
<span class="sd">        :rtype: bool</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
            <span class="n">high_slowness_layer_depths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">high_slowness_layer_depths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span>
        <span class="k">for</span> <span class="n">temp_range</span> <span class="ow">in</span> <span class="n">high_slowness_layer_depths</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">temp_range</span><span class="o">.</span><span class="n">top_depth</span> <span class="o">&lt;=</span> <span class="n">depth</span> <span class="o">&lt;=</span> <span class="n">temp_range</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">ray_param</span> <span class="o">&gt;</span> <span class="n">temp_range</span><span class="o">.</span><span class="n">ray_param</span> \
                        <span class="ow">or</span> <span class="p">(</span><span class="n">ray_param</span> <span class="o">==</span> <span class="n">temp_range</span><span class="o">.</span><span class="n">ray_param</span> <span class="ow">and</span>
                            <span class="n">depth</span> <span class="o">==</span> <span class="n">temp_range</span><span class="o">.</span><span class="n">top_depth</span><span class="p">):</span>
                    <span class="k">return</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="kc">False</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;approxDistance&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;approx_distance&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">approxDistance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;approxDistance&#39; has been renamed to</span>
<span class="sd">        &#39;approx_distance&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">approx_distance</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.approx_distance"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.approx_distance.html#obspy.taup.slowness_model.SlownessModel.approx_distance">[docs]</a>    <span class="k">def</span> <span class="nf">approx_distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">slowness_turn_layer</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Approximate distance for ray turning at the bottom of a layer.</span>

<span class="sd">        Generates approximate distance, in radians, for a ray from a surface</span>
<span class="sd">        source that turns at the bottom of the given slowness layer.</span>

<span class="sd">        :param slowness_turn_layer: The number of the layer at which the ray</span>
<span class="sd">            should turn.</span>
<span class="sd">        :type slowness_turn_layer: int</span>
<span class="sd">        :param p: The slowness to calculate, in s/km.</span>
<span class="sd">        :type p: float</span>
<span class="sd">        :param is_p_wave: Whether to use the P (``True``) or S (``False``)</span>
<span class="sd">            wave.</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: The time (in s) and distance (in rad) the ray travels.</span>
<span class="sd">        :rtype: :class:`~numpy.ndarray` (dtype = :const:`TimeDist`, shape =</span>
<span class="sd">            (``slowness_turn_layer``, ))</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># First, if the slowness model contains less than slowness_turn_layer</span>
        <span class="c1"># elements we can&#39;t calculate a distance.</span>
        <span class="k">if</span> <span class="n">slowness_turn_layer</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_num_layers</span><span class="p">(</span><span class="n">is_p_wave</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                <span class="s2">&quot;Can&#39;t calculate a distance when get_num_layers() is smaller &quot;</span>
                <span class="s2">&quot;than the given slowness_turn_layer!&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Ray parameter must not be negative!&quot;</span><span class="p">)</span>
        <span class="n">td</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">TimeDist</span><span class="p">)</span>
        <span class="n">td</span><span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span>
        <span class="n">layer_num</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">slowness_turn_layer</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">layer_num</span><span class="p">):</span>
            <span class="n">time</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_time_dist</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span>
            <span class="c1"># Return 2* distance and time because there is a downgoing as well</span>
            <span class="c1"># as an upgoing leg, which are equal since this is for a surface</span>
            <span class="c1"># source.</span>
            <span class="n">td</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
            <span class="n">td</span><span class="p">[</span><span class="s1">&#39;dist&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">td</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;layerTimeDist&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;layer_time_dist&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">layerTimeDist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;layerTimeDist&#39; has been renamed to</span>
<span class="sd">        &#39;layer_time_dist&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_time_dist</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.layer_time_dist"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.layer_time_dist.html#obspy.taup.slowness_model.SlownessModel.layer_time_dist">[docs]</a>    <span class="k">def</span> <span class="nf">layer_time_dist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">spherical_ray_param</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">,</span>
                        <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">allow_turn</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate time and distance for a ray passing through a layer.</span>

<span class="sd">        Calculates the time and distance increments accumulated by a ray of</span>
<span class="sd">        spherical ray parameter ``p`` when passing through layer ``layer_num``.</span>
<span class="sd">        Note that this gives half of the true range and time increments since</span>
<span class="sd">        there will be both an upgoing and a downgoing path. It also only does</span>
<span class="sd">        the calculation for the simple cases of the centre of the planet, where</span>
<span class="sd">        the ray parameter is zero, or for constant velocity layers. Otherwise,</span>
<span class="sd">        it calls :func:`~.bullen_radial_slowness`.</span>

<span class="sd">        Either ``spherical_ray_param`` or ``layer_num`` must be 0-D, or they</span>
<span class="sd">        must have the same shape.</span>

<span class="sd">        :param spherical_ray_param: The spherical ray parameter of the</span>
<span class="sd">            ray(s), in s/km.</span>
<span class="sd">        :type spherical_ray_param: :class:`float` or :class:`~numpy.ndarray`</span>
<span class="sd">        :param layer_num: The layer(s) in which the calculation should be done.</span>
<span class="sd">        :type layer_num: :class:`float` or :class:`~numpy.ndarray`</span>
<span class="sd">        :param is_p_wave: Whether to look at the P (``True``) or S (``False``)</span>
<span class="sd">            wave.</span>
<span class="sd">        :type is_p_wave: bool</span>
<span class="sd">        :param check: Whether to perform checks of input consistency.</span>
<span class="sd">        :type check: bool</span>
<span class="sd">        :param allow_turn: Whether to allow the ray to turn in the middle of a</span>
<span class="sd">            layer.</span>
<span class="sd">        :type allow_turn: bool</span>

<span class="sd">        :returns: The time (in s) and distance (in rad) increments for the</span>
<span class="sd">            specified ray(s) and layer(s).</span>
<span class="sd">        :rtype: :class:`~numpy.ndarray` (dtype = :const:`TimeDist`, shape =</span>
<span class="sd">            ``spherical_ray_param.shape`` or ``layer_num.shape``)</span>

<span class="sd">        :raises SlownessModelError: If the ray with the given spherical ray</span>
<span class="sd">            parameter cannot propagate within this layer, or if the ray turns</span>
<span class="sd">            within this layer but not at the bottom. These checks may be</span>
<span class="sd">            bypassed by specifying ``check=False``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spherical_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="n">layer_num</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span>
        <span class="n">pdim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">spherical_ray_param</span><span class="p">)</span>
        <span class="n">ldim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">layer_num</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ldim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">pdim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">layer_num</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">layer_num</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ldim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">pdim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">spherical_ray_param</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">spherical_ray_param</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">ldim</span> <span class="o">==</span> <span class="n">pdim</span> <span class="ow">and</span> <span class="p">(</span><span class="n">ldim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span>
                               <span class="n">layer_num</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">spherical_ray_param</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
            <span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">layer_num</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
            <span class="n">dist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">layer_num</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float_</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;Either spherical_ray_param or layer_num must be &#39;</span>
                            <span class="s1">&#39;0D, or they must have the same shape.&#39;</span><span class="p">)</span>

        <span class="c1"># First make sure that a ray with this ray param can propagate</span>
        <span class="c1"># within this layer and doesn&#39;t turn in the middle of the layer. If</span>
        <span class="c1"># not, raise error.</span>
        <span class="k">if</span> <span class="n">check</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_turn</span><span class="p">:</span>
                <span class="n">minp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">minimum</span><span class="p">(</span><span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span>
                                  <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">spherical_ray_param</span> <span class="o">&gt;</span> <span class="n">minp</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                        <span class="s1">&#39;Ray turns in the middle of this layer! &#39;</span>
                        <span class="s1">&#39;layer_num = </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">layer_num</span><span class="p">,</span> <span class="p">))</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">spherical_ray_param</span> <span class="o">&gt;</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s1">&#39;Ray cannot propagate within this &#39;</span>
                                         <span class="s1">&#39; layer, given ray param too large.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">spherical_ray_param</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Ray parameter must not be negative!&quot;</span><span class="p">)</span>

        <span class="n">turning_layers</span> <span class="o">=</span> <span class="n">spherical_ray_param</span> <span class="o">&gt;</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">turning_layers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ldim</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">pdim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Turn in a layer, create temp layers with p at bottom.</span>
                <span class="n">tmp_layers</span> <span class="o">=</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="n">turning_layers</span><span class="p">]</span>
                <span class="n">turn_depth</span> <span class="o">=</span> <span class="n">bullen_depth_for</span><span class="p">(</span>
                    <span class="n">tmp_layers</span><span class="p">,</span> <span class="n">spherical_ray_param</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
                    <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">][</span><span class="n">turning_layers</span><span class="p">]</span> <span class="o">=</span> <span class="n">spherical_ray_param</span>
                <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">][</span><span class="n">turning_layers</span><span class="p">]</span> <span class="o">=</span> <span class="n">turn_depth</span>

            <span class="k">elif</span> <span class="n">ldim</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">pdim</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Turn in layer, create temp layers with each p at bottom.</span>
                <span class="c1"># Expand layer array so that each one turns at correct depth.</span>
                <span class="n">ldim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">new_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">spherical_layer</span><span class="p">,</span>
                                       <span class="nb">len</span><span class="p">(</span><span class="n">spherical_ray_param</span><span class="p">))</span>
                <span class="n">turn_depth</span> <span class="o">=</span> <span class="n">bullen_depth_for</span><span class="p">(</span>
                    <span class="n">new_layers</span><span class="p">,</span> <span class="n">spherical_ray_param</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
                    <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">new_layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">][</span><span class="n">turning_layers</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">spherical_ray_param</span><span class="p">[</span><span class="n">turning_layers</span><span class="p">]</span>
                <span class="n">new_layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">][</span><span class="n">turning_layers</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">turn_depth</span><span class="p">[</span><span class="n">turning_layers</span><span class="p">]</span>
                <span class="n">spherical_layer</span> <span class="o">=</span> <span class="n">new_layers</span>

            <span class="k">elif</span> <span class="n">ldim</span> <span class="o">==</span> <span class="n">pdim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Turn in layer, create temp layer with p at bottom.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">turn_depth</span> <span class="o">=</span> <span class="n">bullen_depth_for</span><span class="p">(</span><span class="n">spherical_layer</span><span class="p">,</span>
                                                  <span class="n">spherical_ray_param</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">)</span>
                <span class="k">except</span> <span class="n">SlownessModelError</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">check</span><span class="p">:</span>
                        <span class="k">raise</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">turn_depth</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
                <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">spherical_ray_param</span>
                <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">turn_depth</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Turn in layer, create temp layers with each p at bottom.</span>
                <span class="n">turn_depth</span> <span class="o">=</span> <span class="n">bullen_depth_for</span><span class="p">(</span>
                    <span class="n">spherical_layer</span><span class="p">,</span> <span class="n">spherical_ray_param</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">turning_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">turning_layers</span><span class="p">)</span>
                <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">][</span><span class="n">turning_layers</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">spherical_ray_param</span><span class="p">[</span><span class="n">turning_layers</span><span class="p">]</span>
                <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">][</span><span class="n">turning_layers</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="n">turn_depth</span><span class="p">[</span><span class="n">turning_layers</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">check</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span>
                <span class="n">spherical_ray_param</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span>
                                                 <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Ray cannot propagate within this layer, &quot;</span>
                                     <span class="s2">&quot;given ray param too large.&quot;</span><span class="p">)</span>

        <span class="c1"># Check to see if this layer has zero thickness, if so then it is</span>
        <span class="c1"># from a critically reflected slowness sample. That means just</span>
        <span class="c1"># return 0 for time and distance increments.</span>
        <span class="n">zero_thick</span> <span class="o">=</span> \
            <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ldim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">zero_thick</span><span class="p">:</span>
                <span class="n">time</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">dist</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">time</span><span class="p">,</span> <span class="n">dist</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">zero_thick</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">bool_</span><span class="p">)</span>

        <span class="n">leftover</span> <span class="o">=</span> <span class="o">~</span><span class="n">zero_thick</span>
        <span class="n">time</span><span class="p">[</span><span class="n">zero_thick</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">zero_thick</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Check to see if this layer contains the centre of the planet. If so</span>
        <span class="c1"># then the spherical ray parameter should be 0.0 and we calculate the</span>
        <span class="c1"># range and time increments using a constant velocity layer (sphere).</span>
        <span class="c1"># See eqns. 43 and 44 of [Buland1983]_, although we implement them</span>
        <span class="c1"># slightly differently. Note that the distance and time increments are</span>
        <span class="c1"># for just downgoing or just upgoing, i.e. from the top of the layer</span>
        <span class="c1"># to the centre of the planet or vice versa but not both. This is in</span>
        <span class="c1"># keeping with the convention that these are one way distance and time</span>
        <span class="c1"># increments. We will multiply the result by 2 at the end, or if we are</span>
        <span class="c1"># doing a 1.5D model, the other direction may be different. The time</span>
        <span class="c1"># increment for a ray of zero ray parameter passing half way through a</span>
        <span class="c1"># sphere of constant velocity is just the spherical slowness at the top</span>
        <span class="c1"># of the sphere. An amazingly simple result!</span>
        <span class="n">centre_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">leftover</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
            <span class="n">spherical_ray_param</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">))</span>
        <span class="n">leftover</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">centre_layer</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">layer_num</span><span class="p">[</span><span class="n">centre_layer</span><span class="p">]</span> <span class="o">!=</span>
                  <span class="bp">self</span><span class="o">.</span><span class="n">get_num_layers</span><span class="p">(</span><span class="n">is_p_wave</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;There are layers deeper than the &quot;</span>
                                     <span class="s2">&quot;centre of the planet!&quot;</span><span class="p">)</span>
        <span class="n">time</span><span class="p">[</span><span class="n">centre_layer</span><span class="p">]</span> <span class="o">=</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">][</span><span class="n">centre_layer</span><span class="p">]</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">centre_layer</span><span class="p">]</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># Now we check to see if this is a constant velocity layer and if so</span>
        <span class="c1"># than we can do a simple triangle calculation to get the range and</span>
        <span class="c1"># time increments. To get the time increment we first calculate the</span>
        <span class="c1"># path length through the layer using the law of cosines, noting</span>
        <span class="c1"># that the angle at the top of the layer can be obtained from the</span>
        <span class="c1"># spherical Snell&#39;s Law. The time increment is just the path length</span>
        <span class="c1"># divided by the velocity. To get the distance we first find the</span>
        <span class="c1"># angular distance traveled, using the law of sines.</span>
        <span class="n">top_radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span> <span class="o">-</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span>
        <span class="n">bot_radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span> <span class="o">-</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span>
        <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">errstate</span><span class="p">(</span><span class="n">invalid</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">):</span>
            <span class="n">vel</span> <span class="o">=</span> <span class="n">bot_radius</span> <span class="o">/</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span>
            <span class="n">constant_velocity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span>
                <span class="n">leftover</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">top_radius</span> <span class="o">/</span> <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span>
                       <span class="n">vel</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slowness_tolerance</span><span class="p">)</span>
        <span class="n">leftover</span> <span class="o">&amp;=</span> <span class="o">~</span><span class="n">constant_velocity</span>
        <span class="n">top_radius</span> <span class="o">=</span> <span class="n">top_radius</span><span class="p">[</span><span class="n">constant_velocity</span><span class="p">]</span>
        <span class="n">bot_radius</span> <span class="o">=</span> <span class="n">bot_radius</span><span class="p">[</span><span class="n">constant_velocity</span><span class="p">]</span>
        <span class="n">vel</span> <span class="o">=</span> <span class="n">vel</span><span class="p">[</span><span class="n">constant_velocity</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">pdim</span><span class="p">:</span>
            <span class="n">ray_param_const_velocity</span> <span class="o">=</span> <span class="n">spherical_ray_param</span><span class="p">[</span><span class="n">constant_velocity</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ray_param_const_velocity</span> <span class="o">=</span> <span class="n">spherical_ray_param</span>

        <span class="c1"># In cases of a ray turning at the bottom of the layer numerical</span>
        <span class="c1"># round-off can cause bot_term to be very small (1e-9) but</span>
        <span class="c1"># negative which causes the sqrt to raise an error. We check for</span>
        <span class="c1"># values that are within the numerical chatter of zero and just</span>
        <span class="c1"># set them to zero.</span>
        <span class="n">top_term</span> <span class="o">=</span> <span class="n">top_radius</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span><span class="n">ray_param_const_velocity</span> <span class="o">*</span> <span class="n">vel</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">top_term</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">top_term</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">slowness_tolerance</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># In this case the ray turns at the bottom of this layer so</span>
        <span class="c1"># spherical_ray_param*vel == bot_radius, and bot_term should be</span>
        <span class="c1"># zero. We check for this case specifically because</span>
        <span class="c1"># numerical chatter can cause small round-off errors that</span>
        <span class="c1"># lead to bot_term being negative, causing a sqrt error.</span>
        <span class="n">bot_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">top_term</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">ray_param_const_velocity</span> <span class="o">!=</span>
                <span class="n">spherical_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">][</span><span class="n">constant_velocity</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">pdim</span><span class="p">:</span>
            <span class="n">bot_term</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_radius</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span>
                <span class="n">ray_param_const_velocity</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">*</span> <span class="n">vel</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bot_term</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_radius</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="p">(</span>
                <span class="n">ray_param_const_velocity</span> <span class="o">*</span> <span class="n">vel</span><span class="p">[</span><span class="n">mask</span><span class="p">])</span> <span class="o">**</span> <span class="mi">2</span>

        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">top_term</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">bot_term</span><span class="p">)</span>
        <span class="n">time</span><span class="p">[</span><span class="n">constant_velocity</span><span class="p">]</span> <span class="o">=</span> <span class="n">b</span> <span class="o">/</span> <span class="n">vel</span>
        <span class="n">dist</span><span class="p">[</span><span class="n">constant_velocity</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span>
            <span class="n">b</span> <span class="o">*</span> <span class="n">ray_param_const_velocity</span> <span class="o">*</span> <span class="n">vel</span> <span class="o">/</span> <span class="p">(</span><span class="n">top_radius</span> <span class="o">*</span> <span class="n">bot_radius</span><span class="p">))</span>

        <span class="c1"># If the layer is not a constant velocity layer or the centre of the</span>
        <span class="c1"># planet and p is not zero we have to do it the hard way:</span>
        <span class="n">time</span><span class="p">[</span><span class="n">leftover</span><span class="p">],</span> <span class="n">dist</span><span class="p">[</span><span class="n">leftover</span><span class="p">]</span> <span class="o">=</span> <span class="n">bullen_radial_slowness</span><span class="p">(</span>
            <span class="n">spherical_layer</span><span class="p">[</span><span class="n">leftover</span><span class="p">]</span> <span class="k">if</span> <span class="n">ldim</span> <span class="k">else</span> <span class="n">spherical_layer</span><span class="p">,</span>
            <span class="n">spherical_ray_param</span><span class="p">[</span><span class="n">leftover</span><span class="p">]</span> <span class="k">if</span> <span class="n">pdim</span> <span class="k">else</span> <span class="n">spherical_ray_param</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">,</span>
            <span class="n">check</span><span class="o">=</span><span class="n">check</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">check</span> <span class="ow">and</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">time</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">time</span><span class="p">))</span> <span class="ow">or</span>
                      <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">dist</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">dist</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                <span class="s2">&quot;layer time|dist &lt; 0 or NaN.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">time</span><span class="p">,</span> <span class="n">dist</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;fixCriticalPoints&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;fix_critical_points&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">fixCriticalPoints</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;fixCriticalPoints&#39; has been renamed to</span>
<span class="sd">        &#39;fix_critical_points&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">fix_critical_points</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.fix_critical_points"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.fix_critical_points.html#obspy.taup.slowness_model.SlownessModel.fix_critical_points">[docs]</a>    <span class="k">def</span> <span class="nf">fix_critical_points</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reset the slowness layers that correspond to critical points.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;p_layer_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_below</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>
        <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;p_layer_num&#39;</span><span class="p">],</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">)</span>

        <span class="c1"># We want the last critical point to be the bottom of the last layer.</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;p_layer_num&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;p_layer_num&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;s_layer_num&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_below</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>
        <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;s_layer_num&#39;</span><span class="p">],</span>
                                          <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">)</span>

        <span class="c1"># We want the last critical point to be the bottom of the last layer.</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;s_layer_num&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span>
            <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;depth&#39;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span><span class="p">[</span><span class="s1">&#39;s_layer_num&#39;</span><span class="p">][</span><span class="n">mask</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span></div>

<div class="viewcode-block" id="SlownessModel.validate"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.validate.html#obspy.taup.slowness_model.SlownessModel.validate">[docs]</a>    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Perform consistency check on the slowness model.</span>

<span class="sd">        In Java, there is a separate validate method defined in the</span>
<span class="sd">        SphericalSModel subclass and as such overrides the validate in</span>
<span class="sd">        SlownessModel, but it itself calls the super method (by</span>
<span class="sd">        super.validate()), i.e. the code above. Both are merged here (in</span>
<span class="sd">        fact, it only contained one test).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Radius of planet must be positive.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_depth_interval</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                <span class="s2">&quot;max_depth_interval must be positive and non-zero.&quot;</span><span class="p">)</span>
        <span class="c1"># Check for inconsistencies in high slowness zones.</span>
        <span class="k">for</span> <span class="n">is_p_wave</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p_wave</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_wave</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
                <span class="n">high_slowness_layer_depths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_p</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">high_slowness_layer_depths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">high_slowness_layer_depths_s</span>
            <span class="n">prev_depth</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e300</span>
            <span class="k">for</span> <span class="n">high_s_zone_depth</span> <span class="ow">in</span> <span class="n">high_slowness_layer_depths</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">high_s_zone_depth</span><span class="o">.</span><span class="n">top_depth</span> <span class="o">&gt;=</span> <span class="n">high_s_zone_depth</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                        <span class="s2">&quot;High Slowness zone has zero or negative thickness!&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">high_s_zone_depth</span><span class="o">.</span><span class="n">top_depth</span> <span class="o">&lt;</span> <span class="n">prev_depth</span> <span class="ow">or</span> <span class="p">(</span>
                        <span class="n">high_s_zone_depth</span><span class="o">.</span><span class="n">top_depth</span> <span class="o">==</span> <span class="n">prev_depth</span> <span class="ow">and</span> <span class="ow">not</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">v_mod</span><span class="o">.</span><span class="n">is_discontinuity</span><span class="p">(</span>
                            <span class="n">high_s_zone_depth</span><span class="o">.</span><span class="n">top_depth</span><span class="p">))):</span>
                    <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                        <span class="s2">&quot;High Slowness zone overlaps previous zone.&quot;</span><span class="p">)</span>
                <span class="n">prev_depth</span> <span class="o">=</span> <span class="n">high_s_zone_depth</span><span class="o">.</span><span class="n">bot_depth</span>
        <span class="c1"># Check for inconsistencies in fluid zones.</span>
        <span class="n">prev_depth</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e300</span>
        <span class="k">for</span> <span class="n">fluidZone</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fluid_layer_depths</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">fluidZone</span><span class="o">.</span><span class="n">top_depth</span> <span class="o">&gt;=</span> <span class="n">fluidZone</span><span class="o">.</span><span class="n">bot_depth</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                    <span class="s2">&quot;Fluid zone has zero or negative thickness!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">fluidZone</span><span class="o">.</span><span class="n">top_depth</span> <span class="o">&lt;=</span> <span class="n">prev_depth</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Fluid zone overlaps previous zone.&quot;</span><span class="p">)</span>
            <span class="n">prev_depth</span> <span class="o">=</span> <span class="n">fluidZone</span><span class="o">.</span><span class="n">bot_depth</span>
        <span class="c1"># Check for inconsistencies in slowness layers.</span>
        <span class="k">for</span> <span class="n">layers</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">layers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">])</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Slowness layer has NaN values.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">((</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                    <span class="s2">&quot;Slowness layer has negative slowness.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">!=</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                    <span class="s2">&quot;Slowness layer slowness does not agree with &quot;</span>
                    <span class="s2">&quot;previous layer (at same depth)!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                    <span class="s2">&quot;Slowness layer has negative thickness.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Gap between slowness layers!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&gt;</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Gap between slowness layers!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Slowness layer overlaps previous!&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&lt;</span> <span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span><span class="s2">&quot;Slowness layer overlaps previous!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">])</span> <span class="o">|</span>
                      <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">])):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                    <span class="s2">&quot;Slowness layer depth (top or bottom) is NaN!&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">layers</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">SlownessModelError</span><span class="p">(</span>
                    <span class="s2">&quot;Slowness layer has a depth larger than radius of the &quot;</span>
                    <span class="s2">&quot;planet.&quot;</span><span class="p">)</span>

        <span class="c1"># Everything seems OK.</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;getMinTurnRayParam&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;get_min_turn_ray_param&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getMinTurnRayParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;getMinTurnRayParam&#39; has been renamed to</span>
<span class="sd">        &#39;get_min_turn_ray_param&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_turn_ray_param</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.get_min_turn_ray_param"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.get_min_turn_ray_param.html#obspy.taup.slowness_model.SlownessModel.get_min_turn_ray_param">[docs]</a>    <span class="k">def</span> <span class="nf">get_min_turn_ray_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find minimum slowness, turning but not reflected, at or above a depth.</span>

<span class="sd">        Normally this is the slowness sample at the given depth, but if the</span>
<span class="sd">        depth is within a high slowness zone, then it may be smaller.</span>

<span class="sd">        :param depth: The depth to search for, in km.</span>
<span class="sd">        :type depth: float</span>
<span class="sd">        :param is_p_wave: Whether to search the P (``True``) or S (``False``)</span>
<span class="sd">            wave.</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: The minimum ray parameter, in s/km.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="mf">1e300</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">depth_in_high_slowness</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="mf">1e300</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">s_layer</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p_layers</span> <span class="k">if</span> <span class="n">is_p_wave</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">s_layers</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">depth</span><span class="p">:</span>
                    <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min_p_so_far</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span>
                    <span class="k">return</span> <span class="n">min_p_so_far</span>
                <span class="k">elif</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">depth</span><span class="p">:</span>
                    <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span>
                        <span class="n">min_p_so_far</span><span class="p">,</span>
                        <span class="n">evaluate_at_bullen</span><span class="p">(</span><span class="n">s_layer</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span>
                                           <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">))</span>
                    <span class="k">return</span> <span class="n">min_p_so_far</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min_p_so_far</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_above</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">),</span> <span class="n">is_p_wave</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">depth</span> <span class="o">==</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]:</span>
                <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="n">evaluate_at_bullen</span><span class="p">(</span><span class="n">s_layer</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">min_p_so_far</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;getMinRayParam&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;get_min_ray_param&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">getMinRayParam</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;getMinRayParam&#39; has been renamed to</span>
<span class="sd">        &#39;get_min_ray_param&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_ray_param</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.get_min_ray_param"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.get_min_ray_param.html#obspy.taup.slowness_model.SlownessModel.get_min_ray_param">[docs]</a>    <span class="k">def</span> <span class="nf">get_min_ray_param</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Find minimum slowness, turning or reflected, at or above a depth.</span>

<span class="sd">        Normally this is the slowness sample at the given depth, but if the</span>
<span class="sd">        depth is within a high slowness zone, then it may be smaller. Also, at</span>
<span class="sd">        first order discontinuities, there may be many slowness samples at the</span>
<span class="sd">        same depth.</span>

<span class="sd">        :param depth: The depth to search for, in km.</span>
<span class="sd">        :type depth: float</span>
<span class="sd">        :param is_p_wave: Whether to search the P (``True``) or S (``False``)</span>
<span class="sd">            wave.</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: The minimum ray parameter, in s/km.</span>
<span class="sd">        :rtype: float</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_min_turn_ray_param</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span>
        <span class="n">s_layer_above</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_above</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">),</span> <span class="n">is_p_wave</span><span class="p">)</span>
        <span class="n">s_layer_below</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_below</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">),</span> <span class="n">is_p_wave</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s_layer_above</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">depth</span><span class="p">:</span>
            <span class="n">min_p_so_far</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">min_p_so_far</span><span class="p">,</span> <span class="n">s_layer_above</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span>
                               <span class="n">s_layer_below</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">min_p_so_far</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;splitLayer&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;split_layer&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">splitLayer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;splitLayer&#39; has been renamed to</span>
<span class="sd">        &#39;split_layer&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_layer</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="SlownessModel.split_layer"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel.split_layer.html#obspy.taup.slowness_model.SlownessModel.split_layer">[docs]</a>    <span class="k">def</span> <span class="nf">split_layer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Split a slowness layer into two slowness layers.</span>

<span class="sd">        The interpolation for splitting a layer is a Bullen p=Ar^B and so does</span>
<span class="sd">        not directly use information from the VelocityModel.</span>

<span class="sd">        :param depth: The depth at which attempt a split, in km.</span>
<span class="sd">        :type depth: float</span>
<span class="sd">        :param is_p_wave: Whether to split based on P (``True``) or S</span>
<span class="sd">            (``False``) wave.</span>
<span class="sd">        :type is_p_wave: bool</span>

<span class="sd">        :returns: Information about the split as (or if) it was performed, such</span>
<span class="sd">            that:</span>

<span class="sd">            * ``needed_split=True`` if a layer was actually split;</span>
<span class="sd">            * ``moved_sample=True`` if a layer was very close, and so moving</span>
<span class="sd">              the layer&#39;s depth is better than making a very thin layer;</span>
<span class="sd">            * ``ray_param=...``, the new ray parameter (in s/km), if the layer</span>
<span class="sd">              was split.</span>

<span class="sd">        :rtype: :class:`~.SplitLayerInfo`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">layer_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_number_above</span><span class="p">(</span><span class="n">depth</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span>
        <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="n">layer_num</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">depth</span> <span class="ow">or</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">depth</span><span class="p">:</span>
            <span class="c1"># Depth is already on a slowness layer boundary so no need to</span>
            <span class="c1"># split any slowness layers.</span>
            <span class="k">return</span> <span class="n">SplitLayerInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">depth</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.000001</span><span class="p">:</span>
            <span class="c1"># Check for very thin layers, just move the layer to hit the</span>
            <span class="c1"># boundary.</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">out_layers</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">p_layers</span> <span class="k">if</span> <span class="n">is_p_wave</span> <span class="k">else</span> <span class="n">out</span><span class="o">.</span><span class="n">s_layers</span>
            <span class="n">out_layers</span><span class="p">[</span><span class="n">layer_num</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span> <span class="n">depth</span><span class="p">,</span>
                                     <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">])</span>
            <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="n">layer_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span>
            <span class="n">out_layers</span><span class="p">[</span><span class="n">layer_num</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span>
                                         <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span>
                                         <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span> <span class="n">depth</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">SplitLayerInfo</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">depth</span> <span class="o">-</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mf">0.000001</span><span class="p">:</span>
            <span class="c1"># As above.</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">out_layers</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">p_layers</span> <span class="k">if</span> <span class="n">is_p_wave</span> <span class="k">else</span> <span class="n">out</span><span class="o">.</span><span class="n">s_layers</span>
            <span class="n">out_layers</span><span class="p">[</span><span class="n">layer_num</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span>
                                     <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span> <span class="n">depth</span><span class="p">)</span>
            <span class="n">s_layer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_slowness_layer</span><span class="p">(</span><span class="n">layer_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span>
            <span class="n">out_layers</span><span class="p">[</span><span class="n">layer_num</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span> <span class="n">depth</span><span class="p">,</span>
                                         <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span>
                                         <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">])</span>
            <span class="k">return</span> <span class="n">SplitLayerInfo</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Must split properly.</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">evaluate_at_bullen</span><span class="p">(</span><span class="n">s_layer</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">)</span>
            <span class="n">top_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span>
                                   <span class="n">p</span><span class="p">,</span> <span class="n">depth</span><span class="p">)],</span>
                                 <span class="n">dtype</span><span class="o">=</span><span class="n">SlownessLayer</span><span class="p">)</span>
            <span class="n">bot_layer</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">depth</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">])</span>
            <span class="n">out_layers</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">p_layers</span> <span class="k">if</span> <span class="n">is_p_wave</span> <span class="k">else</span> <span class="n">out</span><span class="o">.</span><span class="n">s_layers</span>
            <span class="n">out_layers</span><span class="p">[</span><span class="n">layer_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_layer</span>
            <span class="n">out_layers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">out_layers</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">top_layer</span><span class="p">)</span>
            <span class="c1"># Fix critical layers since we added a slowness layer.</span>
            <span class="n">out_critical_depths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">critical_depths</span>
            <span class="n">_fix_critical_depths</span><span class="p">(</span><span class="n">out_critical_depths</span><span class="p">,</span> <span class="n">layer_num</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">is_p_wave</span><span class="p">:</span>
                <span class="n">out_p_layers</span> <span class="o">=</span> <span class="n">out_layers</span>
                <span class="n">out_s_layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_other_layers</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">s_layers</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">,</span>
                                                      <span class="n">top_layer</span><span class="p">,</span> <span class="n">bot_layer</span><span class="p">,</span>
                                                      <span class="n">out_critical_depths</span><span class="p">,</span>
                                                      <span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out_p_layers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fix_other_layers</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">p_layers</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">s_layer</span><span class="p">,</span>
                                                      <span class="n">top_layer</span><span class="p">,</span> <span class="n">bot_layer</span><span class="p">,</span>
                                                      <span class="n">out_critical_depths</span><span class="p">,</span>
                                                      <span class="kc">True</span><span class="p">)</span>
                <span class="n">out_s_layers</span> <span class="o">=</span> <span class="n">out_layers</span>
            <span class="n">out</span><span class="o">.</span><span class="n">critical_depths</span> <span class="o">=</span> <span class="n">out_critical_depths</span>
            <span class="n">out</span><span class="o">.</span><span class="n">p_layers</span> <span class="o">=</span> <span class="n">out_p_layers</span>
            <span class="n">out</span><span class="o">.</span><span class="n">s_layers</span> <span class="o">=</span> <span class="n">out_s_layers</span>
            <span class="k">return</span> <span class="n">SplitLayerInfo</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>

<div class="viewcode-block" id="SlownessModel._fix_other_layers"><a class="viewcode-back" href="../../../packages/autogen/obspy.taup.slowness_model.SlownessModel._fix_other_layers.html#obspy.taup.slowness_model.SlownessModel._fix_other_layers">[docs]</a>    <span class="k">def</span> <span class="nf">_fix_other_layers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other_layers</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">changed_layer</span><span class="p">,</span> <span class="n">new_top_layer</span><span class="p">,</span>
                          <span class="n">new_bot_layer</span><span class="p">,</span> <span class="n">critical_depths</span><span class="p">,</span> <span class="n">is_p_wave</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fix other wave layers when a split is made.</span>

<span class="sd">        This performs the second split of the *other* wave type when a split is</span>
<span class="sd">        made by :meth:`split_layer`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">other_layers</span>
        <span class="c1"># Make sure to keep sampling consistent. If in a fluid, both wave</span>
        <span class="c1"># types will share a single slowness layer.</span>

        <span class="n">other_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">other_layers</span> <span class="o">==</span> <span class="n">changed_layer</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">out</span><span class="p">[</span><span class="n">other_index</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">new_bot_layer</span>
            <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">other_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">new_top_layer</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">other_layer_num</span><span class="p">,</span> <span class="n">s_layer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">copy</span><span class="p">()):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span> <span class="o">-</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Found a slowness layer with the other wave type that</span>
                <span class="c1"># contains the new slowness sample.</span>
                <span class="n">top_layer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span>
                    <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_p&#39;</span><span class="p">],</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;top_depth&#39;</span><span class="p">],</span> <span class="n">p</span><span class="p">,</span>
                    <span class="n">bullen_depth_for</span><span class="p">(</span><span class="n">s_layer</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">radius_of_planet</span><span class="p">))],</span>
                    <span class="n">dtype</span><span class="o">=</span><span class="n">SlownessLayer</span><span class="p">)</span>
                <span class="n">bot_layer</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">top_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">],</span>
                             <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_p&#39;</span><span class="p">],</span> <span class="n">s_layer</span><span class="p">[</span><span class="s1">&#39;bot_depth&#39;</span><span class="p">])</span>
                <span class="n">out</span><span class="p">[</span><span class="n">other_layer_num</span><span class="p">]</span> <span class="o">=</span> <span class="n">bot_layer</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">other_layer_num</span><span class="p">,</span> <span class="n">top_layer</span><span class="p">)</span>
                <span class="c1"># Fix critical layers since we have added a slowness layer.</span>
                <span class="n">_fix_critical_depths</span><span class="p">(</span><span class="n">critical_depths</span><span class="p">,</span>
                                     <span class="n">other_layer_num</span><span class="p">,</span> <span class="ow">not</span> <span class="n">is_p_wave</span><span class="p">)</span>
                <span class="c1"># Skip next layer as it was just added: achieved by slicing</span>
                <span class="c1"># the list iterator.</span>

        <span class="k">return</span> <span class="n">out</span></div></div>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a> &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, lafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Kufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaim, Sbastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clment</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Khler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>