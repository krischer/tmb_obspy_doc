<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.io.xseed.parser &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.io.xseed.parser</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Main module containing XML-SEED parser.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org)</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA @UnusedWildImport</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="k">import</span> <span class="n">native_str</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">zipfile</span>

<span class="kn">from</span> <span class="nn">lxml</span> <span class="k">import</span> <span class="n">etree</span>
<span class="kn">from</span> <span class="nn">lxml.etree</span> <span class="k">import</span> <span class="n">parse</span> <span class="k">as</span> <span class="n">xmlparse</span>
<span class="kn">from</span> <span class="nn">lxml.etree</span> <span class="k">import</span> <span class="n">Element</span><span class="p">,</span> <span class="n">SubElement</span><span class="p">,</span> <span class="n">tostring</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">obspy</span> <span class="k">import</span> <span class="n">Stream</span><span class="p">,</span> <span class="n">Trace</span><span class="p">,</span> <span class="n">__version__</span>
<span class="kn">from</span> <span class="nn">obspy.core.utcdatetime</span> <span class="k">import</span> <span class="n">UTCDateTime</span>
<span class="kn">from</span> <span class="nn">obspy.core.util.base</span> <span class="k">import</span> <span class="n">download_to_file</span>
<span class="kn">from</span> <span class="nn">obspy.core.util.decorator</span> <span class="k">import</span> <span class="n">map_example_filename</span><span class="p">,</span> <span class="n">deprecated</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="k">import</span> <span class="n">DEFAULT_XSEED_VERSION</span><span class="p">,</span> <span class="n">blockette</span>
<span class="kn">from</span> <span class="nn">.utils</span> <span class="k">import</span> <span class="n">IGNORE_ATTR</span><span class="p">,</span> <span class="n">SEEDParserException</span><span class="p">,</span> <span class="n">to_tag</span>


<span class="n">CONTINUE_FROM_LAST_RECORD</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;*&#39;</span>
<span class="n">HEADERS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">]</span>
<span class="c1"># @see: https://www.fdsn.org/seed_manual/SEEDManual_V2.4.pdf, p. 24-26</span>
<span class="n">HEADER_INFO</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;V&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Volume Index Control Header&#39;</span><span class="p">,</span>
          <span class="s1">&#39;blockettes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]},</span>
    <span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Abbreviation Dictionary Control Header&#39;</span><span class="p">,</span>
          <span class="s1">&#39;blockettes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">]},</span>
    <span class="s1">&#39;S&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Station Control Header&#39;</span><span class="p">,</span>
          <span class="s1">&#39;blockettes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">]}</span>
<span class="p">}</span>
<span class="n">RESP_BLOCKETTES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">]</span>

<span class="n">XSEED_VERSIONS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="s1">&#39;1.1&#39;</span><span class="p">]</span>

<span class="c1"># Index fields of the abbreviation blockettes.</span>
<span class="n">INDEX_FIELDS</span> <span class="o">=</span> <span class="p">{</span><span class="mi">30</span><span class="p">:</span> <span class="s1">&#39;data_format_identifier_code&#39;</span><span class="p">,</span>
                <span class="mi">31</span><span class="p">:</span> <span class="s1">&#39;comment_code_key&#39;</span><span class="p">,</span>
                <span class="mi">32</span><span class="p">:</span> <span class="s1">&#39;source_lookup_code&#39;</span><span class="p">,</span>
                <span class="mi">33</span><span class="p">:</span> <span class="s1">&#39;abbreviation_lookup_code&#39;</span><span class="p">,</span>
                <span class="mi">34</span><span class="p">:</span> <span class="s1">&#39;unit_lookup_code&#39;</span><span class="p">,</span>
                <span class="mi">35</span><span class="p">:</span> <span class="s1">&#39;beam_lookup_code&#39;</span><span class="p">}</span>


<div class="viewcode-block" id="Parser"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.html#obspy.io.xseed.parser.Parser">[docs]</a><span class="k">class</span> <span class="nc">Parser</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The XML-SEED parser class parses dataless or full SEED volumes.</span>

<span class="sd">    .. seealso::</span>

<span class="sd">        The SEED file format description can be found at</span>
<span class="sd">        https://www.fdsn.org/seed_manual/SEEDManual_V2.4.pdf .</span>

<span class="sd">        The XML-SEED format was proposed in [Tsuboi2004]_.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Parser.__init__"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.__init__.html#obspy.io.xseed.parser.Parser.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the SEED parser.</span>

<span class="sd">        :type data: str, bytes, io.BytesIO or file</span>
<span class="sd">        :param data: Filename, URL, XSEED/SEED string, file pointer or</span>
<span class="sd">            BytesIO.</span>
<span class="sd">        :type debug: bool</span>
<span class="sd">        :param debug: Enables a verbose debug log during parsing of SEED file.</span>
<span class="sd">        :type strict: bool</span>
<span class="sd">        :param strict: Parser will raise an exception if SEED files does not</span>
<span class="sd">            stay within the SEED specifications.</span>
<span class="sd">        :type compact: bool</span>
<span class="sd">        :param compact: SEED volume will contain compact data strings. Missing</span>
<span class="sd">            time strings will be filled with 00:00:00.0000 if this option is</span>
<span class="sd">            disabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record_length</span> <span class="o">=</span> <span class="mi">4096</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="mf">2.4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blockettes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strict</span> <span class="o">=</span> <span class="n">strict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compact</span> <span class="o">=</span> <span class="n">compact</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># All parsed data is organized in volume, abbreviations and a list of</span>
        <span class="c1"># stations.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># if a file name is given, read it directly to the parser object</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parser.__str__"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.__str__.html#obspy.io.xseed.parser.Parser.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="s1">&#39;No data&#39;</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;No data&#39;</span>
        <span class="n">ret_str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">()</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s2">&quot;Networks:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="c1"># Sort alphabetically.</span>
        <span class="n">networks</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">inv</span><span class="p">[</span><span class="s2">&quot;networks&quot;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;network_code&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="n">networks</span><span class="p">:</span>
            <span class="n">ret_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">network</span><span class="p">[</span><span class="s2">&quot;network_code&quot;</span><span class="p">],</span> <span class="n">network</span><span class="p">[</span><span class="s2">&quot;network_name&quot;</span><span class="p">])</span>
        <span class="n">stations</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">inv</span><span class="p">[</span><span class="s2">&quot;stations&quot;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">])</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s2">&quot;Stations:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
            <span class="n">ret_str</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">station</span><span class="p">[</span><span class="s2">&quot;station_id&quot;</span><span class="p">],</span> <span class="n">station</span><span class="p">[</span><span class="s2">&quot;station_name&quot;</span><span class="p">])</span>
        <span class="n">channels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">inv</span><span class="p">[</span><span class="s2">&quot;channels&quot;</span><span class="p">],</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;channel_id&quot;</span><span class="p">])</span>
        <span class="n">ret_str</span> <span class="o">+=</span> <span class="s2">&quot;Channels:</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">channels</span><span class="p">:</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;start_date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">if</span> \
                <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;start_date&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="n">end_date</span> <span class="o">=</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;end_date&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span> <span class="k">if</span> \
                <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;end_date&quot;</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
            <span class="n">ret_str</span> <span class="o">+=</span> <span class="p">(</span>
                <span class="s2">&quot;</span><span class="se">\t</span><span class="si">%s</span><span class="s2"> | </span><span class="si">%.2f</span><span class="s2"> Hz | </span><span class="si">%s</span><span class="s2"> | </span><span class="si">%s</span><span class="s2"> - </span><span class="si">%s</span><span class="s2"> | Lat: </span><span class="si">%.1f</span><span class="s2">, Lng: </span><span class="si">%.1f</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">%</span> \
                <span class="p">(</span><span class="n">channel</span><span class="p">[</span><span class="s2">&quot;channel_id&quot;</span><span class="p">],</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;sampling_rate&quot;</span><span class="p">],</span>
                 <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;instrument&quot;</span><span class="p">],</span> <span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">,</span>
                 <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">],</span> <span class="n">channel</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">ret_str</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span></div>

<div class="viewcode-block" id="Parser._repr_pretty_"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._repr_pretty_.html#obspy.io.xseed.parser.Parser._repr_pretty_">[docs]</a>    <span class="k">def</span> <span class="nf">_repr_pretty_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">cycle</span><span class="p">):</span>
        <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="Parser.read"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.read.html#obspy.io.xseed.parser.Parser.read">[docs]</a>    <span class="nd">@map_example_filename</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        General parser method for XML-SEED and Dataless SEED files.</span>

<span class="sd">        :type data: str, bytes, io.BytesIO or file</span>
<span class="sd">        :param data: Filename, URL or XSEED/SEED string as file pointer or</span>
<span class="sd">            BytesIO.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_format&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">):</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Clearing parser before every subsequent read()&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># try to transform everything into BytesIO object</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;://&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">url</span> <span class="o">=</span> <span class="n">data</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
                <span class="n">download_to_file</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">filename_or_buffer</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
                <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                <span class="c1"># looks like a file - read it</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">pass</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;data is neither filename nor valid URL&quot;</span><span class="p">)</span>
        <span class="c1"># but could also be a big string with data</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>
        <span class="c1"># check first byte of data BytesIO object</span>
        <span class="n">first_byte</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">first_byte</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="c1"># SEED volumes starts with a number</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_seed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="s1">&#39;SEED&#39;</span>
        <span class="k">elif</span> <span class="n">first_byte</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39;&lt;&#39;</span><span class="p">:</span>
            <span class="c1"># XML files should always starts with an &#39;&lt;&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parse_xseed</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># if it looks like the XML is not XSEED, tell the user</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">is_xseed</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Encountered an error during parsing XSEED file &quot;</span>
                           <span class="s2">&quot;(</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">). Note that the XSEED parser can not &quot;</span>
                           <span class="s2">&quot;parse StationXML. Please contact developers if &quot;</span>
                           <span class="s2">&quot;your file really is XML-SEED.&quot;</span><span class="p">)</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)))</span>
                <span class="k">raise</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="s1">&#39;XSEED&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IOError</span><span class="p">(</span><span class="s2">&quot;First byte of data must be in [0-9&lt;]&quot;</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getXSEED&#39; has been renamed to &#39;get_xseed&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getXSEED</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xseed</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.get_xseed"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.get_xseed.html#obspy.io.xseed.parser.Parser.get_xseed">[docs]</a>    <span class="k">def</span> <span class="nf">get_xseed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">DEFAULT_XSEED_VERSION</span><span class="p">,</span> <span class="n">split_stations</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a XSEED representation of the current Parser object.</span>

<span class="sd">        :type version: float, optional</span>
<span class="sd">        :param version: XSEED version string (default is ``1.1``).</span>
<span class="sd">        :type split_stations: bool, optional</span>
<span class="sd">        :param split_stations: Splits stations containing multiple channels</span>
<span class="sd">            into multiple documents.</span>
<span class="sd">        :rtype: str or dict</span>
<span class="sd">        :return: Returns either a string or a dict of strings depending</span>
<span class="sd">            on the flag ``split_stations``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">version</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">XSEED_VERSIONS</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="s2">&quot;Unknown XML-SEED version!&quot;</span><span class="p">)</span>
        <span class="n">doc</span> <span class="o">=</span> <span class="n">Element</span><span class="p">(</span><span class="s2">&quot;xseed&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="n">version</span><span class="p">)</span>
        <span class="c1"># Nothing to write if not all necessary data is available.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span> <span class="ow">or</span> \
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No data to be written available.&#39;</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Check blockettes:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_blockettes</span><span class="p">():</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Not all necessary blockettes are available.&#39;</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Add blockettes 11 and 12 only for XSEED version 1.0.</span>
        <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;1.0&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_create_blockettes_11_and_12</span><span class="p">(</span><span class="n">blockette12</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Now start actually filling the XML tree.</span>
        <span class="c1"># Volume header:</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">to_tag</span><span class="p">(</span><span class="s1">&#39;Volume Index Control Header&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">:</span>
            <span class="n">sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkt</span><span class="o">.</span><span class="n">get_xml</span><span class="p">(</span><span class="n">xseed_version</span><span class="o">=</span><span class="n">version</span><span class="p">))</span>
        <span class="c1"># Delete blockettes 11 and 12 if necessary.</span>
        <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;1.0&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_delete_blockettes_11_and_12</span><span class="p">()</span>
        <span class="c1"># Abbreviations:</span>
        <span class="n">sub</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span>
            <span class="n">doc</span><span class="p">,</span> <span class="n">to_tag</span><span class="p">(</span><span class="s1">&#39;Abbreviation Dictionary Control Header&#39;</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span><span class="p">:</span>
            <span class="n">sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkt</span><span class="o">.</span><span class="n">get_xml</span><span class="p">(</span><span class="n">xseed_version</span><span class="o">=</span><span class="n">version</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">split_stations</span><span class="p">:</span>
            <span class="c1"># Don&#39;t split stations</span>
            <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">:</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">to_tag</span><span class="p">(</span><span class="s1">&#39;Station Control Header&#39;</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">station</span><span class="p">:</span>
                    <span class="n">sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkt</span><span class="o">.</span><span class="n">get_xml</span><span class="p">(</span><span class="n">xseed_version</span><span class="o">=</span><span class="n">version</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;1.0&#39;</span><span class="p">:</span>
                <span class="c1"># To pass the XSD schema test an empty time span control header</span>
                <span class="c1"># is added to the end of the file.</span>
                <span class="n">SubElement</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">to_tag</span><span class="p">(</span><span class="s1">&#39;Timespan Control Header&#39;</span><span class="p">))</span>
                <span class="c1"># Also no data is present in all supported SEED files.</span>
                <span class="n">SubElement</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">to_tag</span><span class="p">(</span><span class="s1">&#39;Data Records&#39;</span><span class="p">))</span>
            <span class="c1"># Return single XML String.</span>
            <span class="k">return</span> <span class="n">tostring</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># generate a dict of XML resources for each station</span>
            <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">:</span>
                <span class="n">cdoc</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span>
                <span class="n">sub</span> <span class="o">=</span> <span class="n">SubElement</span><span class="p">(</span><span class="n">cdoc</span><span class="p">,</span> <span class="n">to_tag</span><span class="p">(</span><span class="s1">&#39;Station Control Header&#39;</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">station</span><span class="p">:</span>
                    <span class="n">sub</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkt</span><span class="o">.</span><span class="n">get_xml</span><span class="p">(</span><span class="n">xseed_version</span><span class="o">=</span><span class="n">version</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;1.0&#39;</span><span class="p">:</span>
                    <span class="c1"># To pass the XSD schema test an empty time span control</span>
                    <span class="c1"># header is added to the end of the file.</span>
                    <span class="n">SubElement</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">to_tag</span><span class="p">(</span><span class="s1">&#39;Timespan Control Header&#39;</span><span class="p">))</span>
                    <span class="c1"># Also no data is present in all supported SEED files.</span>
                    <span class="n">SubElement</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">to_tag</span><span class="p">(</span><span class="s1">&#39;Data Records&#39;</span><span class="p">))</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="n">station</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">end_effective_date</span><span class="o">.</span><span class="n">datetime</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">tostring</span><span class="p">(</span><span class="n">cdoc</span><span class="p">,</span> <span class="n">pretty_print</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                      <span class="n">xml_declaration</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;UTF-8&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">result</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;writeXSEED&#39; has been renamed to &#39;write_xseed&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">writeXSEED</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_xseed</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.write_xseed"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.write_xseed.html#obspy.io.xseed.parser.Parser.write_xseed">[docs]</a>    <span class="k">def</span> <span class="nf">write_xseed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a XML-SEED file with given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_xseed</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">result</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">):</span>
                    <span class="c1"># past meta data - append timestamp</span>
                    <span class="n">fn</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.xml&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">fn</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.xml&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># current meta data - leave original file name</span>
                    <span class="n">fn</span> <span class="o">=</span> <span class="n">filename</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fn</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;get_seed&#39; has been renamed to &#39;get_seed&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getSEED</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_seed</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.get_seed"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.get_seed.html#obspy.io.xseed.parser.Parser.get_seed">[docs]</a>    <span class="k">def</span> <span class="nf">get_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">compact</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a SEED representation of the current Parser object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compact</span> <span class="o">=</span> <span class="n">compact</span>
        <span class="c1"># Nothing to write if not all necessary data is available.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span> <span class="ow">or</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No data to be written available.&#39;</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Check blockettes:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_blockettes</span><span class="p">():</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Not all necessary blockettes are available.&#39;</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># String to be written to:</span>
        <span class="n">seed_string</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
        <span class="n">cur_count</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">volume</span><span class="p">,</span> <span class="n">abbreviations</span><span class="p">,</span> <span class="n">stations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_blockettes_11_and_12</span><span class="p">()</span>
        <span class="c1"># Delete Blockette 11 again.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_delete_blockettes_11_and_12</span><span class="p">()</span>

        <span class="c1"># Finally write the actual SEED String.</span>
        <span class="k">def</span> <span class="nf">fmt_seed</span><span class="p">(</span><span class="n">cnt</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;</span><span class="si">%06i</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">cnt</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">i</span>

        <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">volume</span><span class="p">:</span>
            <span class="n">seed_string</span> <span class="o">+=</span> <span class="n">fmt_seed</span><span class="p">(</span><span class="n">cur_count</span><span class="p">,</span> <span class="n">_i</span><span class="p">)</span>
            <span class="n">cur_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">abbreviations</span><span class="p">:</span>
            <span class="n">seed_string</span> <span class="o">+=</span> <span class="n">fmt_seed</span><span class="p">(</span><span class="n">cur_count</span><span class="p">,</span> <span class="n">_i</span><span class="p">)</span>
            <span class="n">cur_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="c1"># Remove name of the stations.</span>
        <span class="n">stations</span> <span class="o">=</span> <span class="p">[</span><span class="n">_i</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_j</span> <span class="ow">in</span> <span class="n">_i</span><span class="p">:</span>
                <span class="n">seed_string</span> <span class="o">+=</span> <span class="n">fmt_seed</span><span class="p">(</span><span class="n">cur_count</span><span class="p">,</span> <span class="n">_j</span><span class="p">)</span>
                <span class="n">cur_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">seed_string</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;writeSEED&#39; has been renamed to &#39;write_seed&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">writeSEED</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_seed</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.write_seed"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.write_seed.html#obspy.io.xseed.parser.Parser.write_seed">[docs]</a>    <span class="k">def</span> <span class="nf">write_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a dataless SEED file with given name.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_seed</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getRESP&#39; has been renamed to &#39;get_resp&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getRESP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.get_resp"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.get_resp.html#obspy.io.xseed.parser.Parser.get_resp">[docs]</a>    <span class="k">def</span> <span class="nf">get_resp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a RESP representation of the current Parser object.</span>

<span class="sd">        It aims to produce the same RESP files as when running rdseed with</span>
<span class="sd">        the command: &quot;rdseed -f seed.test -R&quot;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if there are any stations at all.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;No data to be written.&#39;</span><span class="p">)</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Channel Response list.</span>
        <span class="n">resp_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over all stations.</span>
        <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">:</span>
            <span class="n">resp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">blockettes</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Read the current station information and store it.</span>
            <span class="n">cur_station</span> <span class="o">=</span> <span class="n">station</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station_call_letters</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">cur_network</span> <span class="o">=</span> <span class="n">station</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">network_code</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="c1"># Loop over all blockettes in that station.</span>
            <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">station</span><span class="p">)):</span>
                <span class="c1"># Catch all blockette 52.</span>
                <span class="k">if</span> <span class="n">station</span><span class="p">[</span><span class="n">_i</span><span class="p">]</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">52</span><span class="p">:</span>
                    <span class="n">cur_location</span> <span class="o">=</span> <span class="n">station</span><span class="p">[</span><span class="n">_i</span><span class="p">]</span><span class="o">.</span><span class="n">location_identifier</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">cur_channel</span> <span class="o">=</span> <span class="n">station</span><span class="p">[</span><span class="n">_i</span><span class="p">]</span><span class="o">.</span><span class="n">channel_identifier</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="c1"># Take old list and send it to the RESP parser.</span>
                    <span class="n">_pos</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
                    <span class="n">resp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_END</span><span class="p">)</span>
                    <span class="n">_len</span> <span class="o">=</span> <span class="n">resp</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
                    <span class="n">resp</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">_pos</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">_len</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="c1"># Send the blockettes to the parser and append to list.</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_get_resp_string</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">blockettes</span><span class="p">,</span> <span class="n">cur_station</span><span class="p">)</span>
                        <span class="n">resp_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span> <span class="n">resp</span><span class="p">])</span>
                    <span class="c1"># Create the file name.</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;RESP.</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span> \
                        <span class="o">%</span> <span class="p">(</span><span class="n">cur_network</span><span class="p">,</span> <span class="n">cur_station</span><span class="p">,</span> <span class="n">cur_location</span><span class="p">,</span> <span class="n">cur_channel</span><span class="p">)</span>
                    <span class="c1"># Create new BytesIO and list.</span>
                    <span class="n">resp</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">blockettes</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">blockettes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">station</span><span class="p">[</span><span class="n">_i</span><span class="p">])</span>
                    <span class="c1"># Write header and the first two lines to the string.</span>
                    <span class="n">header</span> <span class="o">=</span> \
                        <span class="s1">&#39;#</span><span class="se">\t\t</span><span class="s1">&lt;&lt; obspy, Version </span><span class="si">%s</span><span class="s1"> &gt;&gt;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">__version__</span> <span class="o">+</span> \
                        <span class="s1">&#39;#</span><span class="se">\t\t\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;#</span><span class="se">\t\t</span><span class="s1">======== CHANNEL RESPONSE DATA ========</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span> \
                        <span class="s1">&#39;B050F03     Station:     </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">cur_station</span> <span class="o">+</span> \
                        <span class="s1">&#39;B050F16     Network:     </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">cur_network</span>
                    <span class="c1"># Write to BytesIO.</span>
                    <span class="n">resp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="p">))</span>
                    <span class="k">continue</span>
                <span class="n">blockettes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">station</span><span class="p">[</span><span class="n">_i</span><span class="p">])</span>
            <span class="c1"># It might happen that no blockette 52 is specified,</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">blockettes</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># One last time for the last channel.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_resp_string</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">blockettes</span><span class="p">,</span> <span class="n">cur_station</span><span class="p">)</span>
                <span class="n">resp_list</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">filename</span><span class="p">,</span> <span class="n">resp</span><span class="p">])</span>
        <span class="c1"># Combine multiple channels.</span>
        <span class="n">new_resp_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">available_channels</span> <span class="o">=</span> <span class="p">[</span><span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">resp_list</span><span class="p">]</span>
        <span class="n">channel_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">available_channels</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">channel</span> <span class="ow">in</span> <span class="n">channel_set</span><span class="p">:</span>
            <span class="n">channel_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_i</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">resp_list</span> <span class="k">if</span> <span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">channel</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">new_resp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel_list</span><span class="p">)):</span>
                    <span class="n">channel_list</span><span class="p">[</span><span class="n">_i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                    <span class="n">channel_list</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">channel_list</span><span class="p">[</span><span class="n">_i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">new_resp_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">channel_list</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">new_resp_list</span></div>

<div class="viewcode-block" id="Parser._select"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._select.html#obspy.io.xseed.parser.Parser._select">[docs]</a>    <span class="k">def</span> <span class="nf">_select</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_id</span><span class="p">,</span> <span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects all blockettes related to given SEED id and datetime.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">old_format</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format</span>
        <span class="c1"># parse blockettes if not SEED. Needed for XSEED to be initialized.</span>
        <span class="c1"># XXX: Should potentially be fixed at some point.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">!=</span> <span class="s1">&#39;SEED&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_seed</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">old_format</span> <span class="o">==</span> <span class="s2">&quot;XSEED&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_format</span> <span class="o">=</span> <span class="s2">&quot;XSEED&quot;</span>
        <span class="c1"># split id</span>
        <span class="k">if</span> <span class="s1">&#39;.&#39;</span> <span class="ow">in</span> <span class="n">seed_id</span><span class="p">:</span>
            <span class="n">net</span><span class="p">,</span> <span class="n">sta</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">cha</span> <span class="o">=</span> <span class="n">seed_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cha</span> <span class="o">=</span> <span class="n">seed_id</span>
            <span class="n">net</span> <span class="o">=</span> <span class="n">sta</span> <span class="o">=</span> <span class="n">loc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># create a copy of station list</span>
        <span class="n">stations</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">)</span>
        <span class="c1"># filter blockettes list by given SEED id</span>
        <span class="n">station_flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">channel_flag</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">blockettes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">blk</span> <span class="ow">in</span> <span class="n">station</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">blk</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span>
                    <span class="n">station_flag</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">net</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">blk</span><span class="o">.</span><span class="n">network_code</span> <span class="o">!=</span> <span class="n">net</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">sta</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">blk</span><span class="o">.</span><span class="n">station_call_letters</span> <span class="o">!=</span> <span class="n">sta</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="n">station_flag</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">tmpb50</span> <span class="o">=</span> <span class="n">blk</span>
                <span class="k">elif</span> <span class="n">blk</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">52</span> <span class="ow">and</span> <span class="n">station_flag</span><span class="p">:</span>
                    <span class="n">channel_flag</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">if</span> <span class="n">loc</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">blk</span><span class="o">.</span><span class="n">location_identifier</span> <span class="o">!=</span> <span class="n">loc</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">blk</span><span class="o">.</span><span class="n">channel_identifier</span> <span class="o">!=</span> <span class="n">cha</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="n">datetime</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">blk</span><span class="o">.</span><span class="n">start_date</span> <span class="o">&gt;</span> <span class="n">datetime</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">blk</span><span class="o">.</span><span class="n">end_date</span> <span class="ow">and</span> <span class="n">blk</span><span class="o">.</span><span class="n">end_date</span> <span class="o">&lt;</span> <span class="n">datetime</span><span class="p">:</span>
                            <span class="k">continue</span>
                    <span class="n">channel_flag</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="n">blockettes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmpb50</span><span class="p">)</span>
                    <span class="n">blockettes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blk</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">channel_flag</span> <span class="ow">and</span> <span class="n">station_flag</span><span class="p">:</span>
                    <span class="n">blockettes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blk</span><span class="p">)</span>
        <span class="c1"># check number of selected channels (equals number of blockette 52)</span>
        <span class="n">b50s</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">blockettes</span> <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">50</span><span class="p">]</span>
        <span class="n">b52s</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">blockettes</span> <span class="k">if</span> <span class="n">b</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">52</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">b50s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">b52s</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;No channel found with the given SEED id: </span><span class="si">%s</span><span class="s1">&#39;</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">seed_id</span><span class="p">))</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">b50s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">b52s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;More than one channel found with the given SEED id: </span><span class="si">%s</span><span class="s1">&#39;</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">seed_id</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">blockettes</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getPAZ&#39; has been renamed to &#39;get_paz&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getPAZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_paz</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.get_paz"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.get_paz.html#obspy.io.xseed.parser.Parser.get_paz">[docs]</a>    <span class="k">def</span> <span class="nf">get_paz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_id</span><span class="p">,</span> <span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return PAZ.</span>

<span class="sd">        .. note:: Currently only the Laplace transform is supported, that</span>
<span class="sd">            is blockettes 43 and 53. A UserWarning will be raised for</span>
<span class="sd">            unsupported response blockettes, however all other values, such</span>
<span class="sd">            as overall sensitivity, normalization constant, etc. will be still</span>
<span class="sd">            returned if found.</span>

<span class="sd">        :type seed_id: str</span>
<span class="sd">        :param seed_id: SEED or channel id, e.g. ``&quot;BW.RJOB..EHZ&quot;`` or</span>
<span class="sd">            ``&quot;EHE&quot;``.</span>
<span class="sd">        :type datetime: :class:`~obspy.core.utcdatetime.UTCDateTime`, optional</span>
<span class="sd">        :param datetime: Timestamp of requested PAZ values</span>
<span class="sd">        :return: Dictionary containing PAZ as well as the overall</span>
<span class="sd">            sensitivity, the gain in the dictionary is the A0 normalization</span>
<span class="sd">            constant</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">blockettes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select</span><span class="p">(</span><span class="n">seed_id</span><span class="p">,</span> <span class="n">datetime</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">blockettes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">58</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">stage_sequence_number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;sensitivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">sensitivity_gain</span>
                <span class="k">elif</span> <span class="n">blkt</span><span class="o">.</span><span class="n">stage_sequence_number</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;seismometer_gain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">sensitivity_gain</span>
                <span class="k">elif</span> <span class="n">blkt</span><span class="o">.</span><span class="n">stage_sequence_number</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;digitizer_gain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">sensitivity_gain</span>
                <span class="k">elif</span> <span class="n">blkt</span><span class="o">.</span><span class="n">stage_sequence_number</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;digitizer_gain&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;digitizer_gain&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">sensitivity_gain</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;digitizer_gain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">sensitivity_gain</span>
            <span class="k">elif</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">53</span> <span class="ow">or</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">60</span><span class="p">:</span>
                <span class="c1"># If we get a blockette 53 or 60 we should add these</span>
                <span class="k">if</span> <span class="s1">&#39;zeros&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="s1">&#39;poles&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">if</span> <span class="s1">&#39;gain&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
                <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">60</span><span class="p">:</span>
                    <span class="n">abbreviation</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;seismometer_gain&#39;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="p">[</span><span class="n">blk</span><span class="o">.</span><span class="n">sensitivity_gain</span> <span class="k">for</span> <span class="n">blk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span>
                         <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">blk</span><span class="p">,</span> <span class="s1">&#39;response_lookup_key&#39;</span><span class="p">)</span> <span class="ow">and</span>
                            <span class="n">blk</span><span class="o">.</span><span class="n">response_lookup_key</span> <span class="o">==</span> <span class="n">abbreviation</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">abbreviation</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">stages</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">resp</span> <span class="o">=</span> <span class="p">[</span><span class="n">blk</span> <span class="k">for</span> <span class="n">blk</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">blk</span><span class="p">,</span> <span class="s1">&#39;response_lookup_key&#39;</span><span class="p">)</span> <span class="ow">and</span>
                            <span class="n">blk</span><span class="o">.</span><span class="n">response_lookup_key</span> <span class="o">==</span> <span class="n">abbreviation</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;response_type&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">resp</span> <span class="o">=</span> <span class="n">blkt</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;transfer_function_types&#39;</span>
                <span class="c1"># Check if Laplace transform</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;A&quot;</span><span class="p">,</span> <span class="s2">&quot;B&quot;</span><span class="p">]:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Only the Laplace (rad/sec) or Analog (Hz) &#39;</span> <span class="o">+</span> \
                          <span class="s1">&#39;transform response types are supported. &#39;</span> <span class="o">+</span> \
                          <span class="s1">&#39;Skipping other response information.&#39;</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="c1"># A0_normalization_factor</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gain&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="n">resp</span><span class="o">.</span><span class="n">A0_normalization_factor</span>
                <span class="c1"># Poles</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">number_of_complex_poles</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">p</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">real_pole</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">resp</span><span class="o">.</span><span class="n">imaginary_pole</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                        <span class="n">p</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">real_pole</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">imaginary_pole</span><span class="p">)</span>
                    <span class="c1"># Do conversion to Laplace poles</span>
                    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>
                        <span class="n">p</span> <span class="o">*=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
                        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gain&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
                <span class="c1"># Zeros</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">number_of_complex_zeros</span><span class="p">):</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">z</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">real_zero</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">resp</span><span class="o">.</span><span class="n">imaginary_zero</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                        <span class="n">z</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">resp</span><span class="o">.</span><span class="n">real_zero</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">imaginary_zero</span><span class="p">)</span>
                    <span class="c1"># Do conversion to Laplace zeros</span>
                    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">resp</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>
                        <span class="n">z</span> <span class="o">*=</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
                        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;gain&#39;</span><span class="p">]</span> <span class="o">*=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
                    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getCoordinates&#39; has been renamed to &#39;get_coordinates&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getCoordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coordinates</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.get_coordinates"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.get_coordinates.html#obspy.io.xseed.parser.Parser.get_coordinates">[docs]</a>    <span class="k">def</span> <span class="nf">get_coordinates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed_id</span><span class="p">,</span> <span class="n">datetime</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return Coordinates (from blockette 52)</span>

<span class="sd">        :type seed_id: str</span>
<span class="sd">        :param seed_id: SEED or channel id, e.g. ``&quot;BW.RJOB..EHZ&quot;`` or</span>
<span class="sd">            ``&quot;EHE&quot;``.</span>
<span class="sd">        :type datetime: :class:`~obspy.core.utcdatetime.UTCDateTime`, optional</span>
<span class="sd">        :param datetime: Timestamp of requested PAZ values</span>
<span class="sd">        :return: Dictionary containing Coordinates (latitude, longitude,</span>
<span class="sd">            elevation)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">blockettes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select</span><span class="p">(</span><span class="n">seed_id</span><span class="p">,</span> <span class="n">datetime</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">blockettes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">52</span><span class="p">:</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">latitude</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">longitude</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">elevation</span>
                <span class="n">data</span><span class="p">[</span><span class="s1">&#39;local_depth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">local_depth</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">data</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;writeRESP&#39; has been renamed to &#39;write_resp&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">writeRESP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">write_resp</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.write_resp"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.write_resp.html#obspy.io.xseed.parser.Parser.write_resp">[docs]</a>    <span class="k">def</span> <span class="nf">write_resp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">folder</span><span class="p">,</span> <span class="n">zipped</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes for each channel a RESP file within a given folder.</span>

<span class="sd">        :param folder: Folder name.</span>
<span class="sd">        :param zipped: Compresses all files into a single ZIP archive named by</span>
<span class="sd">            the folder name extended with the extension &#39;.zip&#39;.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_resp_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_resp</span><span class="p">()</span>
        <span class="c1"># Check if channel information could be found.</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_resp_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;No channel information could be found. The SEED file &quot;</span>
                   <span class="s2">&quot;needs to contain information about at least one channel.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">zipped</span><span class="p">:</span>
            <span class="c1"># Write single files.</span>
            <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">new_resp_list</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">folder</span><span class="p">:</span>
                    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">folder</span><span class="p">,</span> <span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span>
                <span class="n">response</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
                <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Create a ZIP archive.</span>
            <span class="n">zip_file</span> <span class="o">=</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">folder</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">extsep</span> <span class="o">+</span> <span class="s2">&quot;zip&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">response</span> <span class="ow">in</span> <span class="n">new_resp_list</span><span class="p">:</span>
                <span class="n">response</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
                <span class="n">zip_file</span><span class="o">.</span><span class="n">writestr</span><span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">response</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="n">zip_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Parser._parse_seed"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._parse_seed.html#obspy.io.xseed.parser.Parser._parse_seed">[docs]</a>    <span class="k">def</span> <span class="nf">_parse_seed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses through a whole SEED volume.</span>

<span class="sd">        It will always parse the whole file and skip any time span data.</span>

<span class="sd">        :type data: file or io.BytesIO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Jump to the beginning of the file.</span>
        <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Retrieve some basic data like version and record length.</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
        <span class="c1"># Check whether it starts with record sequence number 1 and a volume</span>
        <span class="c1"># index control header.</span>
        <span class="k">if</span> <span class="n">temp</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;000001V &#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="s2">&quot;Expecting 000001V &quot;</span><span class="p">)</span>
        <span class="c1"># The first blockette has to be Blockette 10.</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">temp</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="sa">b</span><span class="s1">&#39;010&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;008&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;005&#39;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="s2">&quot;Expecting blockette 010, 008 or 005&quot;</span><span class="p">)</span>
        <span class="c1"># Skip the next four bytes containing the length of the blockette.</span>
        <span class="c1"># data.seek(4, 1)</span>
        <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="c1"># Set the version.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
        <span class="c1"># Get the record length.</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>
        <span class="c1"># Test record length.</span>
        <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">temp</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;000002&#39;</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Got an invalid logical record length </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">length</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">record_length</span> <span class="o">=</span> <span class="n">length</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;RECORD LENGTH: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">record_length</span><span class="p">))</span>
        <span class="c1"># Set all temporary attributes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;volume&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;abbreviations&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;stations&#39;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="c1"># Jump back to beginning.</span>
        <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Read the first record.</span>
        <span class="n">record</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">record_length</span><span class="p">)</span>
        <span class="n">merged_data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
        <span class="n">record_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># Loop through file and pass merged records to _parse_merged_data.</span>
        <span class="k">while</span> <span class="n">record</span><span class="p">:</span>
            <span class="n">record_continuation</span> <span class="o">=</span> <span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="mi">7</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span> <span class="o">==</span> <span class="n">CONTINUE_FROM_LAST_RECORD</span><span class="p">)</span>
            <span class="n">same_record_type</span> <span class="o">=</span> <span class="p">(</span><span class="n">record</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">==</span> <span class="n">record_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">record_type</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span> <span class="ow">and</span> <span class="n">record</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">]</span> <span class="o">!=</span> <span class="sa">b</span><span class="s1">&#39;050&#39;</span><span class="p">:</span>
                <span class="n">record_continuation</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">record_continuation</span> <span class="ow">and</span> <span class="n">same_record_type</span><span class="p">:</span>
                <span class="c1"># continued record</span>
                <span class="n">merged_data</span> <span class="o">+=</span> <span class="n">record</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parse_merged_data</span><span class="p">(</span><span class="n">merged_data</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">record_type</span><span class="p">)</span>
                <span class="c1"># first or new type of record</span>
                <span class="n">record_type</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="mi">6</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
                <span class="n">merged_data</span> <span class="o">=</span> <span class="n">record</span><span class="p">[</span><span class="mi">8</span><span class="p">:]</span>
                <span class="k">if</span> <span class="n">record_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">HEADERS</span><span class="p">:</span>
                    <span class="c1"># only parse headers, no data</span>
                    <span class="n">merged_data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="n">record_type</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">break</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">record_continuation</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;========&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">((</span><span class="n">record</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">8</span><span class="p">]))</span>
            <span class="n">record</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">record_length</span><span class="p">)</span>
        <span class="c1"># Use parse once again.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parse_merged_data</span><span class="p">(</span><span class="n">merged_data</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">record_type</span><span class="p">)</span>
        <span class="c1"># Update the internal structure to finish parsing.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_internal_seed_structure</span><span class="p">()</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getInventory&#39; has been renamed to &#39;get_inventory&#39;. &quot;</span>
                <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getInventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.get_inventory"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.get_inventory.html#obspy.io.xseed.parser.Parser.get_inventory">[docs]</a>    <span class="k">def</span> <span class="nf">get_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function returning a dictionary about whats actually in the Parser</span>
<span class="sd">        object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;networks&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;stations&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="n">current_network</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">current_station</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">station</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">50</span><span class="p">:</span>
                    <span class="n">current_network</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">network_code</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">network_id</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">network_identifier_code</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">network_id</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
                        <span class="n">new_id</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                        <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">network_id</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">_i</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
                                <span class="n">new_id</span> <span class="o">+=</span> <span class="n">_i</span>
                        <span class="n">network_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">new_id</span><span class="p">)</span>
                    <span class="n">network_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_abbreviation</span><span class="p">(</span><span class="n">network_id</span><span class="p">)</span>
                    <span class="n">cur_nw</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;network_code&quot;</span><span class="p">:</span> <span class="n">current_network</span><span class="p">,</span>
                              <span class="s2">&quot;network_name&quot;</span><span class="p">:</span> <span class="n">network_name</span><span class="p">}</span>
                    <span class="k">if</span> <span class="n">cur_nw</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;networks&quot;</span><span class="p">]:</span>
                        <span class="n">info</span><span class="p">[</span><span class="s2">&quot;networks&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur_nw</span><span class="p">)</span>
                    <span class="n">current_station</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">station_call_letters</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">cur_stat</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;station_id&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">current_network</span><span class="p">,</span>
                                                         <span class="n">current_station</span><span class="p">),</span>
                                <span class="s2">&quot;station_name&quot;</span><span class="p">:</span> <span class="n">blkt</span><span class="o">.</span><span class="n">site_name</span><span class="p">}</span>
                    <span class="k">if</span> <span class="n">cur_stat</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">info</span><span class="p">[</span><span class="s2">&quot;stations&quot;</span><span class="p">]:</span>
                        <span class="n">info</span><span class="p">[</span><span class="s2">&quot;stations&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cur_stat</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="mi">52</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">current_network</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">current_station</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Something went wrong&quot;</span><span class="p">)</span>
                    <span class="n">chan_info</span> <span class="o">=</span> <span class="p">{}</span>
                    <span class="n">channel</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">channel_identifier</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">location</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">location_identifier</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;channel_id&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">.</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">current_network</span><span class="p">,</span> <span class="n">current_station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">)</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;sampling_rate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">sample_rate</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;instrument&quot;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="bp">self</span><span class="o">.</span><span class="n">_get_abbreviation</span><span class="p">(</span><span class="n">blkt</span><span class="o">.</span><span class="n">instrument_identifier</span><span class="p">)</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;start_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">start_date</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;end_date&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">end_date</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;latitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">latitude</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;longitude&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">longitude</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;elevation_in_m&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">elevation</span>
                    <span class="n">chan_info</span><span class="p">[</span><span class="s2">&quot;local_depth_in_m&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">local_depth</span>
                    <span class="n">info</span><span class="p">[</span><span class="s2">&quot;channels&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chan_info</span><span class="p">)</span>
                    <span class="k">continue</span>
        <span class="k">return</span> <span class="n">info</span></div>

<div class="viewcode-block" id="Parser._get_abbreviation"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._get_abbreviation.html#obspy.io.xseed.parser.Parser._get_abbreviation">[docs]</a>    <span class="k">def</span> <span class="nf">_get_abbreviation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">identifier_code</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper function returning the abbreviation for the given identifier</span>
<span class="sd">        code.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="mi">33</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">abbreviation_lookup_code</span> <span class="o">!=</span> <span class="n">identifier_code</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">return</span> <span class="n">blkt</span><span class="o">.</span><span class="n">abbreviation_description</span>
        <span class="k">return</span> <span class="s2">&quot;&quot;</span></div>

<div class="viewcode-block" id="Parser._parse_xseed"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._parse_xseed.html#obspy.io.xseed.parser.Parser._parse_xseed">[docs]</a>    <span class="k">def</span> <span class="nf">_parse_xseed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parse a XML-SEED string.</span>

<span class="sd">        :type data: file or io.BytesIO</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">xmlparse</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
        <span class="n">xseed_version</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;version&#39;</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()</span>
        <span class="c1"># Set all temporary attributes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;volume&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;abbreviations&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;stations&#39;</span><span class="p">:</span> <span class="p">[]}</span>
        <span class="c1"># Parse volume which is assumed to be the first header. Only parse</span>
        <span class="c1"># blockette 10 and discard the rest.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_parse_xml_blockette</span><span class="p">(</span><span class="n">headers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;V&#39;</span><span class="p">,</span>
                                      <span class="n">xseed_version</span><span class="p">))</span>
        <span class="c1"># Append all abbreviations.</span>
        <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">getchildren</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;abbreviations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_parse_xml_blockette</span><span class="p">(</span><span class="n">blkt</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">xseed_version</span><span class="p">))</span>
        <span class="c1"># Append all stations.</span>
        <span class="k">for</span> <span class="n">control_header</span> <span class="ow">in</span> <span class="n">headers</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">control_header</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s1">&#39;station_control_header&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">control_header</span><span class="o">.</span><span class="n">getchildren</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_parse_xml_blockette</span><span class="p">(</span><span class="n">blkt</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="n">xseed_version</span><span class="p">))</span>
        <span class="c1"># Update internal values.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_internal_seed_structure</span><span class="p">()</span></div>

<div class="viewcode-block" id="Parser._get_resp_string"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._get_resp_string.html#obspy.io.xseed.parser.Parser._get_resp_string">[docs]</a>    <span class="k">def</span> <span class="nf">_get_resp_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resp</span><span class="p">,</span> <span class="n">blockettes</span><span class="p">,</span> <span class="n">station</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes a file like object and a list of blockettes containing all</span>
<span class="sd">        blockettes for one channel and writes them RESP like to the BytesIO.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">blkt52</span> <span class="o">=</span> <span class="n">blockettes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="c1"># The first blockette in the list always has to be Blockette 52.</span>
        <span class="n">channel_info</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Location&#39;</span><span class="p">:</span> <span class="n">blkt52</span><span class="o">.</span><span class="n">location_identifier</span><span class="p">,</span>
                        <span class="s1">&#39;Channel&#39;</span><span class="p">:</span> <span class="n">blkt52</span><span class="o">.</span><span class="n">channel_identifier</span><span class="p">,</span>
                        <span class="s1">&#39;Start date&#39;</span><span class="p">:</span> <span class="n">blkt52</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span>
                        <span class="s1">&#39;End date&#39;</span><span class="p">:</span> <span class="n">blkt52</span><span class="o">.</span><span class="n">end_date</span><span class="p">}</span>
        <span class="c1"># Set location and end date default values or convert end time..</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;??&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;End date&#39;</span><span class="p">]:</span>
            <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;End date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;No Ending Time&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;End date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;End date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format_seed</span><span class="p">()</span>
        <span class="c1"># Convert starttime.</span>
        <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;Start date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;Start date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">format_seed</span><span class="p">()</span>
        <span class="c1"># Write Blockette 52 stuff.</span>
        <span class="n">resp</span><span class="o">.</span><span class="n">write</span><span class="p">((</span>
            <span class="s1">&#39;B052F03     Location:    </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;Location&#39;</span><span class="p">]</span> <span class="o">+</span>
            <span class="s1">&#39;B052F04     Channel:     </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">]</span> <span class="o">+</span>
            <span class="s1">&#39;B052F22     Start date:  </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;Start date&#39;</span><span class="p">]</span> <span class="o">+</span>
            <span class="s1">&#39;B052F23     End date:    </span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;End date&#39;</span><span class="p">]</span> <span class="o">+</span>
            <span class="s1">&#39;#</span><span class="se">\t\t</span><span class="s1">=======================================</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span>
            <span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="p">))</span>
        <span class="c1"># Write all other blockettes. Sort by stage number (0 at the end) and</span>
        <span class="c1"># the specified blockette id order.</span>
        <span class="n">order</span> <span class="o">=</span> <span class="p">[</span><span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">]</span>
        <span class="n">blockettes</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span>
            <span class="n">blockettes</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span>
            <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">stage_sequence_number</span>
                           <span class="k">if</span> <span class="p">(</span><span class="nb">hasattr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s2">&quot;stage_sequence_number&quot;</span><span class="p">)</span> <span class="ow">and</span>
                               <span class="n">x</span><span class="o">.</span><span class="n">stage_sequence_number</span><span class="p">)</span>
                           <span class="k">else</span> <span class="nb">float</span><span class="p">(</span><span class="s2">&quot;inf&quot;</span><span class="p">),</span> <span class="n">order</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">id</span><span class="p">)))</span>

        <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">blockettes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">RESP_BLOCKETTES</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">resp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">blkt</span><span class="o">.</span><span class="n">get_resp</span><span class="p">(</span>
                    <span class="n">station</span><span class="p">,</span> <span class="n">channel_info</span><span class="p">[</span><span class="s1">&#39;Channel&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;RESP output for blockette </span><span class="si">%s</span><span class="s1"> not implemented yet.&#39;</span>
                <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="n">blkt</span><span class="o">.</span><span class="n">id</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parser._parse_xml_blockette"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._parse_xml_blockette.html#obspy.io.xseed.parser.Parser._parse_xml_blockette">[docs]</a>    <span class="k">def</span> <span class="nf">_parse_xml_blockette</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_blockette</span><span class="p">,</span> <span class="n">record_type</span><span class="p">,</span> <span class="n">xseed_version</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes the lxml tree of any blockette and returns a blockette object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get blockette number.</span>
        <span class="n">blockette_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_blockette</span><span class="o">.</span><span class="n">values</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">blockette_id</span> <span class="ow">in</span> <span class="n">HEADER_INFO</span><span class="p">[</span><span class="n">record_type</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;blockettes&#39;</span><span class="p">,</span> <span class="p">[]):</span>
            <span class="n">class_name</span> <span class="o">=</span> <span class="s1">&#39;Blockette</span><span class="si">%03d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">blockette_id</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">blockette</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
                <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span>
                    <span class="s1">&#39;Blockette </span><span class="si">%d</span><span class="s1"> not implemented!&#39;</span> <span class="o">%</span> <span class="n">blockette_id</span><span class="p">)</span>
            <span class="n">blockette_class</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">blockette</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>
            <span class="n">blockette_obj</span> <span class="o">=</span> <span class="n">blockette_class</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
                                            <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span>
                                            <span class="n">compact</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compact</span><span class="p">,</span>
                                            <span class="n">version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
                                            <span class="n">record_type</span><span class="o">=</span><span class="n">record_type</span><span class="p">,</span>
                                            <span class="n">xseed_version</span><span class="o">=</span><span class="n">xseed_version</span><span class="p">)</span>
            <span class="n">blockette_obj</span><span class="o">.</span><span class="n">parse_xml</span><span class="p">(</span><span class="n">xml_blockette</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">blockette_obj</span>
        <span class="k">elif</span> <span class="n">blockette_id</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Unknown blockette type </span><span class="si">%d</span><span class="s2"> found&quot;</span> <span class="o">%</span> <span class="n">blockette_id</span>
            <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parser._create_cut_and_flush_record"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._create_cut_and_flush_record.html#obspy.io.xseed.parser.Parser._create_cut_and_flush_record">[docs]</a>    <span class="k">def</span> <span class="nf">_create_cut_and_flush_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blockettes</span><span class="p">,</span> <span class="n">record_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes all blockettes of a record and return a list of finished records.</span>

<span class="sd">        If necessary it will cut the record and return two or more flushed</span>
<span class="sd">        records.</span>

<span class="sd">        The returned records also include the control header type code and the</span>
<span class="sd">        record continuation code. Therefore the returned record will have the</span>
<span class="sd">        length self.record_length - 6. Other methods are responsible for</span>
<span class="sd">        writing the sequence number.</span>

<span class="sd">        It will always return a list with records.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">record_length</span> <span class="o">-</span> <span class="mi">8</span>
        <span class="n">return_records</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over all blockettes.</span>
        <span class="n">record</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">blockette_</span> <span class="ow">in</span> <span class="n">blockettes</span><span class="p">:</span>
            <span class="n">blockette_</span><span class="o">.</span><span class="n">compact</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compact</span>
            <span class="n">rec_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
            <span class="c1"># Never split a blockettes length/blockette type section across</span>
            <span class="c1"># records.</span>
            <span class="k">if</span> <span class="n">rec_len</span> <span class="o">+</span> <span class="mi">7</span> <span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
                <span class="c1"># Flush the rest of the record if necessary.</span>
                <span class="n">record</span> <span class="o">+=</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">rec_len</span><span class="p">)</span>
                <span class="n">return_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
                <span class="n">record</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
                <span class="n">rec_len</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">blockette_str</span> <span class="o">=</span> <span class="n">blockette_</span><span class="o">.</span><span class="n">get_seed</span><span class="p">()</span>
            <span class="c1"># Calculate how much of the blockette is too long.</span>
            <span class="n">overhead</span> <span class="o">=</span> <span class="n">rec_len</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">blockette_str</span><span class="p">)</span> <span class="o">-</span> <span class="n">length</span>
            <span class="c1"># If negative overhead: Write blockette.</span>
            <span class="k">if</span> <span class="n">overhead</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">record</span> <span class="o">+=</span> <span class="n">blockette_str</span>
            <span class="c1"># Otherwise finish the record and start one or more new ones.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">record</span> <span class="o">+=</span> <span class="n">blockette_str</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">blockette_str</span><span class="p">)</span> <span class="o">-</span> <span class="n">overhead</span><span class="p">]</span>
                <span class="c1"># The record so far not written.</span>
                <span class="n">rest_of_the_record</span> <span class="o">=</span> <span class="n">blockette_str</span><span class="p">[(</span><span class="nb">len</span><span class="p">(</span><span class="n">blockette_str</span><span class="p">)</span> <span class="o">-</span>
                                                    <span class="n">overhead</span><span class="p">):]</span>
                <span class="c1"># Loop over the number of records to be written.</span>
                <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span>
                        <span class="nb">int</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rest_of_the_record</span><span class="p">)</span> <span class="o">/</span>
                                      <span class="nb">float</span><span class="p">(</span><span class="n">length</span><span class="p">)))):</span>
                    <span class="n">return_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
                    <span class="n">record</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
                    <span class="c1"># It doesn&#39;t hurt to index a string more than its length.</span>
                    <span class="n">record</span> <span class="o">=</span> <span class="n">record</span> <span class="o">+</span> \
                        <span class="n">rest_of_the_record</span><span class="p">[</span><span class="n">_i</span> <span class="o">*</span> <span class="n">length</span><span class="p">:</span> <span class="p">(</span><span class="n">_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">length</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">record</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">return_records</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
        <span class="c1"># Flush last record</span>
        <span class="n">return_records</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">return_records</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span> <span class="o">*</span> \
            <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_records</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="c1"># Add control header and continuation code.</span>
        <span class="n">b_record_type</span> <span class="o">=</span> <span class="n">record_type</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
        <span class="n">return_records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">b_record_type</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">return_records</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">return_records</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">return_records</span><span class="p">[</span><span class="n">_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">b_record_type</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;*&#39;</span> <span class="o">+</span> \
                <span class="n">return_records</span><span class="p">[</span><span class="n">_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">return_records</span></div>

<div class="viewcode-block" id="Parser._check_blockettes"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._check_blockettes.html#obspy.io.xseed.parser.Parser._check_blockettes">[docs]</a>    <span class="k">def</span> <span class="nf">_check_blockettes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Checks if all blockettes necessary for creating a SEED String are</span>
<span class="sd">        available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="mi">10</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">_i</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">]:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="n">abb_blockettes</span> <span class="o">=</span> <span class="p">[</span><span class="n">_i</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span><span class="p">]</span>
        <span class="k">if</span> <span class="mi">30</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">abb_blockettes</span> <span class="ow">and</span> <span class="mi">33</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">abb_blockettes</span> <span class="ow">and</span> \
           <span class="mi">34</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">abb_blockettes</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># Check every station:</span>
        <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">:</span>
            <span class="n">stat_blockettes</span> <span class="o">=</span> <span class="p">[</span><span class="n">_j</span><span class="o">.</span><span class="n">id</span> <span class="k">for</span> <span class="n">_j</span> <span class="ow">in</span> <span class="n">_i</span><span class="p">]</span>
            <span class="k">if</span> <span class="mi">50</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stat_blockettes</span> <span class="ow">and</span> <span class="mi">52</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stat_blockettes</span> <span class="ow">and</span> \
               <span class="mi">58</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stat_blockettes</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Parser._compare_blockettes"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._compare_blockettes.html#obspy.io.xseed.parser.Parser._compare_blockettes">[docs]</a>    <span class="k">def</span> <span class="nf">_compare_blockettes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blkt1</span><span class="p">,</span> <span class="n">blkt2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Compares two blockettes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">blkt1</span><span class="o">.</span><span class="vm">__dict__</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="c1"># Continue if just some meta data.</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">IGNORE_ATTR</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">blkt1</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">!=</span> <span class="n">blkt2</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="n">key</span><span class="p">]:</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="Parser._update_internal_seed_structure"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._update_internal_seed_structure.html#obspy.io.xseed.parser.Parser._update_internal_seed_structure">[docs]</a>    <span class="k">def</span> <span class="nf">_update_internal_seed_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Takes everything in the self.temp dictionary and writes it into the</span>
<span class="sd">        volume, abbreviations and stations attributes of the class.</span>

<span class="sd">        The self.temp dictionary can only contain one seed volume with a</span>
<span class="sd">        correct structure.</span>

<span class="sd">        This method will try to merge everything, discard double entries and</span>
<span class="sd">        adjust abbreviations.</span>

<span class="sd">        It will also discard unnecessary blockettes that will be created</span>
<span class="sd">        again when writing SEED or XSEED.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If called without a filled temporary dictionary do nothing.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># Check if everything is empty.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span> <span class="ow">and</span> \
                <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Delete Blockette 11 and 12.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span>
                           <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;abbreviations&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">])</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Merging is an experimental feature and still contains &#39;</span> <span class="o">+</span> \
                  <span class="s1">&#39;a lot of errors!&#39;</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="c1"># XXX: Sanity check for multiple Blockettes. Remove duplicates.</span>
            <span class="c1"># self._removeDuplicateAbbreviations()</span>
            <span class="c1"># Check the abbreviations.</span>
            <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;abbreviations&#39;</span><span class="p">]:</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="n">blkt</span><span class="o">.</span><span class="n">blockette_type</span>
                <span class="c1"># Loop over all existing abbreviations and find those with the</span>
                <span class="c1"># same id and content.</span>
                <span class="n">cur_index</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="c1"># Helper variable.</span>
                <span class="k">for</span> <span class="n">ex_blkt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">id</span> <span class="o">!=</span> <span class="n">ex_blkt</span><span class="o">.</span><span class="n">blockette_type</span><span class="p">:</span>
                        <span class="k">continue</span>
                    <span class="c1"># Raise the current index if it is the same blockette.</span>
                    <span class="n">cur_index</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_compare_blockettes</span><span class="p">(</span><span class="n">blkt</span><span class="p">,</span> <span class="n">ex_blkt</span><span class="p">):</span>
                        <span class="k">continue</span>
                    <span class="c1"># Update the current blockette and all abbreviations.</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_update_temporary_stations</span><span class="p">(</span>
                        <span class="nb">id</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">ex_blkt</span><span class="p">,</span> <span class="n">INDEX_FIELDS</span><span class="p">[</span><span class="nb">id</span><span class="p">]))</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_update_temporary_stations</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">cur_index</span><span class="p">)</span>
                    <span class="c1"># Append abbreviation.</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">blkt</span><span class="p">,</span> <span class="n">INDEX_FIELDS</span><span class="p">[</span><span class="nb">id</span><span class="p">],</span> <span class="n">cur_index</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkt</span><span class="p">)</span>
            <span class="c1"># Update the stations.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">])</span>
            <span class="c1"># XXX Update volume control header!</span>

        <span class="c1"># Also make the version of the format 2.4.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">version_of_format</span> <span class="o">=</span> <span class="mf">2.4</span></div>

<div class="viewcode-block" id="Parser._update_temporary_stations"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._update_temporary_stations.html#obspy.io.xseed.parser.Parser._update_temporary_stations">[docs]</a>    <span class="k">def</span> <span class="nf">_update_temporary_stations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blkt_id</span><span class="p">,</span> <span class="n">index_nr</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Loops over all stations, finds the corresponding blockettes and changes</span>
<span class="sd">        all abbreviation lookup codes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Blockette dictionary which maps abbreviation IDs and and fields.</span>
        <span class="n">index</span> <span class="o">=</span> <span class="p">{</span>
            <span class="c1"># Abbreviation Blockette : {Station Blockette: (Fields)}</span>
            <span class="mi">30</span><span class="p">:</span> <span class="p">{</span><span class="mi">52</span><span class="p">:</span> <span class="p">(</span><span class="mi">16</span><span class="p">,)},</span>
            <span class="mi">31</span><span class="p">:</span> <span class="p">{</span><span class="mi">51</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,),</span> <span class="mi">59</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,)},</span>
            <span class="mi">33</span><span class="p">:</span> <span class="p">{</span><span class="mi">50</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,),</span> <span class="mi">52</span><span class="p">:</span> <span class="p">(</span><span class="mi">6</span><span class="p">,)},</span>
            <span class="mi">34</span><span class="p">:</span> <span class="p">{</span><span class="mi">52</span><span class="p">:</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">),</span> <span class="mi">53</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">54</span><span class="p">:</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="mi">55</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">)}</span>
        <span class="p">}</span>
        <span class="n">blockettes</span> <span class="o">=</span> <span class="n">index</span><span class="p">[</span><span class="n">blkt_id</span><span class="p">]</span>
        <span class="c1"># Loop over all stations.</span>
        <span class="n">stations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">blkt</span> <span class="ow">in</span> <span class="n">station</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">fields</span> <span class="o">=</span> <span class="n">blockettes</span><span class="p">[</span><span class="n">blkt</span><span class="o">.</span><span class="n">blockette_type</span><span class="p">]</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">fields</span><span class="p">:</span>
                    <span class="nb">setattr</span><span class="p">(</span><span class="n">blkt</span><span class="p">,</span> <span class="n">blkt</span><span class="o">.</span><span class="n">get_fields</span><span class="p">()[</span><span class="n">field</span> <span class="o">-</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">field_name</span><span class="p">,</span>
                            <span class="n">index_nr</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parser._parse_merged_data"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._parse_merged_data.html#obspy.io.xseed.parser.Parser._parse_merged_data">[docs]</a>    <span class="k">def</span> <span class="nf">_parse_merged_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">record_type</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method takes any merged SEED record and writes its blockettes</span>
<span class="sd">        in the corresponding dictionary entry of self.temp.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># Create BytesIO for easier access.</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># Do not do anything if no data is passed or if a time series header</span>
        <span class="c1"># is passed.</span>
        <span class="k">if</span> <span class="n">record_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">HEADERS</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># Set standard values.</span>
        <span class="n">blockette_length</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">blockette_id</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="c1"># Find out what kind of record is being parsed.</span>
        <span class="k">if</span> <span class="n">record_type</span> <span class="o">==</span> <span class="s1">&#39;S&#39;</span><span class="p">:</span>
            <span class="c1"># Create new station blockettes list.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">root_attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;stations&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">record_type</span> <span class="o">==</span> <span class="s1">&#39;V&#39;</span><span class="p">:</span>
            <span class="c1"># Just one Volume header per file allowed.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;More than one Volume index control header found!&#39;</span>
                <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">root_attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;volume&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Just one abbreviations header allowed!</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;abbreviations&#39;</span><span class="p">]):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;More than one Abbreviation Dictionary Control &#39;</span> <span class="o">+</span> \
                      <span class="s1">&#39;Headers found!&#39;</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="n">root_attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">temp</span><span class="p">[</span><span class="s1">&#39;abbreviations&#39;</span><span class="p">]</span>
        <span class="c1"># Loop over all blockettes in data.</span>
        <span class="k">while</span> <span class="n">blockette_id</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># remove spaces between blockettes</span>
            <span class="k">while</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">&#39; &#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">blockette_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
                <span class="n">blockette_length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span> <span class="o">-</span> <span class="mi">7</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">blockette_id</span> <span class="ow">in</span> <span class="n">HEADER_INFO</span><span class="p">[</span><span class="n">record_type</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;blockettes&#39;</span><span class="p">,</span> <span class="p">[]):</span>
                <span class="n">class_name</span> <span class="o">=</span> <span class="s1">&#39;Blockette</span><span class="si">%03d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">blockette_id</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">blockette</span><span class="p">,</span> <span class="n">class_name</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="s1">&#39;Blockette </span><span class="si">%d</span><span class="s1"> not implemented!&#39;</span> <span class="o">%</span>
                                              <span class="n">blockette_id</span><span class="p">)</span>
                <span class="n">blockette_class</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">blockette</span><span class="p">,</span> <span class="n">class_name</span><span class="p">)</span>
                <span class="n">blockette_obj</span> <span class="o">=</span> <span class="n">blockette_class</span><span class="p">(</span><span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span>
                                                <span class="n">strict</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">strict</span><span class="p">,</span>
                                                <span class="n">compact</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">compact</span><span class="p">,</span>
                                                <span class="n">version</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">version</span><span class="p">,</span>
                                                <span class="n">record_type</span><span class="o">=</span><span class="n">record_type</span><span class="p">)</span>
                <span class="n">blockette_obj</span><span class="o">.</span><span class="n">parse_seed</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">blockette_length</span><span class="p">)</span>
                <span class="n">root_attribute</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blockette_obj</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">blockettes</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">blockette_id</span><span class="p">,</span>
                                           <span class="p">[])</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blockette_obj</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">blockette_id</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Unknown blockette type </span><span class="si">%d</span><span class="s2"> found&quot;</span> <span class="o">%</span> <span class="n">blockette_id</span>
                <span class="k">raise</span> <span class="n">SEEDParserException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># check if everything is parsed</span>
        <span class="n">_pos</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">SEEK_END</span><span class="p">)</span>
        <span class="n">_len</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">tell</span><span class="p">()</span>
        <span class="n">data</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">_pos</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">_pos</span> <span class="o">!=</span> <span class="n">_len</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;There exist unparsed elements!&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Parser._create_blockettes_11_and_12"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._create_blockettes_11_and_12.html#obspy.io.xseed.parser.Parser._create_blockettes_11_and_12">[docs]</a>    <span class="k">def</span> <span class="nf">_create_blockettes_11_and_12</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">blockette12</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Creates blockettes 11 and 12 for SEED writing and XSEED version 1.1</span>
<span class="sd">        writing.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># All the following unfortunately is necessary to get a correct</span>
        <span class="c1"># Blockette 11:</span>
        <span class="c1"># Start with the station strings to be able to write Blockette 11</span>
        <span class="c1"># later on. The created list will contain lists with the first item</span>
        <span class="c1"># being the corresponding station identifier code and each part of the</span>
        <span class="c1"># record being a separate item.</span>
        <span class="n">stations</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Loop over all stations.</span>
        <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">:</span>
            <span class="n">station</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="c1"># Blockette 50 always should be the first blockette</span>
            <span class="n">station</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station_call_letters</span><span class="p">)</span>
            <span class="c1"># Loop over blockettes.</span>
            <span class="n">station</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_cut_and_flush_record</span><span class="p">(</span><span class="n">_i</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">))</span>
            <span class="n">stations</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">station</span><span class="p">)</span>
        <span class="c1"># Make abbreviations.</span>
        <span class="n">abbreviations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_cut_and_flush_record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">abbreviations</span><span class="p">,</span>
                                                          <span class="s1">&#39;A&#39;</span><span class="p">)</span>
        <span class="n">abbr_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">abbreviations</span><span class="p">)</span>
        <span class="n">cur_count</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">abbr_length</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">blkt11</span> <span class="o">=</span> <span class="n">blockette</span><span class="o">.</span><span class="n">Blockette011</span><span class="p">()</span>
            <span class="n">blkt11</span><span class="o">.</span><span class="n">number_of_stations</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">)</span>
            <span class="n">stations_lengths</span> <span class="o">=</span> <span class="p">[</span><span class="n">cur_count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">_i</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="n">stations</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
                <span class="n">stations_lengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stations_lengths</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">_i</span><span class="p">)</span>
            <span class="n">blkt11</span><span class="o">.</span><span class="n">sequence_number_of_station_header</span> <span class="o">=</span> <span class="n">stations_lengths</span>
            <span class="n">blkt11</span><span class="o">.</span><span class="n">station_identifier_code</span> <span class="o">=</span> \
                <span class="p">[</span><span class="n">_i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">station_call_letters</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stations</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkt11</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">blockette12</span><span class="p">:</span>
                <span class="c1"># Blockette 12 is also needed.</span>
                <span class="n">blkt12</span> <span class="o">=</span> <span class="n">blockette</span><span class="o">.</span><span class="n">Blockette012</span><span class="p">()</span>
                <span class="n">blkt12</span><span class="o">.</span><span class="n">number_of_spans_in_table</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">blkt12</span><span class="p">)</span>
            <span class="n">volume</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_cut_and_flush_record</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">volume</span><span class="p">,</span> <span class="s1">&#39;V&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">cur_count</span> <span class="o">-</span> <span class="n">abbr_length</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">volume</span><span class="p">):</span>
                <span class="n">cur_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">volume</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_delete_blockettes_11_and_12</span><span class="p">()</span>
                <span class="k">continue</span>
            <span class="k">break</span>
        <span class="k">return</span> <span class="n">volume</span><span class="p">,</span> <span class="n">abbreviations</span><span class="p">,</span> <span class="n">stations</span></div>

<div class="viewcode-block" id="Parser._delete_blockettes_11_and_12"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser._delete_blockettes_11_and_12.html#obspy.io.xseed.parser.Parser._delete_blockettes_11_and_12">[docs]</a>    <span class="k">def</span> <span class="nf">_delete_blockettes_11_and_12</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Deletes blockette 11 and 12.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">volume</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">]]</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;rotateToZNE&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;rotate_to_zne&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">rotateToZNE</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;rotateToZNE&#39; has been renamed to</span>
<span class="sd">        &#39;rotate_to_zne&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rotate_to_zne</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Parser.rotate_to_zne"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.Parser.rotate_to_zne.html#obspy.io.xseed.parser.Parser.rotate_to_zne">[docs]</a>    <span class="k">def</span> <span class="nf">rotate_to_zne</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rotates the three components of a Stream to ZNE.</span>

<span class="sd">        Currently limited to rotating exactly three components covering exactly</span>
<span class="sd">        the same time span. The components can have arbitrary orientation and</span>
<span class="sd">        need not be orthogonal to each other. The output will be a new Stream</span>
<span class="sd">        object containing vertical, north, and east channels.</span>

<span class="sd">        :param stream: The stream object to rotate. Needs to have exactly three</span>
<span class="sd">            components, all the same length and timespan. Furthermore all</span>
<span class="sd">            components need to be described in the Parser object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">from</span> <span class="nn">obspy.signal.rotate</span> <span class="k">import</span> <span class="n">rotate2zne</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Stream needs to have three components.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Network, station and location need to be identical for all three.</span>
        <span class="n">is_unique</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">([(</span><span class="n">i</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
                              <span class="n">i</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
                              <span class="n">i</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span><span class="p">,</span>
                              <span class="n">i</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">network</span><span class="p">,</span>
                              <span class="n">i</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="p">,</span>
                              <span class="n">i</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">location</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">]))</span> <span class="o">==</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_unique</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;All the Traces need to cover the same time span and have &quot;</span>
                   <span class="s2">&quot;the same network, station, and location.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="n">all_arguments</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
            <span class="n">dip</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">azimuth</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">blockettes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_select</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">blockette_</span> <span class="ow">in</span> <span class="n">blockettes</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">blockette_</span><span class="o">.</span><span class="n">id</span> <span class="o">!=</span> <span class="mi">52</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">dip</span> <span class="o">=</span> <span class="n">blockette_</span><span class="o">.</span><span class="n">dip</span>
                <span class="n">azimuth</span> <span class="o">=</span> <span class="n">blockette_</span><span class="o">.</span><span class="n">azimuth</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="n">dip</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">azimuth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Dip and azimuth need to be available for every trace.&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="n">all_arguments</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span>
                                  <span class="n">azimuth</span><span class="p">,</span> <span class="n">dip</span><span class="p">])</span>
        <span class="c1"># Now rotate all three traces.</span>
        <span class="n">z</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">rotate2zne</span><span class="p">(</span><span class="o">*</span><span class="n">all_arguments</span><span class="p">)</span>

        <span class="c1"># Assemble a new Stream object.</span>
        <span class="n">common_header</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;network&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">network</span><span class="p">,</span>
            <span class="s2">&quot;station&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span><span class="p">,</span>
            <span class="s2">&quot;location&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">location</span><span class="p">,</span>
            <span class="s2">&quot;channel&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span>
            <span class="s2">&quot;starttime&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="p">,</span>
            <span class="s2">&quot;sampling_rate&quot;</span><span class="p">:</span> <span class="n">stream</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">}</span>

        <span class="n">tr_z</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">z</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">common_header</span><span class="p">)</span>
        <span class="n">tr_n</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">common_header</span><span class="p">)</span>
        <span class="n">tr_e</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">e</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">common_header</span><span class="p">)</span>

        <span class="c1"># Fix the channel_codes</span>
        <span class="n">tr_z</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">+=</span> <span class="s2">&quot;Z&quot;</span>
        <span class="n">tr_n</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">+=</span> <span class="s2">&quot;N&quot;</span>
        <span class="n">tr_e</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">+=</span> <span class="s2">&quot;E&quot;</span>

        <span class="k">return</span> <span class="n">Stream</span><span class="p">(</span><span class="n">traces</span><span class="o">=</span><span class="p">[</span><span class="n">tr_z</span><span class="p">,</span> <span class="n">tr_n</span><span class="p">,</span> <span class="n">tr_e</span><span class="p">])</span></div></div>


<div class="viewcode-block" id="is_xseed"><a class="viewcode-back" href="../../../../packages/autogen/obspy.io.xseed.parser.is_xseed.html#obspy.io.xseed.parser.is_xseed">[docs]</a><span class="k">def</span> <span class="nf">is_xseed</span><span class="p">(</span><span class="n">path_or_file_object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple function checking if the passed object contains a XML-SEED file.</span>
<span class="sd">    Returns True of False. Only checks the name of the root tag, which should</span>
<span class="sd">    be &quot;xseed&quot;.</span>

<span class="sd">    &gt;&gt;&gt; from obspy.core.util import get_example_file</span>
<span class="sd">    &gt;&gt;&gt; xseed_file = get_example_file(&quot;dataless.seed.BW_FURT.xml&quot;)</span>
<span class="sd">    &gt;&gt;&gt; is_xseed(xseed_file)</span>
<span class="sd">    True</span>
<span class="sd">    &gt;&gt;&gt; stationxml_file = get_example_file(&quot;IU_ANMO_00_BHZ.xml&quot;)</span>
<span class="sd">    &gt;&gt;&gt; is_xseed(stationxml_file)</span>
<span class="sd">    False</span>

<span class="sd">    :param path_or_file_object: File name or file like object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path_or_file_object</span><span class="p">,</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">):</span>
        <span class="n">xmldoc</span> <span class="o">=</span> <span class="n">path_or_file_object</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">xmldoc</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">path_or_file_object</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">etree</span><span class="o">.</span><span class="n">XMLSyntaxError</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">root</span> <span class="o">=</span> <span class="n">xmldoc</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="c1"># check tag of root element</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">root</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;xseed&quot;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="kc">True</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">exclude_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a> &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, lafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Kufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaim, Sbastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clment</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Khler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>