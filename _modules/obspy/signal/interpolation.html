<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.signal.interpolation &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.signal.interpolation</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Some Seismogram Interpolating Functions.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org)</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span>

<span class="kn">from</span> <span class="nn">obspy.signal.headers</span> <span class="k">import</span> <span class="n">clibsignal</span>


<div class="viewcode-block" id="_validate_parameters"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.interpolation._validate_parameters.html#obspy.signal.interpolation._validate_parameters">[docs]</a><span class="k">def</span> <span class="nf">_validate_parameters</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">old_start</span><span class="p">,</span> <span class="n">old_dt</span><span class="p">,</span> <span class="n">new_start</span><span class="p">,</span> <span class="n">new_dt</span><span class="p">,</span> <span class="n">new_npts</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates the parameters for various interpolation functions.</span>

<span class="sd">    Returns the old and the new end.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">new_dt</span> <span class="o">&lt;=</span> <span class="mf">0.0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The time step must be positive.&quot;</span><span class="p">)</span>

    <span class="c1"># Check for 1D array.</span>
    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Not a 1D array.&quot;</span><span class="p">)</span>

    <span class="n">old_end</span> <span class="o">=</span> <span class="n">old_start</span> <span class="o">+</span> <span class="n">old_dt</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">new_end</span> <span class="o">=</span> <span class="n">new_start</span> <span class="o">+</span> <span class="n">new_dt</span> <span class="o">*</span> <span class="p">(</span><span class="n">new_npts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">old_start</span> <span class="o">&gt;</span> <span class="n">new_start</span> <span class="ow">or</span> <span class="n">old_end</span> <span class="o">&lt;</span> <span class="n">new_end</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The new array must be fully contained in the old &quot;</span>
                         <span class="s2">&quot;array. No extrapolation can be performed.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">old_end</span><span class="p">,</span> <span class="n">new_end</span></div>


<div class="viewcode-block" id="interpolate_1d"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.interpolation.interpolate_1d.html#obspy.signal.interpolation.interpolate_1d">[docs]</a><span class="k">def</span> <span class="nf">interpolate_1d</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">old_start</span><span class="p">,</span> <span class="n">old_dt</span><span class="p">,</span> <span class="n">new_start</span><span class="p">,</span> <span class="n">new_dt</span><span class="p">,</span> <span class="n">new_npts</span><span class="p">,</span>
                   <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;linear&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Wrapper around some scipy interpolation functions.</span>

<span class="sd">    :type data: array_like</span>
<span class="sd">    :param data: Array to interpolate.</span>
<span class="sd">    :type old_start: float</span>
<span class="sd">    :param old_start: The start of the array as a number.</span>
<span class="sd">    :type old_start: float</span>
<span class="sd">    :param old_dt: The time delta of the current array.</span>
<span class="sd">    :type new_start: float</span>
<span class="sd">    :param new_start: The start of the interpolated array. Must be greater</span>
<span class="sd">        or equal to the current start of the array.</span>
<span class="sd">    :type new_dt: float</span>
<span class="sd">    :param new_dt: The desired new time delta.</span>
<span class="sd">    :type new_npts: int</span>
<span class="sd">    :param new_npts: The new number of samples.</span>
<span class="sd">    :type type: str or int</span>
<span class="sd">    :param type: Specifies the kind of interpolation as a string (``linear``,</span>
<span class="sd">        ``nearest``, ``zero``, ``slinear``, ``quadratic``, ``cubic`` where</span>
<span class="sd">        ``slinear``, ``quadratic`` and ``cubic`` refer to a spline</span>
<span class="sd">        interpolation of first,  second or third order) or as an integer</span>
<span class="sd">        specifying the order of the spline interpolator to use. Default is</span>
<span class="sd">        ``linear``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">old_end</span><span class="p">,</span> <span class="n">new_end</span> <span class="o">=</span> <span class="n">_validate_parameters</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">old_start</span><span class="p">,</span> <span class="n">old_dt</span><span class="p">,</span>
                                            <span class="n">new_start</span><span class="p">,</span> <span class="n">new_dt</span><span class="p">,</span> <span class="n">new_npts</span><span class="p">)</span>

    <span class="c1"># In almost all cases the unit will be in time.</span>
    <span class="n">new_time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">new_start</span><span class="p">,</span> <span class="n">new_end</span><span class="p">,</span> <span class="n">new_npts</span><span class="p">)</span>
    <span class="n">old_time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">old_start</span><span class="p">,</span> <span class="n">old_end</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>

    <span class="n">s_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;slinear&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;quadratic&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
        <span class="s2">&quot;cubic&quot;</span><span class="p">:</span> <span class="mi">3</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="nb">type</span> <span class="ow">in</span> <span class="n">s_map</span><span class="p">:</span>
        <span class="nb">type</span> <span class="o">=</span> <span class="n">s_map</span><span class="p">[</span><span class="nb">type</span><span class="p">]</span>

    <span class="c1"># InterpolatedUnivariateSpline uses a sane amount of memory for splines.</span>
    <span class="c1"># interp1d can easily require 50 GB of memory which is clearly</span>
    <span class="c1"># not acceptable.</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">type</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">InterpolatedUnivariateSpline</span><span class="p">(</span>
            <span class="n">old_time_array</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="nb">type</span><span class="p">)(</span><span class="n">new_time_array</span><span class="p">)</span>
    <span class="c1"># interp1d is used for the &quot;linear&quot;, &quot;nearest&quot;, and &quot;zero&quot; interpolation</span>
    <span class="c1"># methods.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_data</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">interpolate</span><span class="o">.</span><span class="n">interp1d</span><span class="p">(</span><span class="n">old_time_array</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="nb">type</span><span class="p">)(</span>
            <span class="n">new_time_array</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_data</span></div>


<div class="viewcode-block" id="weighted_average_slopes"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.interpolation.weighted_average_slopes.html#obspy.signal.interpolation.weighted_average_slopes">[docs]</a><span class="k">def</span> <span class="nf">weighted_average_slopes</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">old_start</span><span class="p">,</span> <span class="n">old_dt</span><span class="p">,</span> <span class="n">new_start</span><span class="p">,</span> <span class="n">new_dt</span><span class="p">,</span>
                            <span class="n">new_npts</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Implements the weighted average slopes interpolation scheme proposed in</span>
<span class="sd">    [Wiggins1976]_ for evenly sampled data. The scheme guarantees that there</span>
<span class="sd">    will be no additional extrema after the interpolation in contrast to</span>
<span class="sd">    spline interpolation.</span>

<span class="sd">    The slope :math:`s_i` at each knot is given by a weighted average of the</span>
<span class="sd">    adjacent linear slopes :math:`m_i` and :math:`m_{i+j}`:</span>

<span class="sd">    .. math::</span>

<span class="sd">        s_i = (w_i m_i + w_{i+1} m_{i+1}) / (w_i + w_{i+1})</span>

<span class="sd">    where</span>

<span class="sd">    .. math::</span>

<span class="sd">        w = 1 / max \left\{ \left\| m_i \\right\|, \epsilon \\right\}</span>

<span class="sd">    The value at each data point and the slope are then plugged into a</span>
<span class="sd">    piecewise continuous cubic polynomial used to evaluate the interpolated</span>
<span class="sd">    sample points.</span>

<span class="sd">    :type data: array_like</span>
<span class="sd">    :param data: Array to interpolate.</span>
<span class="sd">    :type old_start: float</span>
<span class="sd">    :param old_start: The start of the array as a number.</span>
<span class="sd">    :type old_start: float</span>
<span class="sd">    :param old_dt: The time delta of the current array.</span>
<span class="sd">    :type new_start: float</span>
<span class="sd">    :param new_start: The start of the interpolated array. Must be greater</span>
<span class="sd">        or equal to the current start of the array.</span>
<span class="sd">    :type new_dt: float</span>
<span class="sd">    :param new_dt: The desired new time delta.</span>
<span class="sd">    :type new_npts: int</span>
<span class="sd">    :param new_npts: The new number of samples.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">old_end</span><span class="p">,</span> <span class="n">new_end</span> <span class="o">=</span> <span class="n">_validate_parameters</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">old_start</span><span class="p">,</span> <span class="n">old_dt</span><span class="p">,</span>
                                            <span class="n">new_start</span><span class="p">,</span> <span class="n">new_dt</span><span class="p">,</span> <span class="n">new_npts</span><span class="p">)</span>
    <span class="c1"># In almost all cases the unit will be in time.</span>
    <span class="n">new_time_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">new_start</span><span class="p">,</span> <span class="n">new_end</span><span class="p">,</span> <span class="n">new_npts</span><span class="p">)</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">/</span> <span class="n">old_dt</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
    <span class="n">w</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">spacing</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="n">w</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

    <span class="n">slope</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">slope</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">m</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
    <span class="n">slope</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># If m_i and m_{i+1} have opposite signs then set the slope to zero.</span>
    <span class="c1"># This forces the curve to have extrema at the sample points and not</span>
    <span class="c1"># in-between.</span>
    <span class="n">sign_change</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sign</span><span class="p">(</span><span class="n">m</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">bool</span><span class="p">)</span>
    <span class="n">slope</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="n">sign_change</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="n">derivatives</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">derivatives</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
    <span class="n">derivatives</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">slope</span>

    <span class="c1"># Create interpolated value using hermite interpolation. In this case</span>
    <span class="c1"># it is directly applicable as the first derivatives are known.</span>
    <span class="c1"># Using scipy.interpolate.piecewise_polynomial_interpolate() is too</span>
    <span class="c1"># memory intensive</span>
    <span class="n">return_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">new_time_array</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">clibsignal</span><span class="o">.</span><span class="n">hermite_interpolation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">new_time_array</span><span class="p">,</span> <span class="n">return_data</span><span class="p">,</span>
                                     <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_data</span><span class="p">),</span> <span class="n">old_dt</span><span class="p">,</span>
                                     <span class="n">old_start</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">return_data</span></div>


<span class="c1"># Map corresponding to the enum on the C side of things.</span>
<span class="n">_LANCZOS_KERNEL_MAP</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;lanczos&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s2">&quot;hanning&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
    <span class="s2">&quot;blackman&quot;</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">}</span>


<div class="viewcode-block" id="lanczos_interpolation"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.interpolation.lanczos_interpolation.html#obspy.signal.interpolation.lanczos_interpolation">[docs]</a><span class="k">def</span> <span class="nf">lanczos_interpolation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">old_start</span><span class="p">,</span> <span class="n">old_dt</span><span class="p">,</span> <span class="n">new_start</span><span class="p">,</span> <span class="n">new_dt</span><span class="p">,</span> <span class="n">new_npts</span><span class="p">,</span>
                          <span class="n">a</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="s2">&quot;lanczos&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function performing Lanczos resampling, see</span>
<span class="sd">    https://en.wikipedia.org/wiki/Lanczos_resampling for details. Essentially a</span>
<span class="sd">    finite support version of sinc resampling (the ideal reconstruction</span>
<span class="sd">    filter). For large values of ``a`` it converges towards sinc resampling. If</span>
<span class="sd">    used for downsampling, make sure to apply an appropriate anti-aliasing</span>
<span class="sd">    lowpass filter first.</span>

<span class="sd">    .. note::</span>

<span class="sd">        In most cases you do not want to call this method directly but invoke</span>
<span class="sd">        it via either the :meth:`obspy.core.stream.Stream.interpolate` or</span>
<span class="sd">        :meth:`obspy.core.trace.Trace.interpolate` method. These offer a nicer</span>
<span class="sd">        API that naturally integrates with the rest of ObsPy. Use</span>
<span class="sd">        ``method=&quot;lanczos&quot;`` to use this interpolation method. In that case the</span>
<span class="sd">        only additional parameters of interest are ``a`` and ``window``.</span>

<span class="sd">    :type data: array_like</span>
<span class="sd">    :param data: Array to interpolate.</span>
<span class="sd">    :type old_start: float</span>
<span class="sd">    :param old_start: The start of the array as a number.</span>
<span class="sd">    :type old_start: float</span>
<span class="sd">    :param old_dt: The time delta of the current array.</span>
<span class="sd">    :type new_start: float</span>
<span class="sd">    :param new_start: The start of the interpolated array. Must be greater</span>
<span class="sd">        or equal to the current start of the array.</span>
<span class="sd">    :type new_dt: float</span>
<span class="sd">    :param new_dt: The desired new time delta.</span>
<span class="sd">    :type new_npts: int</span>
<span class="sd">    :param new_npts: The new number of samples.</span>
<span class="sd">    :type a: int</span>
<span class="sd">    :param a: The width of the window in samples on either side. Runtime</span>
<span class="sd">        scales linearly with the value of ``a`` but the interpolation also gets</span>
<span class="sd">        better.</span>
<span class="sd">    :type window: str</span>
<span class="sd">    :param window: The window used to taper the sinc function. One of</span>
<span class="sd">        ``&quot;lanczos&quot;``, ``&quot;hanning&quot;``, ``&quot;blackman&quot;``. The window determines</span>
<span class="sd">        the trade-off between &quot;sharpness&quot; and the amplitude of the wiggles in</span>
<span class="sd">        the pass and stop band. Please use the</span>
<span class="sd">        :func:`~obspy.signal.interpolation.plot_lanczos_windows` function to</span>
<span class="sd">        judge these for any given application.</span>

<span class="sd">    Values of ``a`` &gt;= 20 show good results even for data that has</span>
<span class="sd">    energy close to the Nyquist frequency. If your data is extremely</span>
<span class="sd">    oversampled you can get away with much smaller ``a``&#39;s.</span>

<span class="sd">    To get an idea of the response of the filter and the effect of the</span>
<span class="sd">    different windows, please use the</span>
<span class="sd">    :func:`~obspy.signal.interpolation.plot_lanczos_windows` function.</span>

<span class="sd">    Also be aware of any boundary effects. All values outside the data</span>
<span class="sd">    range are assumed to be zero which matters when calculating interpolated</span>
<span class="sd">    values at the boundaries. At each side the area with potential boundary</span>
<span class="sd">    effects is ``a`` * ``old_dt``. If you want to avoid any boundary effects</span>
<span class="sd">    you will have to remove these values.</span>

<span class="sd">    **Mathematical Details:**</span>

<span class="sd">    The :math:`\operatorname{sinc}` function is defined as</span>

<span class="sd">    .. math::</span>

<span class="sd">        \operatorname{sinc}(t) = \frac{\sin(\pi t)}{\pi t}.</span>

<span class="sd">    The Lanczos kernel is then given by a multiplication of the</span>
<span class="sd">    :math:`\operatorname{sinc}` function with an additional window function</span>
<span class="sd">    resulting in a finite support kernel.</span>

<span class="sd">    .. math::</span>

<span class="sd">        \begin{align}</span>
<span class="sd">            L(t) =</span>
<span class="sd">            \begin{cases}</span>
<span class="sd">                \operatorname{sinc}(t)\, \cdot \operatorname{sinc}(t/a)</span>
<span class="sd">                    &amp; \text{if } t \in [-a, a]</span>
<span class="sd">                    \text{ and } \texttt{window} = \texttt{lanczos}\\</span>
<span class="sd">                \operatorname{sinc}(t)\, \cdot \frac{1}{2}</span>
<span class="sd">                (1 + \cos(\pi\, t/a))</span>
<span class="sd">                    &amp; \text{if } t \in [-a, a]</span>
<span class="sd">                    \text{ and } \texttt{window} = \texttt{lanczos}\\</span>
<span class="sd">                \operatorname{sinc}(t)\, \cdot \left( \frac{21}{50} +</span>
<span class="sd">                \frac{1}{2}</span>
<span class="sd">                \cos(\pi\, t/a) + \frac{2}{25} \cos (2\pi\, t/a) \right)</span>
<span class="sd">                    &amp; \text{if } t \in [-a, a]</span>
<span class="sd">                    \text{ and } \texttt{window} = \texttt{lanczos}\\</span>
<span class="sd">                0                     &amp; \text{else}</span>
<span class="sd">            \end{cases}</span>
<span class="sd">        \end{align}</span>


<span class="sd">    Finally interpolation is performed by convolving the discrete signal</span>
<span class="sd">    :math:`s_i` with that kernel and evaluating it at the new time samples</span>
<span class="sd">    :math:`t_j`:</span>

<span class="sd">    .. math::</span>

<span class="sd">        \begin{align}</span>
<span class="sd">            S(t_j) =</span>
<span class="sd">                \sum_{i = \left \lfloor{t_j / \Delta t}\right \rfloor -a + 1}</span>
<span class="sd">                    ^{\left \lfloor{t_j / \Delta t}\right \rfloor + a}</span>
<span class="sd">            s_i L(t_j/\Delta t - i),</span>
<span class="sd">        \end{align}</span>

<span class="sd">    where :math:`\lfloor \cdot \rfloor` denotes the floor function. For more</span>
<span class="sd">    details and justification please see [Burger2009]_ and [vanDriel2015]_.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_validate_parameters</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">old_start</span><span class="p">,</span> <span class="n">old_dt</span><span class="p">,</span> <span class="n">new_start</span><span class="p">,</span> <span class="n">new_dt</span><span class="p">,</span> <span class="n">new_npts</span><span class="p">)</span>

    <span class="c1"># dt and offset in terms of the original sampling interval.</span>
    <span class="n">dt_factor</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">new_dt</span><span class="p">)</span> <span class="o">/</span> <span class="n">old_dt</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_start</span> <span class="o">-</span> <span class="n">old_start</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">old_dt</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">offset</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot extrapolate. Make sure to only interpolate &quot;</span>
                         <span class="s2">&quot;within the time range of the original signal.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;a must be at least 1.&quot;</span><span class="p">)</span>

    <span class="n">return_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">new_npts</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="n">clibsignal</span><span class="o">.</span><span class="n">lanczos_resample</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">),</span> <span class="n">return_data</span><span class="p">,</span> <span class="n">dt_factor</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span>
        <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_data</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">return_data</span></div>


<div class="viewcode-block" id="calculate_lanczos_kernel"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.interpolation.calculate_lanczos_kernel.html#obspy.signal.interpolation.calculate_lanczos_kernel">[docs]</a><span class="k">def</span> <span class="nf">calculate_lanczos_kernel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">window</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function to get the actually used kernel for a specific value of</span>
<span class="sd">    a. Useful to analyse the behaviour of different tapers and different values</span>
<span class="sd">    of a.</span>

<span class="sd">    :type x: :class:`numpy.ndarray`</span>
<span class="sd">    :param x: The x values at which to calculate the kernel.</span>
<span class="sd">    :type a: int</span>
<span class="sd">    :param a: The width of the window in samples on either side.</span>
<span class="sd">    :type window: str</span>
<span class="sd">    :param window: The window used to multiply the sinc function with. One</span>
<span class="sd">        of ``&quot;lanczos&quot;``, ``&quot;hanning&quot;``, ``&quot;blackman&quot;``.</span>

<span class="sd">    Returns a dictionary of arrays:</span>

<span class="sd">    * ``&quot;full_kernel&quot;``: The tapered sinc function evaluated at samples ``x``.</span>
<span class="sd">    * ``&quot;only_sinc&quot;``: The sinc function evaluated at samples ``x``.</span>
<span class="sd">    * ``&quot;only_taper&quot;``: The taper function evaluated at samples ``x``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">window</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">window</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">_LANCZOS_KERNEL_MAP</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid window. Valid windows: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="nb">sorted</span><span class="p">(</span><span class="n">_LANCZOS_KERNEL_MAP</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">y0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="n">clibsignal</span><span class="o">.</span><span class="n">calculate_kernel</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">_LANCZOS_KERNEL_MAP</span><span class="p">[</span><span class="n">window</span><span class="p">])</span>
    <span class="n">clibsignal</span><span class="o">.</span><span class="n">calculate_kernel</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">_LANCZOS_KERNEL_MAP</span><span class="p">[</span><span class="n">window</span><span class="p">])</span>
    <span class="n">clibsignal</span><span class="o">.</span><span class="n">calculate_kernel</span><span class="p">(</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">_LANCZOS_KERNEL_MAP</span><span class="p">[</span><span class="n">window</span><span class="p">])</span>

    <span class="n">ret_val</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;full_kernel&quot;</span><span class="p">:</span> <span class="n">y0</span><span class="p">,</span>
        <span class="s2">&quot;only_sinc&quot;</span><span class="p">:</span> <span class="n">y1</span><span class="p">,</span>
        <span class="s2">&quot;only_taper&quot;</span><span class="p">:</span> <span class="n">y2</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">ret_val</span></div>


<div class="viewcode-block" id="plot_lanczos_windows"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.interpolation.plot_lanczos_windows.html#obspy.signal.interpolation.plot_lanczos_windows">[docs]</a><span class="k">def</span> <span class="nf">plot_lanczos_windows</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function producing a plot of all available tapers of the sinc</span>
<span class="sd">    function and their response for the Lanczos interpolation.</span>

<span class="sd">    :type a: int</span>
<span class="sd">    :param a: The width of the window in samples on either side.</span>
<span class="sd">    :type filename: str</span>
<span class="sd">    :param filename: The file name to save to. The plot will be shown if it is</span>
<span class="sd">        not given.</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        from obspy.signal.interpolation import plot_lanczos_windows</span>
<span class="sd">        plot_lanczos_windows(a=20)</span>

<span class="sd">    .. plot::</span>

<span class="sd">        import matplotlib.pyplot as plt</span>
<span class="sd">        plt.figure(figsize=(10, 15))</span>
<span class="sd">        from obspy.signal.interpolation import plot_lanczos_windows</span>
<span class="sd">        plot_lanczos_windows(a=20)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">x_max</span> <span class="o">=</span> <span class="mf">1024.0</span> <span class="o">-</span> <span class="mf">0.5</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="mi">15</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">x_max</span><span class="p">,</span> <span class="n">x_max</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">dx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">x_max</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">arrays</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">_LANCZOS_KERNEL_MAP</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_lanczos_kernel</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">key</span><span class="p">)</span>
        <span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;fft&quot;</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;full_kernel&quot;</span><span class="p">])</span> <span class="o">*</span> <span class="n">dx</span><span class="p">)</span>

    <span class="n">height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">_LANCZOS_KERNEL_MAP</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">arrays</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;full_kernel&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;All Windows&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span>
             <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Ideal&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">arrays</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dx</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span>
                 <span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;fft&quot;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Frequency Response of All Windows&quot;</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">_LANCZOS_KERNEL_MAP</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">_i</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;full_kernel&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Final&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;only_sinc&quot;</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Sinc&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;only_taper&quot;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Taper&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">_i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">key</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot; Response&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">],</span> <span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.1&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">dx</span><span class="p">)[:</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]),</span>
                 <span class="n">arrays</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;fft&quot;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Different windows for sinc interpolation with a=</span><span class="si">%i</span><span class="s2">&quot;</span>
                 <span class="o">%</span> <span class="n">a</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;large&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">filename</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">exclude_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a>™ &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, Ólafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Käufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhäusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaimé, Sébastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clément</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Köhler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n° 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>