<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.signal.calibration &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.signal.calibration</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Filename: calibration.py</span>
<span class="c1">#  Purpose: Functions for relative calibration (e.g. Huddle test calibration)</span>
<span class="c1">#   Author: Felix Bernauer, Simon Kremers</span>
<span class="c1">#    Email: bernauer@geophysik.uni-muenchen.de</span>
<span class="c1">#</span>
<span class="c1"># Copyright (C) 2011 Felix Bernauer, Simon Kremers</span>
<span class="c1"># --------------------------------------------------------------------</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Functions for relative calibration.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org)</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="k">import</span> <span class="n">native_str</span>

<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">obspy.core.stream</span> <span class="k">import</span> <span class="n">Stream</span>
<span class="kn">from</span> <span class="nn">obspy.core.trace</span> <span class="k">import</span> <span class="n">Trace</span>
<span class="kn">from</span> <span class="nn">obspy.core.util.deprecation_helpers</span> <span class="k">import</span> \
    <span class="n">DynamicAttributeImportRerouteModule</span>
<span class="kn">from</span> <span class="nn">obspy.io.gse2.paz</span> <span class="k">import</span> <span class="n">read_paz</span>
<span class="kn">from</span> <span class="nn">obspy.signal.invsim</span> <span class="k">import</span> <span class="n">paz_to_freq_resp</span>
<span class="kn">from</span> <span class="nn">obspy.signal.konnoohmachismoothing</span> <span class="k">import</span> <span class="n">konno_ohmachi_smoothing</span>
<span class="kn">from</span> <span class="nn">obspy.signal.util</span> <span class="k">import</span> <span class="n">next_pow_2</span>


<div class="viewcode-block" id="rel_calib_stack"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.calibration.rel_calib_stack.html#obspy.signal.calibration.rel_calib_stack">[docs]</a><span class="k">def</span> <span class="nf">rel_calib_stack</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">calib_file</span><span class="p">,</span> <span class="n">window_len</span><span class="p">,</span> <span class="n">overlap_frac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                    <span class="n">smooth</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">save_data</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Method for relative calibration of sensors using a sensor with known</span>
<span class="sd">    transfer function</span>

<span class="sd">    :param st1: Stream or Trace object, (known)</span>
<span class="sd">    :param st2: Stream or Trace object, (unknown)</span>
<span class="sd">    :type calib_file: str</span>
<span class="sd">    :param calib_file: file name of calibration file containing the PAZ of the</span>
<span class="sd">        known instrument in GSE2 standard.</span>
<span class="sd">    :type window_len: float</span>
<span class="sd">    :param window_len: length of sliding window in seconds</span>
<span class="sd">    :type overlap_frac: float</span>
<span class="sd">    :param overlap_frac: fraction of overlap, defaults to fifty percent (0.5)</span>
<span class="sd">    :type smooth: float</span>
<span class="sd">    :param smooth: variable that defines if the Konno-Ohmachi taper is used or</span>
<span class="sd">        not. default = 0 -&gt; no taper generally used in geopsy: smooth = 40</span>
<span class="sd">    :type save_data: bool</span>
<span class="sd">    :param save_data: Whether or not to save the result to a file. If True, two</span>
<span class="sd">        output files will be created:</span>
<span class="sd">        * The new response in station_name.window_length.resp</span>
<span class="sd">        * The ref response in station_name.refResp</span>
<span class="sd">        Defaults to True</span>
<span class="sd">    :returns: frequency, amplitude and phase spectrum</span>

<span class="sd">    implemented after rel_calib_stack.c by M.Ohrnberger and J.Wassermann.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># transform given trace objects to streams</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">Trace</span><span class="p">):</span>
        <span class="n">st1</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">([</span><span class="n">st1</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">Trace</span><span class="p">):</span>
        <span class="n">st2</span> <span class="o">=</span> <span class="n">Stream</span><span class="p">([</span><span class="n">st2</span><span class="p">])</span>
    <span class="c1"># check if sampling rate and trace length is the same</span>
    <span class="k">if</span> <span class="n">st1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span> <span class="o">!=</span> <span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Traces don&#39;t have the same length!&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">st1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Traces don&#39;t have the same sampling rate!&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ndat1</span> <span class="o">=</span> <span class="n">st1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span>
        <span class="n">sampfreq</span> <span class="o">=</span> <span class="n">st1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>

    <span class="c1"># read waveforms</span>
    <span class="n">tr1</span> <span class="o">=</span> <span class="n">st1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="n">tr2</span> <span class="o">=</span> <span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>

    <span class="c1"># get window length, nfft and frequency step</span>
    <span class="n">ndat</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">window_len</span> <span class="o">*</span> <span class="n">sampfreq</span><span class="p">)</span>
    <span class="n">nfft</span> <span class="o">=</span> <span class="n">next_pow_2</span><span class="p">(</span><span class="n">ndat</span><span class="p">)</span>

    <span class="c1"># read calib file and calculate response function</span>
    <span class="n">gg</span><span class="p">,</span> <span class="n">_freq</span> <span class="o">=</span> <span class="n">_calc_resp</span><span class="p">(</span><span class="n">calib_file</span><span class="p">,</span> <span class="n">nfft</span><span class="p">,</span> <span class="n">sampfreq</span><span class="p">)</span>

    <span class="c1"># calculate number of windows and overlap</span>
    <span class="n">nwin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">((</span><span class="n">ndat1</span> <span class="o">-</span> <span class="n">nfft</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">nfft</span> <span class="o">/</span> <span class="mi">2</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">noverlap</span> <span class="o">=</span> <span class="n">nfft</span> <span class="o">*</span> <span class="n">overlap_frac</span>

    <span class="n">auto</span><span class="p">,</span> <span class="n">_freq</span><span class="p">,</span> <span class="n">_t</span> <span class="o">=</span> \
        <span class="n">spectral_helper</span><span class="p">(</span><span class="n">tr1</span><span class="p">,</span> <span class="n">tr1</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="n">nfft</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">sampfreq</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="n">noverlap</span><span class="p">)</span>
    <span class="n">cross</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">_t</span> <span class="o">=</span> \
        <span class="n">spectral_helper</span><span class="p">(</span><span class="n">tr2</span><span class="p">,</span> <span class="n">tr1</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="n">nfft</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="n">sampfreq</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="n">noverlap</span><span class="p">)</span>

    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">cross</span> <span class="o">/</span> <span class="n">auto</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">gg</span>

    <span class="c1"># The first item might be zero. Problems with phase calculations.</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">freq</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">gg</span> <span class="o">=</span> <span class="n">gg</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="n">res</span> <span class="o">/=</span> <span class="n">nwin</span>
    <span class="c1"># apply Konno-Ohmachi smoothing taper if chosen</span>
    <span class="k">if</span> <span class="n">smooth</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># Write in one matrix for performance reasons.</span>
        <span class="n">spectra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">real</span><span class="p">)))</span>
        <span class="n">spectra</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">real</span>
        <span class="n">spectra</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">imag</span>
        <span class="n">new_spectra</span> <span class="o">=</span> \
            <span class="n">konno_ohmachi_smoothing</span><span class="p">(</span><span class="n">spectra</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="n">bandwidth</span><span class="o">=</span><span class="n">smooth</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">max_memory_usage</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">res</span><span class="o">.</span><span class="n">real</span> <span class="o">=</span> <span class="n">new_spectra</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">res</span><span class="o">.</span><span class="n">imag</span> <span class="o">=</span> <span class="n">new_spectra</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
    <span class="c1"># include phase unwrapping</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">res</span><span class="p">))</span>  <span class="c1"># + 2.0 * np.pi</span>
    <span class="n">ra</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">gg</span><span class="p">)</span>
    <span class="n">rpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unwrap</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">gg</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">save_data</span><span class="p">:</span>
        <span class="n">trans_new</span> <span class="o">=</span> <span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">st2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">channel</span> <span class="o">+</span>
                     <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">window_len</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.resp&quot;</span><span class="p">)</span>
        <span class="n">trans_ref</span> <span class="o">=</span> <span class="n">st1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">station</span> <span class="o">+</span> <span class="s2">&quot;.refResp&quot;</span>
        <span class="c1"># Create empty array for easy saving</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span> <span class="mi">3</span><span class="p">))</span>
        <span class="n">temp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">freq</span>
        <span class="n">temp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">amp</span>
        <span class="n">temp</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">phase</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">trans_new</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">native_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.10f</span><span class="s1">&#39;</span><span class="p">))</span>
        <span class="n">temp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ra</span>
        <span class="n">temp</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">rpha</span>
        <span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="n">trans_ref</span><span class="p">,</span> <span class="n">temp</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="n">native_str</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.10f</span><span class="s1">&#39;</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">freq</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">phase</span></div>


<div class="viewcode-block" id="_calc_resp"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.calibration._calc_resp.html#obspy.signal.calibration._calc_resp">[docs]</a><span class="k">def</span> <span class="nf">_calc_resp</span><span class="p">(</span><span class="n">calfile</span><span class="p">,</span> <span class="n">nfft</span><span class="p">,</span> <span class="n">sampfreq</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate transfer function of known system.</span>

<span class="sd">    :type calfile: str</span>
<span class="sd">    :param calfile: file containing poles, zeros and scale factor for known</span>
<span class="sd">        system</span>
<span class="sd">    :returns: complex transfer function, array of frequencies</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># calculate transfer function</span>
    <span class="n">poles</span><span class="p">,</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">scale_fac</span> <span class="o">=</span> <span class="n">read_paz</span><span class="p">(</span><span class="n">calfile</span><span class="p">)</span>
    <span class="n">h</span><span class="p">,</span> <span class="n">f</span> <span class="o">=</span> <span class="n">paz_to_freq_resp</span><span class="p">(</span><span class="n">poles</span><span class="p">,</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">scale_fac</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">sampfreq</span><span class="p">,</span>
                            <span class="n">nfft</span><span class="p">,</span> <span class="n">freq</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">f</span></div>


<span class="c1"># A modified copy of the Matplotlib 0.99.1.1 method spectral_helper found in</span>
<span class="c1"># .../matlab/mlab.py.</span>
<span class="c1"># Some function were changed to avoid additional dependencies. Included here as</span>
<span class="c1"># it is essential for the above rel_calib_stack function and only present in</span>
<span class="c1">#  recent matplotlib versions.</span>

<span class="c1"># This is a helper function that implements the commonality between the</span>
<span class="c1"># psd, csd, and spectrogram.  It is *NOT* meant to be used outside of mlab</span>
<div class="viewcode-block" id="spectral_helper"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.calibration.spectral_helper.html#obspy.signal.calibration.spectral_helper">[docs]</a><span class="k">def</span> <span class="nf">spectral_helper</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">NFFT</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span> <span class="n">Fs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">noverlap</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">pad_to</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>  <span class="c1"># noqa</span>
                    <span class="n">sides</span><span class="o">=</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="n">scale_by_freq</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># The checks for if y is x are so that we can use the same function to</span>
    <span class="c1"># implement the core of psd(), csd(), and spectrogram() without doing</span>
    <span class="c1"># extra calculations.  We return the unaveraged Pxy, freqs, and t.</span>
    <span class="n">same_data</span> <span class="o">=</span> <span class="n">y</span> <span class="ow">is</span> <span class="n">x</span>

    <span class="c1"># Make sure we&#39;re dealing with a NumPy array. If y and x were the same</span>
    <span class="c1"># object to start with, keep them that way</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">same_data</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>

    <span class="c1"># zero pad x and y up to NFFT if they are shorter than NFFT</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">NFFT</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="p">(</span><span class="n">NFFT</span><span class="p">,))</span>
        <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">same_data</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">NFFT</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="p">(</span><span class="n">NFFT</span><span class="p">,))</span>
        <span class="n">y</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">pad_to</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">pad_to</span> <span class="o">=</span> <span class="n">NFFT</span>

    <span class="k">if</span> <span class="n">scale_by_freq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">scale_by_freq</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># For real x, ignore the negative frequencies unless told otherwise</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">sides</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="ow">or</span> <span class="n">sides</span> <span class="o">==</span> <span class="s1">&#39;twosided&#39;</span><span class="p">:</span>
        <span class="n">num_freqs</span> <span class="o">=</span> <span class="n">pad_to</span>
        <span class="n">scaling_factor</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">elif</span> <span class="n">sides</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;onesided&#39;</span><span class="p">):</span>
        <span class="n">num_freqs</span> <span class="o">=</span> <span class="n">pad_to</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">scaling_factor</span> <span class="o">=</span> <span class="mf">2.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;sides must be one of: &#39;default&#39;, &#39;onesided&#39;, or &quot;</span>
                         <span class="s2">&quot;&#39;twosided&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># Matlab divides by the sampling frequency so that density function</span>
    <span class="c1"># has units of dB/Hz and can be integrated by the plotted frequency</span>
    <span class="c1"># values. Perform the same scaling here.</span>
    <span class="k">if</span> <span class="n">scale_by_freq</span><span class="p">:</span>
        <span class="n">scaling_factor</span> <span class="o">/=</span> <span class="n">Fs</span>

    <span class="n">window_vals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hanning</span><span class="p">(</span><span class="n">NFFT</span><span class="p">)</span>

    <span class="n">step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">NFFT</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">noverlap</span><span class="p">)</span>
    <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">NFFT</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span>
    <span class="n">p_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">num_freqs</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">complex_</span><span class="p">)</span>

    <span class="c1"># do the ffts of the slices</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">this_x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">NFFT</span><span class="p">]</span>
        <span class="n">this_x</span> <span class="o">=</span> <span class="n">window_vals</span> <span class="o">*</span> <span class="n">this_x</span>
        <span class="n">fx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">this_x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">pad_to</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">same_data</span><span class="p">:</span>
            <span class="n">fy</span> <span class="o">=</span> <span class="n">fx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">th_is_y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span><span class="n">ind</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">NFFT</span><span class="p">]</span>
            <span class="n">th_is_y</span> <span class="o">=</span> <span class="n">window_vals</span> <span class="o">*</span> <span class="n">th_is_y</span>
            <span class="n">fy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">th_is_y</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">pad_to</span><span class="p">)</span>
        <span class="n">p_xy</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">conjugate</span><span class="p">(</span><span class="n">fx</span><span class="p">[:</span><span class="n">num_freqs</span><span class="p">])</span> <span class="o">*</span> <span class="n">fy</span><span class="p">[:</span><span class="n">num_freqs</span><span class="p">]</span>

    <span class="c1"># Scale the spectrum by the norm of the window to compensate for</span>
    <span class="c1"># windowing loss; see Bendat &amp; Piersol Sec 11.5.2.  Also include</span>
    <span class="c1"># scaling factors for one-sided densities and dividing by the sampling</span>
    <span class="c1"># frequency, if desired.</span>
    <span class="n">p_xy</span> <span class="o">*=</span> <span class="n">scaling_factor</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">window_vals</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">t</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">Fs</span> <span class="o">*</span> <span class="p">(</span><span class="n">ind</span> <span class="o">+</span> <span class="n">NFFT</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
    <span class="n">freqs</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Fs</span><span class="p">)</span> <span class="o">/</span> <span class="n">pad_to</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_freqs</span><span class="p">)</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">iscomplexobj</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">sides</span> <span class="o">==</span> <span class="s1">&#39;default&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">sides</span> <span class="o">==</span> <span class="s1">&#39;twosided&#39;</span><span class="p">:</span>
        <span class="c1"># center the frequency range at zero</span>
        <span class="n">freqs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">freqs</span><span class="p">[</span><span class="n">num_freqs</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:]</span> <span class="o">-</span> <span class="n">Fs</span><span class="p">,</span>
                                <span class="n">freqs</span><span class="p">[:</span><span class="n">num_freqs</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]))</span>
        <span class="n">p_xy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">p_xy</span><span class="p">[</span><span class="n">num_freqs</span> <span class="o">//</span> <span class="mi">2</span><span class="p">:,</span> <span class="p">:],</span>
                              <span class="n">p_xy</span><span class="p">[:</span><span class="n">num_freqs</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="p">:]),</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">p_xy</span><span class="p">,</span> <span class="n">freqs</span><span class="p">,</span> <span class="n">t</span></div>


<span class="c1"># Remove once 0.11 has been released.</span>
<span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">DynamicAttributeImportRerouteModule</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">locs</span><span class="o">=</span><span class="nb">locals</span><span class="p">(),</span>
    <span class="n">original_module</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">],</span>
    <span class="n">import_map</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">function_map</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">&quot;relcalstack&quot;</span><span class="p">:</span> <span class="s2">&quot;obspy.signal.calibration.rel_calib_stack&quot;</span><span class="p">,</span>
        <span class="s2">&quot;_calcresp&quot;</span><span class="p">:</span> <span class="s2">&quot;obspy.signal.calibration._calc_resp&quot;</span><span class="p">})</span>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a>™ &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, Ólafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Käufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhäusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaimé, Sébastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clément</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Köhler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n° 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>