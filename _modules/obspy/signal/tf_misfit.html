<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.signal.tf_misfit &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.signal.tf_misfit</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># ------------------------------------------------------------------</span>
<span class="c1"># Filename: tf_misfit.py</span>
<span class="c1">#  Purpose: Various Time Frequency Misfit Functions</span>
<span class="c1">#   Author: Martin van Driel</span>
<span class="c1">#    Email: vandriel@sed.ethz.ch</span>
<span class="c1">#</span>
<span class="c1"># Copyright (C) 2012 Martin van Driel</span>
<span class="c1"># --------------------------------------------------------------------</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Various Time Frequency Misfit Functions based on [Kristekova2006]_ and</span>
<span class="sd">[Kristekova2009]_.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org)</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">obspy.core.util.decorator</span> <span class="k">import</span> <span class="n">deprecated</span>
<span class="kn">from</span> <span class="nn">obspy.imaging.cm</span> <span class="k">import</span> <span class="n">obspy_sequential</span><span class="p">,</span> <span class="n">obspy_divergent</span>
<span class="kn">from</span> <span class="nn">obspy.signal</span> <span class="k">import</span> <span class="n">util</span>


<div class="viewcode-block" id="cwt"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.cwt.html#obspy.signal.tf_misfit.cwt">[docs]</a><span class="k">def</span> <span class="nf">cwt</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">wl</span><span class="o">=</span><span class="s1">&#39;morlet&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Continuous Wavelet Transformation in the Frequency Domain.</span>

<span class="sd">    .. seealso:: [Kristekova2006]_, eq. (4)</span>

<span class="sd">    :param st: time dependent signal.</span>
<span class="sd">    :param dt: time step between two samples in st (in seconds)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param fmin: minimum frequency (in Hz)</span>
<span class="sd">    :param fmax: maximum frequency (in Hz)</span>
<span class="sd">    :param nf: number of logarithmically spaced frequencies between fmin and</span>
<span class="sd">        fmax</span>
<span class="sd">    :param wl: wavelet to use, for now only &#39;morlet&#39; is implemented</span>

<span class="sd">    :return: time frequency representation of st, type numpy.ndarray of complex</span>
<span class="sd">        values, shape = (nf, len(st)).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">tmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">npts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span> <span class="n">nf</span><span class="p">)</span>

    <span class="n">cwt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npts</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">nf</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">wl</span> <span class="o">==</span> <span class="s1">&#39;morlet&#39;</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">psi</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="p">(</span><span class="o">-.</span><span class="mi">25</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">w0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> \
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">scale</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">w0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;wavelet type &quot;&#39;</span> <span class="o">+</span> <span class="n">wl</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span>

    <span class="n">nfft</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">next_pow_2</span><span class="p">(</span><span class="n">npts</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nfft</span><span class="p">)</span>

    <span class="c1"># Ignore underflows.</span>
    <span class="n">_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geterr</span><span class="p">()</span>
    <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="n">under</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">_f</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">scale</span><span class="p">(</span><span class="n">_f</span><span class="p">)</span>
            <span class="c1"># time shift necessary, because wavelet is defined around t = 0</span>
            <span class="n">psih</span> <span class="o">=</span> <span class="n">psi</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>
            <span class="n">psihf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">psih</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nfft</span><span class="p">)</span>
            <span class="n">tminin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">cwt</span><span class="p">[:,</span> <span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">psihf</span> <span class="o">*</span> <span class="n">sf</span><span class="p">)[</span><span class="n">tminin</span><span class="p">:</span><span class="n">tminin</span> <span class="o">+</span> <span class="n">npts</span> <span class="o">//</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*</span> \
                <span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">seterr</span><span class="p">(</span><span class="o">**</span><span class="n">_t</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">cwt</span><span class="o">.</span><span class="n">T</span></div>


<div class="viewcode-block" id="tfem"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.tfem.html#obspy.signal.tf_misfit.tfem">[docs]</a><span class="k">def</span> <span class="nf">tfem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
         <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time Frequency Envelope Misfit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Table 1. and 2.</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>

<span class="sd">    :return: time frequency representation of Envelope Misfit,</span>
<span class="sd">        type numpy.ndarray with shape (nf, len(st1)) for single component data</span>
<span class="sd">        and (number of components, nf, len(st1)) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="n">w_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">w_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">w_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">w_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">st2_isref</span><span class="p">:</span>
        <span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>

    <span class="n">_tfem</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tfem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tfem</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ar</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tfem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">ar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tfem</span> <span class="o">/</span> <span class="n">ar</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;norm &quot;&#39;</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="tfpm"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.tfpm.html#obspy.signal.tf_misfit.tfpm">[docs]</a><span class="k">def</span> <span class="nf">tfpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
         <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time Frequency Phase Misfit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Table 1. and 2.</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>

<span class="sd">    :return: time frequency representation of Phase Misfit,</span>
<span class="sd">        type numpy.ndarray with shape (nf, len(st1)) for single component data</span>
<span class="sd">        and (number of components, nf, len(st1)) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="n">w_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">w_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">w_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">w_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">st2_isref</span><span class="p">:</span>
        <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>

    <span class="n">_tfpm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">w_1</span> <span class="o">/</span> <span class="n">w_2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_ar</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">_tfpm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">_ar</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_ar</span> <span class="o">*</span> <span class="n">_tfpm</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">_ar</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tfpm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tfpm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;norm &quot;&#39;</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="tem"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.tem.html#obspy.signal.tf_misfit.tem">[docs]</a><span class="k">def</span> <span class="nf">tem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
        <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time-dependent Envelope Misfit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Table 1. and 2.</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>

<span class="sd">    :return: Time-dependent Envelope Misfit, type numpy.ndarray with shape</span>
<span class="sd">        (len(st1),) for single component data and (number of components,</span>
<span class="sd">        len(st1)) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="n">w_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">w_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">w_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">w_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">st2_isref</span><span class="p">:</span>
        <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>

    <span class="n">_tem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tem</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tem</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;norm &quot;&#39;</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="tpm"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.tpm.html#obspy.signal.tf_misfit.tpm">[docs]</a><span class="k">def</span> <span class="nf">tpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
        <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time-dependent Phase Misfit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Table 1. and 2.</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>

<span class="sd">    :return: Time-dependent Phase Misfit, type numpy.ndarray with shape</span>
<span class="sd">        (len(st1),) for single component data and (number of components,</span>
<span class="sd">        len(st1)) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="n">w_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">w_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">w_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">w_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">st2_isref</span><span class="p">:</span>
        <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span>

    <span class="n">_tpm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">w_1</span> <span class="o">/</span> <span class="n">w_2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">_tpm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">*</span> <span class="n">_tpm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tpm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tpm</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tpm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tpm</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;norm &quot;&#39;</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="fem"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.fem.html#obspy.signal.tf_misfit.fem">[docs]</a><span class="k">def</span> <span class="nf">fem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
        <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Frequency-dependent Envelope Misfit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Table 1. and 2.</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>

<span class="sd">    :return: Frequency-dependent Envelope Misfit, type numpy.ndarray with shape</span>
<span class="sd">        (nf,) for single component data and (number of components, nf) for</span>
<span class="sd">        multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="n">w_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">w_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">w_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">w_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">st2_isref</span><span class="p">:</span>
        <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>

    <span class="n">_tem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="n">_tem</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_tem</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tem</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tem</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tem</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;norm &quot;&#39;</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="fpm"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.fpm.html#obspy.signal.tf_misfit.fpm">[docs]</a><span class="k">def</span> <span class="nf">fpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
        <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Frequency-dependent Phase Misfit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Table 1. and 2.</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>

<span class="sd">    :return: Frequency-dependent Phase Misfit, type numpy.ndarray with shape</span>
<span class="sd">        (nf,) for single component data and (number of components, nf) for</span>
<span class="sd">        multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="n">w_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">w_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">w_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">w_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">st2_isref</span><span class="p">:</span>
        <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>

    <span class="n">_tpm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">w_1</span> <span class="o">/</span> <span class="n">w_2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">_tpm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">*</span> <span class="n">_tpm</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tpm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tpm</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tpm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_tpm</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;norm &quot;&#39;</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="em"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.em.html#obspy.signal.tf_misfit.em">[docs]</a><span class="k">def</span> <span class="nf">em</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
       <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single Valued Envelope Misfit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Table 1. and 2.</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>

<span class="sd">    :return: Single Valued Envelope Misfit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="n">w_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">w_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">w_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">w_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">st2_isref</span><span class="p">:</span>
        <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>

    <span class="n">_em</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                  <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>

    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_em</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_em</span> <span class="o">/</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                                  <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_em</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_em</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;norm &quot;&#39;</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="pm"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.pm.html#obspy.signal.tf_misfit.pm">[docs]</a><span class="k">def</span> <span class="nf">pm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
       <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single Valued Phase Misfit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Table 1. and 2.</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>

<span class="sd">    :return: Single Valued Phase Misfit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="n">w_1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">w_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">w_1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">w_2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">st2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">w_1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st1</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">w_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st2</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">st2_isref</span><span class="p">:</span>
        <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">():</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_ar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">w_2</span><span class="p">)</span>

    <span class="n">_pm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">w_1</span> <span class="o">/</span> <span class="n">w_2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">_pm</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">_ar</span> <span class="o">*</span> <span class="n">_pm</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>

    <span class="k">if</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_pm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_pm</span> <span class="o">/</span> <span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                                  <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">norm</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_pm</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">_pm</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_ar</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="o">.</span><span class="mi">5</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;norm &quot;&#39;</span> <span class="o">+</span> <span class="n">norm</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span></div>


<div class="viewcode-block" id="tfeg"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.tfeg.html#obspy.signal.tf_misfit.tfeg">[docs]</a><span class="k">def</span> <span class="nf">tfeg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
         <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time Frequency Envelope Goodness-of-Fit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Eq.(15)</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param a: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>

<span class="sd">    :return: time frequency representation of Envelope Goodness-of-Fit,</span>
<span class="sd">        type numpy.ndarray with shape (nf, len(st1)) for single component data</span>
<span class="sd">        and (number of components, nf, len(st1)) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_tfem</span> <span class="o">=</span> <span class="n">tfem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tfem</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="tfpg"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.tfpg.html#obspy.signal.tf_misfit.tfpg">[docs]</a><span class="k">def</span> <span class="nf">tfpg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
         <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time Frequency Phase Goodness-of-Fit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Eq.(16)</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param a: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>

<span class="sd">    :return: time frequency representation of Phase Goodness-of-Fit,</span>
<span class="sd">        type numpy.ndarray with shape (nf, len(st1)) for single component data</span>
<span class="sd">        and (number of components, nf, len(st1)) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_tfpm</span> <span class="o">=</span> <span class="n">tfpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tfpm</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="teg"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.teg.html#obspy.signal.tf_misfit.teg">[docs]</a><span class="k">def</span> <span class="nf">teg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
        <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time-dependent Envelope Goodness-of-Fit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Eq.(15)</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param a: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>

<span class="sd">    :return: time dependent Envelope Goodness-of-Fit, type numpy.ndarray with</span>
<span class="sd">        shape (len(st1),) for single component data and (number of components,</span>
<span class="sd">        len(st1)) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_tem</span> <span class="o">=</span> <span class="n">tem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tem</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="tpg"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.tpg.html#obspy.signal.tf_misfit.tpg">[docs]</a><span class="k">def</span> <span class="nf">tpg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
        <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Time-dependent Phase Goodness-of-Fit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Eq.(16)</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param a: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>

<span class="sd">    :return: time dependent Phase Goodness-of-Fit, type numpy.ndarray with</span>
<span class="sd">        shape (len(st1),) for single component data and (number of components,</span>
<span class="sd">        len(st1)) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_tpm</span> <span class="o">=</span> <span class="n">tpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tpm</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="feg"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.feg.html#obspy.signal.tf_misfit.feg">[docs]</a><span class="k">def</span> <span class="nf">feg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
        <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Frequency-dependent Envelope Goodness-of-Fit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Eq.(15)</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param a: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>

<span class="sd">    :return: frequency dependent Envelope Goodness-of-Fit, type numpy.ndarray</span>
<span class="sd">        with shape (nf,) for single component data and (number of components,</span>
<span class="sd">        nf) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fem</span> <span class="o">=</span> <span class="n">fem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_fem</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="fpg"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.fpg.html#obspy.signal.tf_misfit.fpg">[docs]</a><span class="k">def</span> <span class="nf">fpg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
        <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Frequency-dependent Phase Goodness-of-Fit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Eq.(16)</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param a: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>

<span class="sd">    :return: frequency dependent Phase Goodness-of-Fit, type numpy.ndarray</span>
<span class="sd">        with shape (nf,) for single component data and (number of components,</span>
<span class="sd">        nf) for multicomponent data</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fpm</span> <span class="o">=</span> <span class="n">fpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_fpm</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="eg"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.eg.html#obspy.signal.tf_misfit.eg">[docs]</a><span class="k">def</span> <span class="nf">eg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
       <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single Valued Envelope Goodness-of-Fit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Eq.(15)</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param a: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>

<span class="sd">    :return: Single Valued Envelope Goodness-of-Fit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_em</span> <span class="o">=</span> <span class="n">em</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
             <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_em</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="pg"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.pg.html#obspy.signal.tf_misfit.pg">[docs]</a><span class="k">def</span> <span class="nf">pg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
       <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Single Valued Phase Goodness-of-Fit</span>

<span class="sd">    .. seealso:: [Kristekova2009]_, Eq.(16)</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param a: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>

<span class="sd">    :return: Single Valued Phase Goodness-of-Fit</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_pm</span> <span class="o">=</span> <span class="n">pm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
             <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_pm</span><span class="p">)</span> <span class="o">**</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="plot_tf_misfits"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.plot_tf_misfits.html#obspy.signal.tf_misfit.plot_tf_misfits">[docs]</a><span class="k">def</span> <span class="nf">plot_tf_misfits</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                    <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                    <span class="n">h_1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">h_2</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span> <span class="n">h_3</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">w_1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">w_2</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">w_cb</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                    <span class="n">d_cb</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span>
                    <span class="n">clim</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">obspy_divergent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot all time frequency misfits and the time series in one plot (per</span>
<span class="sd">    component).</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param t0: starting time for plotting</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param left: plot distance from the left of the figure</span>
<span class="sd">    :param bottom: plot distance from the bottom of the figure</span>
<span class="sd">    :param h_1: height of the signal axes</span>
<span class="sd">    :param h_2: height of the TEM and TPM axes</span>
<span class="sd">    :param h_3: height of the TFEM and TFPM axes</span>
<span class="sd">    :param w_1: width of the FEM and FPM axes</span>
<span class="sd">    :param w_2: width of the TFEM, TFPM, signal etc. axes</span>
<span class="sd">    :param w_cb: width of the colorbar axes</span>
<span class="sd">    :param d_cb: distance of the colorbar axes to the other axes</span>
<span class="sd">    :param show: show figure or return</span>
<span class="sd">    :param plot_args: list of plot arguments passed to the signal 1/2 and</span>
<span class="sd">        TEM/TPM/FEM/FPM plots</span>
<span class="sd">    :param ylim: limits in misfit for TEM/TPM/FEM/FPM</span>
<span class="sd">    :param clim: limits of the colorbars</span>
<span class="sd">    :param cmap: colormap for TFEM/TFPM, either a string or</span>
<span class="sd">        matplotlib.cm.Colormap instance</span>

<span class="sd">    :return: If show is False, returns a matplotlib.pyplot.figure object</span>
<span class="sd">        (single component data) or a list of figure objects (multi component</span>
<span class="sd">        data)</span>

<span class="sd">    .. rubric:: Example</span>

<span class="sd">    For a signal with pure phase error</span>

<span class="sd">    .. seealso:: [Kristekova2006]_, Fig.(4)</span>

<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; from scipy.signal import hilbert</span>
<span class="sd">    &gt;&gt;&gt; tmax = 6.</span>
<span class="sd">    &gt;&gt;&gt; dt = 0.01</span>
<span class="sd">    &gt;&gt;&gt; npts = int(tmax / dt + 1)</span>
<span class="sd">    &gt;&gt;&gt; t = np.linspace(0., tmax, npts)</span>
<span class="sd">    &gt;&gt;&gt; A1 = 4.</span>
<span class="sd">    &gt;&gt;&gt; t1 = 2.</span>
<span class="sd">    &gt;&gt;&gt; f1 = 2.</span>
<span class="sd">    &gt;&gt;&gt; phi1 = 0.</span>
<span class="sd">    &gt;&gt;&gt; phase_shift = 0.1</span>
<span class="sd">    &gt;&gt;&gt; H1 = (np.sign(t - t1) + 1)/ 2</span>
<span class="sd">    &gt;&gt;&gt; st1 = (A1 * (t - t1) * np.exp(-2*(t - t1)) *</span>
<span class="sd">    ...       np.cos(2. * np.pi * f1 * (t - t1) + phi1 * np.pi) * H1)</span>
<span class="sd">    &gt;&gt;&gt; # Reference signal</span>
<span class="sd">    &gt;&gt;&gt; st2 = st1.copy()</span>
<span class="sd">    &gt;&gt;&gt; # Distorted signal:</span>
<span class="sd">    &gt;&gt;&gt; # generate analytical signal (hilbert transform) and add phase shift</span>
<span class="sd">    &gt;&gt;&gt; st1 = hilbert(st1)</span>
<span class="sd">    &gt;&gt;&gt; st1 = np.real(np.abs(st1) * np.exp((np.angle(st1) +</span>
<span class="sd">    ...                                     phase_shift * np.pi) * 1j))</span>
<span class="sd">    &gt;&gt;&gt; plot_tf_misfits(st1, st2, dt=dt, fmin=1., fmax=10.) # doctest: +SKIP</span>

<span class="sd">    .. plot::</span>

<span class="sd">        import numpy as np</span>
<span class="sd">        from scipy.signal import hilbert</span>
<span class="sd">        from obspy.signal.tf_misfit import plot_tf_misfits</span>
<span class="sd">        tmax = 6.</span>
<span class="sd">        dt = 0.01</span>
<span class="sd">        npts = int(tmax / dt + 1)</span>
<span class="sd">        t = np.linspace(0., tmax, npts)</span>
<span class="sd">        A1 = 4.</span>
<span class="sd">        t1 = 2.</span>
<span class="sd">        f1 = 2.</span>
<span class="sd">        phi1 = 0.</span>
<span class="sd">        phase_shift = 0.1</span>
<span class="sd">        H1 = (np.sign(t - t1) + 1)/ 2</span>
<span class="sd">        st1 = (A1 * (t - t1) * np.exp(-2*(t - t1)) *</span>
<span class="sd">              np.cos(2. * np.pi * f1 * (t - t1) + phi1 * np.pi) * H1)</span>
<span class="sd">        # Reference signal</span>
<span class="sd">        st2 = st1.copy()</span>
<span class="sd">        # Distorted signal:</span>
<span class="sd">        # generate analytical signal (hilbert transform) and add phase shift</span>
<span class="sd">        st1 = hilbert(st1)</span>
<span class="sd">        st1 = np.real(np.abs(st1) * np.exp((np.angle(st1) +</span>
<span class="sd">                                            phase_shift * np.pi) * 1j))</span>
<span class="sd">        plot_tf_misfits(st1, st2, dt=dt, fmin=1., fmax=10.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">NullFormatter</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">npts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span> <span class="o">+</span> <span class="n">t0</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span> <span class="n">nf</span><span class="p">)</span>

    <span class="c1"># compute time frequency misfits</span>
    <span class="n">_tfem</span> <span class="o">=</span> <span class="n">tfem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="n">_tem</span> <span class="o">=</span> <span class="n">tem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="n">_fem</span> <span class="o">=</span> <span class="n">fem</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="n">_em</span> <span class="o">=</span> <span class="n">em</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
             <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="n">_tfpm</span> <span class="o">=</span> <span class="n">tfpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="n">_tpm</span> <span class="o">=</span> <span class="n">tpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="n">_fpm</span> <span class="o">=</span> <span class="n">fpm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>
    <span class="n">_pm</span> <span class="o">=</span> <span class="n">pm</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
             <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_tfem</span> <span class="o">=</span> <span class="n">_tfem</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">_tem</span> <span class="o">=</span> <span class="n">_tem</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">_fem</span> <span class="o">=</span> <span class="n">_fem</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">))</span>
        <span class="n">_em</span> <span class="o">=</span> <span class="n">_em</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">_tfpm</span> <span class="o">=</span> <span class="n">_tfpm</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">_tpm</span> <span class="o">=</span> <span class="n">_tpm</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">_fpm</span> <span class="o">=</span> <span class="n">_fpm</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">))</span>
        <span class="n">_pm</span> <span class="o">=</span> <span class="n">_pm</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">st1</span> <span class="o">=</span> <span class="n">st1</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">st2</span> <span class="o">=</span> <span class="n">st2</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">ntr</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ntr</span> <span class="o">=</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ntr</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

        <span class="c1"># plot signals</span>
        <span class="n">ax_sig</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_1</span><span class="p">])</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">st1</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">st2</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># plot TEM</span>
        <span class="n">ax_tem</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_1</span> <span class="o">+</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_2</span><span class="p">])</span>
        <span class="n">ax_tem</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">_tem</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># plot TFEM</span>
        <span class="n">ax_tfem</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span>
                                <span class="n">h_3</span><span class="p">])</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span>
                           <span class="n">_tfem</span><span class="p">[</span><span class="n">itr</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">img_tfem</span> <span class="o">=</span> <span class="n">ax_tfem</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_tfem</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">img_tfem</span><span class="o">.</span><span class="n">set_rasterized</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax_tfem</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">ax_tfem</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

        <span class="c1"># plot FEM</span>
        <span class="n">ax_fem</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">,</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">h_3</span><span class="p">])</span>
        <span class="n">ax_fem</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">_fem</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">f</span><span class="p">,</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax_fem</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

        <span class="c1"># plot TPM</span>
        <span class="n">ax_tpm</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_2</span><span class="p">])</span>
        <span class="n">ax_tpm</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">_tpm</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># plot TFPM</span>
        <span class="n">ax_tfpm</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_2</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_3</span><span class="p">])</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">img_tfpm</span> <span class="o">=</span> <span class="n">ax_tfpm</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_tfpm</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">img_tfpm</span><span class="o">.</span><span class="n">set_rasterized</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax_tfpm</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">ax_tfpm</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># add colorbars</span>
        <span class="n">ax_cb_tfpm</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span> <span class="o">+</span> <span class="n">w_2</span> <span class="o">+</span> <span class="n">d_cb</span> <span class="o">+</span> <span class="n">w_cb</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span>
                                   <span class="n">w_cb</span><span class="p">,</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img_tfpm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">ax_cb_tfpm</span><span class="p">)</span>

        <span class="c1"># plot FPM</span>
        <span class="n">ax_fpm</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_2</span><span class="p">,</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">h_3</span><span class="p">])</span>
        <span class="n">ax_fpm</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">_fpm</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">f</span><span class="p">,</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax_fpm</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

        <span class="c1"># set limits</span>
        <span class="n">ylim_sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">st1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">st2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">*</span> <span class="mf">1.1</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">ylim_sig</span><span class="p">,</span> <span class="n">ylim_sig</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ylim</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tem</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tpm</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_fem</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_fpm</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">*</span> <span class="mf">1.1</span>

        <span class="n">ax_tem</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">ylim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
        <span class="n">ax_fem</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">ylim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
        <span class="n">ax_tpm</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">ylim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
        <span class="n">ax_fpm</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="n">ylim</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>

        <span class="n">ax_sig</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax_tem</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax_tpm</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">clim</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">clim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tfem</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tfpm</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>

        <span class="n">img_tfpm</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="o">-</span><span class="n">clim</span><span class="p">,</span> <span class="n">clim</span><span class="p">)</span>
        <span class="n">img_tfem</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="o">-</span><span class="n">clim</span><span class="p">,</span> <span class="n">clim</span><span class="p">)</span>

        <span class="c1"># add text box for EM + PM</span>
        <span class="n">textstr</span> <span class="o">=</span> <span class="s1">&#39;EM = </span><span class="si">%.2f</span><span class="se">\n</span><span class="s1">PM = </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_em</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">_pm</span><span class="p">[</span><span class="n">itr</span><span class="p">])</span>
        <span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_sig</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>

        <span class="n">ax_tpm</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">ax_fem</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
        <span class="n">ax_fpm</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

        <span class="c1"># add text boxes</span>
        <span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax_tfem</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;TFEM&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_tfem</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                     <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_tfpm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;TFPM&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_tfpm</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                     <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_tem</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s1">&#39;TEM&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_tem</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_tpm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s1">&#39;TPM&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_tpm</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_fem</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;FEM&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_fem</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_fpm</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;FPM&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_fpm</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>

        <span class="c1"># remove axis labels</span>
        <span class="n">ax_tfpm</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_tfem</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_tem</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_tfpm</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_tfem</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>

        <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ntr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">figs</span></div>


<div class="viewcode-block" id="plot_tf_gofs"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.plot_tf_gofs.html#obspy.signal.tf_misfit.plot_tf_gofs">[docs]</a><span class="k">def</span> <span class="nf">plot_tf_gofs</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="n">st2_isref</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                 <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">h_1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">h_2</span><span class="o">=</span><span class="mf">0.125</span><span class="p">,</span> <span class="n">h_3</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">w_1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">w_2</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
                 <span class="n">w_cb</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">d_cb</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">],</span>
                 <span class="n">ylim</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">obspy_sequential</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot all time frequency Goodness-of-Fits and the time series in one plot</span>
<span class="sd">    (per component).</span>

<span class="sd">    :param st1: signal 1 of two signals to compare, type numpy.ndarray with</span>
<span class="sd">        shape (number of components, number of time samples) or (number of</span>
<span class="sd">        timesamples, ) for single component data</span>
<span class="sd">    :param st2: signal 2 of two signals to compare, type and shape as st1</span>
<span class="sd">    :param dt: time step between two samples in st1 and st2</span>
<span class="sd">    :param t0: starting time for plotting</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param norm: &#39;global&#39; or &#39;local&#39; normalization of the misfit</span>
<span class="sd">    :type st2_isref: bool</span>
<span class="sd">    :param st2_isref: True if st2 is a reference signal, False if none is a</span>
<span class="sd">        reference</span>
<span class="sd">    :param A: Maximum value of Goodness-of-Fit for perfect agreement</span>
<span class="sd">    :param k: sensitivity of Goodness-of-Fit to the misfit</span>
<span class="sd">    :param left: plot distance from the left of the figure</span>
<span class="sd">    :param bottom: plot distance from the bottom of the figure</span>
<span class="sd">    :param h_1: height of the signal axes</span>
<span class="sd">    :param h_2: height of the TEM and TPM axes</span>
<span class="sd">    :param h_3: height of the TFEM and TFPM axes</span>
<span class="sd">    :param w_1: width of the FEM and FPM axes</span>
<span class="sd">    :param w_2: width of the TFEM, TFPM, signal etc. axes</span>
<span class="sd">    :param w_cb: width of the colorbar axes</span>
<span class="sd">    :param d_cb: distance of the colorbar axes to the other axes</span>
<span class="sd">    :param show: show figure or return</span>
<span class="sd">    :param plot_args: list of plot arguments passed to the signal 1/2 and</span>
<span class="sd">        TEM/TPM/FEM/FPM plots</span>
<span class="sd">    :param ylim: limits in misfit for TEM/TPM/FEM/FPM</span>
<span class="sd">    :param clim: limits of the colorbars</span>
<span class="sd">    :param cmap: colormap for TFEM/TFPM, either a string or</span>
<span class="sd">        matplotlib.cm.Colormap instance</span>

<span class="sd">    :return: If show is False, returns a matplotlib.pyplot.figure object</span>
<span class="sd">        (single component data) or a list of figure objects (multi component</span>
<span class="sd">        data)</span>

<span class="sd">    .. rubric:: Example</span>

<span class="sd">    For a signal with pure amplitude error</span>

<span class="sd">    &gt;&gt;&gt; import numpy as np</span>
<span class="sd">    &gt;&gt;&gt; tmax = 6.</span>
<span class="sd">    &gt;&gt;&gt; dt = 0.01</span>
<span class="sd">    &gt;&gt;&gt; npts = int(tmax / dt + 1)</span>
<span class="sd">    &gt;&gt;&gt; t = np.linspace(0., tmax, npts)</span>
<span class="sd">    &gt;&gt;&gt; A1 = 4.</span>
<span class="sd">    &gt;&gt;&gt; t1 = 2.</span>
<span class="sd">    &gt;&gt;&gt; f1 = 2.</span>
<span class="sd">    &gt;&gt;&gt; phi1 = 0.</span>
<span class="sd">    &gt;&gt;&gt; phase_shift = 0.1</span>
<span class="sd">    &gt;&gt;&gt; H1 = (np.sign(t - t1) + 1)/ 2</span>
<span class="sd">    &gt;&gt;&gt; st1 = (A1 * (t - t1) * np.exp(-2*(t - t1)) *</span>
<span class="sd">    ...       np.cos(2. * np.pi * f1 * (t - t1) + phi1 * np.pi) * H1)</span>
<span class="sd">    &gt;&gt;&gt; # Reference signal</span>
<span class="sd">    &gt;&gt;&gt; st2 = st1.copy()</span>
<span class="sd">    &gt;&gt;&gt; # Distorted signal:</span>
<span class="sd">    &gt;&gt;&gt; st1 = st1 * 3.</span>
<span class="sd">    &gt;&gt;&gt; plot_tf_gofs(st1, st2, dt=dt, fmin=1., fmax=10.) # doctest: +SKIP</span>

<span class="sd">    .. plot::</span>

<span class="sd">        import numpy as np</span>
<span class="sd">        from obspy.signal.tf_misfit import plot_tf_gofs</span>
<span class="sd">        tmax = 6.</span>
<span class="sd">        dt = 0.01</span>
<span class="sd">        npts = int(tmax / dt + 1)</span>
<span class="sd">        t = np.linspace(0., tmax, npts)</span>
<span class="sd">        A1 = 4.</span>
<span class="sd">        t1 = 2.</span>
<span class="sd">        f1 = 2.</span>
<span class="sd">        phi1 = 0.</span>
<span class="sd">        phase_shift = 0.1</span>
<span class="sd">        H1 = (np.sign(t - t1) + 1)/ 2</span>
<span class="sd">        st1 = (A1 * (t - t1) * np.exp(-2*(t - t1)) *</span>
<span class="sd">              np.cos(2. * np.pi * f1 * (t - t1) + phi1 * np.pi) * H1)</span>
<span class="sd">        # Reference signal</span>
<span class="sd">        st2 = st1.copy()</span>
<span class="sd">        # Distorted signal:</span>
<span class="sd">        st1 = st1 * 3.</span>
<span class="sd">        plot_tf_gofs(st1, st2, dt=dt, fmin=1., fmax=10.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">NullFormatter</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">npts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span> <span class="o">+</span> <span class="n">t0</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span> <span class="n">nf</span><span class="p">)</span>

    <span class="c1"># compute time frequency misfits</span>
    <span class="n">_tfeg</span> <span class="o">=</span> <span class="n">tfeg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">_teg</span> <span class="o">=</span> <span class="n">teg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">_feg</span> <span class="o">=</span> <span class="n">feg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">_eg</span> <span class="o">=</span> <span class="n">eg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
             <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">_tfpg</span> <span class="o">=</span> <span class="n">tfpg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span>
                 <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">_tpg</span> <span class="o">=</span> <span class="n">tpg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">_fpg</span> <span class="o">=</span> <span class="n">fpg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
               <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
    <span class="n">_pg</span> <span class="o">=</span> <span class="n">pg</span><span class="p">(</span><span class="n">st1</span><span class="p">,</span> <span class="n">st2</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="n">dt</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="n">nf</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="n">w0</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span>
             <span class="n">st2_isref</span><span class="o">=</span><span class="n">st2_isref</span><span class="p">,</span> <span class="n">a</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_tfeg</span> <span class="o">=</span> <span class="n">_tfeg</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">_teg</span> <span class="o">=</span> <span class="n">_teg</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">_feg</span> <span class="o">=</span> <span class="n">_feg</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">))</span>
        <span class="n">_eg</span> <span class="o">=</span> <span class="n">_eg</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">_tfpg</span> <span class="o">=</span> <span class="n">_tfpg</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">_tpg</span> <span class="o">=</span> <span class="n">_tpg</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">_fpg</span> <span class="o">=</span> <span class="n">_fpg</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">))</span>
        <span class="n">_pg</span> <span class="o">=</span> <span class="n">_pg</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">st1</span> <span class="o">=</span> <span class="n">st1</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">st2</span> <span class="o">=</span> <span class="n">st2</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
        <span class="n">ntr</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ntr</span> <span class="o">=</span> <span class="n">st1</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ntr</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

        <span class="c1"># plot signals</span>
        <span class="n">ax_sig</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_1</span><span class="p">])</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">st1</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">st2</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># plot TEG</span>
        <span class="n">ax_teg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_1</span> <span class="o">+</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_2</span><span class="p">])</span>
        <span class="n">ax_teg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">_teg</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># plot TFEG</span>
        <span class="n">ax_tfeg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span>
                                <span class="n">h_3</span><span class="p">])</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span>
                           <span class="n">_tfeg</span><span class="p">[</span><span class="n">itr</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">img_tfeg</span> <span class="o">=</span> <span class="n">ax_tfeg</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_tfeg</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">img_tfeg</span><span class="o">.</span><span class="n">set_rasterized</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax_tfeg</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">ax_tfeg</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

        <span class="c1"># plot FEG</span>
        <span class="n">ax_feg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">,</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">h_3</span><span class="p">])</span>
        <span class="n">ax_feg</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">_feg</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">f</span><span class="p">,</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax_feg</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

        <span class="c1"># plot TPG</span>
        <span class="n">ax_tpg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_2</span><span class="p">])</span>
        <span class="n">ax_tpg</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">_tpg</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

        <span class="c1"># plot TFPG</span>
        <span class="n">ax_tfpg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_2</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_3</span><span class="p">])</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f</span><span class="p">)</span>
        <span class="n">img_tfpg</span> <span class="o">=</span> <span class="n">ax_tfpg</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_tfpg</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">img_tfpg</span><span class="o">.</span><span class="n">set_rasterized</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax_tfpg</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">ax_tfpg</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># add colorbars</span>
        <span class="n">ax_cb_tfpg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span> <span class="o">+</span> <span class="n">w_2</span> <span class="o">+</span> <span class="n">d_cb</span> <span class="o">+</span> <span class="n">w_cb</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span>
                                   <span class="n">w_cb</span><span class="p">,</span> <span class="n">h_2</span> <span class="o">+</span> <span class="n">h_3</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img_tfpg</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">ax_cb_tfpg</span><span class="p">)</span>

        <span class="c1"># plot FPG</span>
        <span class="n">ax_fpg</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_2</span><span class="p">,</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">h_3</span><span class="p">])</span>
        <span class="n">ax_fpg</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">_fpg</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">f</span><span class="p">,</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">ax_fpg</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

        <span class="c1"># set limits</span>
        <span class="n">ylim_sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">st1</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">st2</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">*</span> <span class="mf">1.1</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="n">ylim_sig</span><span class="p">,</span> <span class="n">ylim_sig</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">ylim</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">ylim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_teg</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tpg</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_feg</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_fpg</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span> <span class="o">*</span> <span class="mf">1.1</span>

        <span class="n">ax_teg</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
        <span class="n">ax_feg</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
        <span class="n">ax_tpg</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>
        <span class="n">ax_fpg</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">ylim</span><span class="p">)</span>

        <span class="n">ax_sig</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax_teg</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax_tpg</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">clim</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">clim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tfeg</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_tfpg</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>

        <span class="n">img_tfpg</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">clim</span><span class="p">)</span>
        <span class="n">img_tfeg</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">clim</span><span class="p">)</span>

        <span class="c1"># add text box for EG + PG</span>
        <span class="n">textstr</span> <span class="o">=</span> <span class="s1">&#39;EG = </span><span class="si">%2.2f</span><span class="se">\n</span><span class="s1">PG = </span><span class="si">%2.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_eg</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">_pg</span><span class="p">[</span><span class="n">itr</span><span class="p">])</span>
        <span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">textstr</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_sig</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>

        <span class="n">ax_tpg</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">ax_feg</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
        <span class="n">ax_fpg</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

        <span class="c1"># add text boxes</span>
        <span class="n">props</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax_tfeg</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;TFEG&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_tfeg</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                     <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_tfpg</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;TFPG&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_tfpg</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                     <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                     <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_teg</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s1">&#39;TEG&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_teg</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_tpg</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="s1">&#39;TPG&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_tpg</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_feg</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;FEG&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_feg</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>
        <span class="n">ax_fpg</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="s1">&#39;FPG&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax_fpg</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span>
                    <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span>
                    <span class="n">bbox</span><span class="o">=</span><span class="n">props</span><span class="p">)</span>

        <span class="c1"># remove axis labels</span>
        <span class="n">ax_tfpg</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_tfeg</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_teg</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_tfpg</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_tfeg</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>

        <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ntr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">figs</span></div>


<div class="viewcode-block" id="plot_tfr"><a class="viewcode-back" href="../../../packages/autogen/obspy.signal.tf_misfit.plot_tfr.html#obspy.signal.tf_misfit.plot_tfr">[docs]</a><span class="k">def</span> <span class="nf">plot_tfr</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">t0</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">fmin</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">fmax</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span> <span class="n">nf</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">w0</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
             <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">h_1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">h_2</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">w_1</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">w_2</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">w_cb</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
             <span class="n">d_cb</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">plot_args</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">],</span> <span class="n">clim</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span>
             <span class="n">cmap</span><span class="o">=</span><span class="n">obspy_sequential</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;absolute&#39;</span><span class="p">,</span> <span class="n">fft_zero_pad_fac</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot time frequency representation, spectrum and time series of the signal.</span>

<span class="sd">    :param st: signal, type numpy.ndarray with shape (number of components,</span>
<span class="sd">        number of time samples) or (number of timesamples, ) for single</span>
<span class="sd">        component data</span>
<span class="sd">    :param dt: time step between two samples in st</span>
<span class="sd">    :param t0: starting time for plotting</span>
<span class="sd">    :param fmin: minimal frequency to be analyzed</span>
<span class="sd">    :param fmax: maximal frequency to be analyzed</span>
<span class="sd">    :param nf: number of frequencies (will be chosen with logarithmic spacing)</span>
<span class="sd">    :param w0: parameter for the wavelet, tradeoff between time and frequency</span>
<span class="sd">        resolution</span>
<span class="sd">    :param left: plot distance from the left of the figure</span>
<span class="sd">    :param bottom: plot distance from the bottom of the figure</span>
<span class="sd">    :param h_1: height of the signal axis</span>
<span class="sd">    :param h_2: height of the TFR/spectrum axis</span>
<span class="sd">    :param w_1: width of the spectrum axis</span>
<span class="sd">    :param w_2: width of the TFR/signal axes</span>
<span class="sd">    :param w_cb: width of the colorbar axes</span>
<span class="sd">    :param d_cb: distance of the colorbar axes to the other axes</span>
<span class="sd">    :param show: show figure or return</span>
<span class="sd">    :param plot_args: list of plot arguments passed to the signal and spectrum</span>
<span class="sd">        plots</span>
<span class="sd">    :param clim: limits of the colorbars</span>
<span class="sd">    :param cmap: colormap for TFEM/TFPM, either a string or</span>
<span class="sd">        matplotlib.cm.Colormap instance</span>
<span class="sd">    :param mode: &#39;absolute&#39; for absolute value of TFR, &#39;power&#39; for ``|TFR|^2``</span>
<span class="sd">    :param fft_zero_pad_fac: integer, if &gt; 0, the signal is zero padded to</span>
<span class="sd">        ``nfft = next_pow_2(len(st)) * fft_zero_pad_fac`` to get smoother</span>
<span class="sd">        spectrum in the low frequencies (has no effect on the TFR and might</span>
<span class="sd">        make demeaning/tapering necessary to avoid artifacts)</span>

<span class="sd">    :return: If show is False, returns a matplotlib.pyplot.figure object</span>
<span class="sd">        (single component data) or a list of figure objects (multi component</span>
<span class="sd">        data)</span>

<span class="sd">    .. rubric:: Example</span>

<span class="sd">    &gt;&gt;&gt; from obspy import read</span>
<span class="sd">    &gt;&gt;&gt; tr = read(&quot;https://examples.obspy.org/a02i.2008.240.mseed&quot;)[0]</span>
<span class="sd">    &gt;&gt;&gt; plot_tfr(tr.data, dt=tr.stats.delta, fmin=.01, # doctest: +SKIP</span>
<span class="sd">    ...         fmax=50., w0=8., nf=64, fft_zero_pad_fac=4)</span>

<span class="sd">    .. plot::</span>

<span class="sd">        from obspy.signal.tf_misfit import plot_tfr</span>
<span class="sd">        from obspy import read</span>
<span class="sd">        tr = read(&quot;https://examples.obspy.org/a02i.2008.240.mseed&quot;)[0]</span>
<span class="sd">        plot_tfr(tr.data, dt=tr.stats.delta, fmin=.01,</span>
<span class="sd">                fmax=50., w0=8., nf=64, fft_zero_pad_fac=4)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="n">NullFormatter</span>
    <span class="n">npts</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">tmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">npts</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">tmax</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span> <span class="o">+</span> <span class="n">t0</span>

    <span class="k">if</span> <span class="n">fft_zero_pad_fac</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">nfft</span> <span class="o">=</span> <span class="n">npts</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">nfft</span> <span class="o">=</span> <span class="n">util</span><span class="o">.</span><span class="n">next_pow_2</span><span class="p">(</span><span class="n">npts</span><span class="p">)</span> <span class="o">*</span> <span class="n">fft_zero_pad_fac</span>

    <span class="n">f_lin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">dt</span><span class="p">,</span> <span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nf</span><span class="p">,</span> <span class="n">npts</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">_w</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
        <span class="n">ntr</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="n">spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">spec</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">nfft</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="n">st</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">npts</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nf</span><span class="p">,</span> <span class="n">npts</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">st</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nfft</span> <span class="o">//</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">complex</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">_w</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">cwt</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dt</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">,</span> <span class="n">nf</span><span class="p">)</span>
            <span class="n">spec</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">rfft</span><span class="p">(</span><span class="n">st</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">n</span><span class="o">=</span><span class="n">nfft</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

        <span class="n">ntr</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;absolute&#39;</span><span class="p">:</span>
        <span class="n">_tfr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_w</span><span class="p">)</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;power&#39;</span><span class="p">:</span>
        <span class="n">_tfr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">_w</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">spec</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;mode &quot;&#39;</span> <span class="o">+</span> <span class="n">mode</span> <span class="o">+</span> <span class="s1">&#39;&quot; not defined!&#39;</span><span class="p">)</span>

    <span class="n">figs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">itr</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ntr</span><span class="p">):</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

        <span class="c1"># plot signals</span>
        <span class="n">ax_sig</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_1</span><span class="p">])</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">st</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

        <span class="c1"># plot TFR</span>
        <span class="n">ax_tfr</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_1</span><span class="p">,</span> <span class="n">w_2</span><span class="p">,</span> <span class="n">h_2</span><span class="p">])</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
            <span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">fmax</span><span class="p">),</span>
                           <span class="n">_tfr</span><span class="p">[</span><span class="n">itr</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">img_tfr</span> <span class="o">=</span> <span class="n">ax_tfr</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_tfr</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
        <span class="n">img_tfr</span><span class="o">.</span><span class="n">set_rasterized</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax_tfr</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s2">&quot;log&quot;</span><span class="p">)</span>
        <span class="n">ax_tfr</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>
        <span class="n">ax_tfr</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># plot spectrum</span>
        <span class="n">ax_spec</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span> <span class="n">h_1</span><span class="p">,</span> <span class="n">w_1</span><span class="p">,</span> <span class="n">h_2</span><span class="p">])</span>
        <span class="n">ax_spec</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">spec</span><span class="p">[</span><span class="n">itr</span><span class="p">],</span> <span class="n">f_lin</span><span class="p">,</span> <span class="n">plot_args</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># add colorbars</span>
        <span class="n">ax_cb_tfr</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span> <span class="o">+</span> <span class="n">w_1</span> <span class="o">+</span> <span class="n">w_2</span> <span class="o">+</span> <span class="n">d_cb</span> <span class="o">+</span> <span class="n">w_cb</span><span class="p">,</span> <span class="n">bottom</span> <span class="o">+</span>
                                  <span class="n">h_1</span><span class="p">,</span> <span class="n">w_cb</span><span class="p">,</span> <span class="n">h_2</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">img_tfr</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">ax_cb_tfr</span><span class="p">)</span>

        <span class="c1"># set limits</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="n">st</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">)</span>
        <span class="n">ax_sig</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">xlim</span> <span class="o">=</span> <span class="n">spec</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span>

        <span class="n">ax_spec</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">,</span> <span class="mf">0.</span><span class="p">)</span>
        <span class="n">ax_spec</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">fmin</span><span class="p">,</span> <span class="n">fmax</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">clim</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">clim</span> <span class="o">=</span> <span class="n">_tfr</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="n">img_tfr</span><span class="o">.</span><span class="n">set_clim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">clim</span><span class="p">)</span>

        <span class="n">ax_sig</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
        <span class="n">ax_spec</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>

        <span class="c1"># remove axis labels</span>
        <span class="n">ax_tfr</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>
        <span class="n">ax_tfr</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">NullFormatter</span><span class="p">())</span>

        <span class="n">figs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">ntr</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">figs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">figs</span></div>


<span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;plotTfGofs&#39; has been renamed to &#39;plot_tf_gofs&#39;. &quot;</span>
            <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
<span class="k">def</span> <span class="nf">plotTfGofs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">plot_tf_gofs</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;plotTfMisfits&#39; has been renamed to &#39;plot_tf_misfits&#39;. &quot;</span>
            <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
<span class="k">def</span> <span class="nf">plotTfMisfits</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">plot_tf_misfits</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;plotTfr&#39; has been renamed to &#39;plot_tfr&#39;. &quot;</span>
            <span class="s2">&quot;Use that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
<span class="k">def</span> <span class="nf">plotTfr</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">plot_tfr</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">exclude_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a> &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, lafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Kufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaim, Sbastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clment</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Khler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>