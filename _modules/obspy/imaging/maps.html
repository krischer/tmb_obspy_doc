<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.imaging.maps &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.imaging.maps</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for basemap related plotting in ObsPy.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org)</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA @UnusedWildImport</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="k">import</span> <span class="n">native_str</span>

<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.cm</span> <span class="k">import</span> <span class="n">ScalarMappable</span>
<span class="kn">from</span> <span class="nn">matplotlib.colorbar</span> <span class="k">import</span> <span class="n">Colorbar</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="k">import</span> <span class="n">Normalize</span>
<span class="kn">from</span> <span class="nn">matplotlib.dates</span> <span class="k">import</span> <span class="n">AutoDateFormatter</span><span class="p">,</span> <span class="n">AutoDateLocator</span><span class="p">,</span> <span class="n">date2num</span>
<span class="kn">import</span> <span class="nn">matplotlib.patheffects</span> <span class="k">as</span> <span class="nn">PathEffects</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="k">import</span> <span class="p">(</span><span class="n">FormatStrFormatter</span><span class="p">,</span> <span class="n">Formatter</span><span class="p">,</span> <span class="n">FuncFormatter</span><span class="p">,</span>
                               <span class="n">MaxNLocator</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">obspy</span> <span class="k">import</span> <span class="n">UTCDateTime</span>
<span class="kn">from</span> <span class="nn">obspy.core.util.base</span> <span class="k">import</span> <span class="n">get_basemap_version</span><span class="p">,</span> <span class="n">get_cartopy_version</span>
<span class="kn">from</span> <span class="nn">obspy.geodetics.base</span> <span class="k">import</span> <span class="n">mean_longitude</span>

<span class="n">BASEMAP_VERSION</span> <span class="o">=</span> <span class="n">get_basemap_version</span><span class="p">()</span>
<span class="k">if</span> <span class="n">BASEMAP_VERSION</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="k">import</span> <span class="n">Basemap</span>
    <span class="n">HAS_BASEMAP</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">BASEMAP_VERSION</span> <span class="o">&lt;</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;All basemap version &lt; 1.0.4 contain a serious bug &quot;</span>
                      <span class="s2">&quot;when rendering countries and continents. ObsPy will &quot;</span>
                      <span class="s2">&quot;still work but the maps might be wrong. Please update &quot;</span>
                      <span class="s2">&quot;your basemap installation.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">HAS_BASEMAP</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">CARTOPY_VERSION</span> <span class="o">=</span> <span class="n">get_cartopy_version</span><span class="p">()</span>
<span class="k">if</span> <span class="n">CARTOPY_VERSION</span> <span class="ow">and</span> <span class="n">CARTOPY_VERSION</span> <span class="o">&gt;=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">]:</span>
    <span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
    <span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
    <span class="n">HAS_CARTOPY</span> <span class="o">=</span> <span class="kc">True</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">HAS_CARTOPY</span> <span class="o">=</span> <span class="kc">False</span>


<span class="k">if</span> <span class="ow">not</span> <span class="n">HAS_BASEMAP</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">HAS_CARTOPY</span><span class="p">:</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Neither basemap nor cartopy installed, map plots will not work.&quot;</span><span class="p">)</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>


<span class="n">_BASEMAP_RESOLUTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;110m&#39;</span><span class="p">:</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span>
    <span class="s1">&#39;50m&#39;</span><span class="p">:</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span>
    <span class="s1">&#39;10m&#39;</span><span class="p">:</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span>
    <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;l&#39;</span><span class="p">,</span>
    <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="s1">&#39;i&#39;</span><span class="p">,</span>
    <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="s1">&#39;h&#39;</span><span class="p">,</span>
    <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s1">&#39;f&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">_CARTOPY_RESOLUTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;c&#39;</span><span class="p">:</span> <span class="s1">&#39;110m&#39;</span><span class="p">,</span>
    <span class="s1">&#39;l&#39;</span><span class="p">:</span> <span class="s1">&#39;110m&#39;</span><span class="p">,</span>
    <span class="s1">&#39;i&#39;</span><span class="p">:</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
    <span class="s1">&#39;h&#39;</span><span class="p">:</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
    <span class="s1">&#39;f&#39;</span><span class="p">:</span> <span class="s1">&#39;10m&#39;</span><span class="p">,</span>
    <span class="s1">&#39;110m&#39;</span><span class="p">:</span> <span class="s1">&#39;110m&#39;</span><span class="p">,</span>
    <span class="s1">&#39;50m&#39;</span><span class="p">:</span> <span class="s1">&#39;50m&#39;</span><span class="p">,</span>
    <span class="s1">&#39;10m&#39;</span><span class="p">:</span> <span class="s1">&#39;10m&#39;</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">if</span> <span class="n">HAS_CARTOPY</span><span class="p">:</span>
    <span class="n">_CARTOPY_FEATURES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;110m&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="p">,</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="p">,</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="p">),</span>
    <span class="p">}</span>


<div class="viewcode-block" id="plot_basemap"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.maps.plot_basemap.html#obspy.imaging.maps.plot_basemap">[docs]</a><span class="k">def</span> <span class="nf">plot_basemap</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
                 <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">continent_fill_color</span><span class="o">=</span><span class="s1">&#39;0.8&#39;</span><span class="p">,</span>
                 <span class="n">water_fill_color</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_ticklabel_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a basemap plot with a data point scatter plot.</span>

<span class="sd">    :type lons: list/tuple of floats</span>
<span class="sd">    :param lons: Longitudes of the data points.</span>
<span class="sd">    :type lats: list/tuple of floats</span>
<span class="sd">    :param lats: Latitudes of the data points.</span>
<span class="sd">    :type size: float or list/tuple of floats</span>
<span class="sd">    :param size: Size of the individual points in the scatter plot.</span>
<span class="sd">    :type color: list/tuple of floats (or objects that can be</span>
<span class="sd">        converted to floats, like e.g.</span>
<span class="sd">        :class:`~obspy.core.utcdatetime.UTCDateTime`)</span>
<span class="sd">    :param color: Color information of the individual data points to be</span>
<span class="sd">        used in the specified color map (e.g. origin depths,</span>
<span class="sd">        origin times).</span>
<span class="sd">    :type labels: list/tuple of str</span>
<span class="sd">    :param labels: Annotations for the individual data points.</span>
<span class="sd">    :type projection: str, optional</span>
<span class="sd">    :param projection: The map projection.</span>
<span class="sd">        Currently supported are:</span>

<span class="sd">            * ``&quot;global&quot;`` (Will plot the whole world.)</span>
<span class="sd">            * ``&quot;ortho&quot;`` (Will center around the mean lat/long.)</span>
<span class="sd">            * ``&quot;local&quot;`` (Will plot around local events)</span>

<span class="sd">        Defaults to &quot;global&quot;.</span>
<span class="sd">    :type resolution: str, optional</span>
<span class="sd">    :param resolution: Resolution of the boundary database to use. Will be</span>
<span class="sd">        based directly to the basemap module. Possible values are:</span>

<span class="sd">            * ``&quot;c&quot;`` (crude)</span>
<span class="sd">            * ``&quot;l&quot;`` (low)</span>
<span class="sd">            * ``&quot;i&quot;`` (intermediate)</span>
<span class="sd">            * ``&quot;h&quot;`` (high)</span>
<span class="sd">            * ``&quot;f&quot;`` (full)</span>

<span class="sd">        Defaults to ``&quot;l&quot;``. For compatibility, you may also specify any of the</span>
<span class="sd">        Cartopy resolutions defined in :func:`plot_cartopy`.</span>
<span class="sd">    :type continent_fill_color: Valid matplotlib color, optional</span>
<span class="sd">    :param continent_fill_color:  Color of the continents. Defaults to</span>
<span class="sd">        ``&quot;0.9&quot;`` which is a light gray.</span>
<span class="sd">    :type water_fill_color: Valid matplotlib color, optional</span>
<span class="sd">    :param water_fill_color: Color of all water bodies.</span>
<span class="sd">        Defaults to ``&quot;white&quot;``.</span>
<span class="sd">    :type colormap: str, any matplotlib colormap, optional</span>
<span class="sd">    :param colormap: The colormap for color-coding the events as provided</span>
<span class="sd">        in `color` kwarg.</span>
<span class="sd">        The event with the smallest `color` property will have the</span>
<span class="sd">        color of one end of the colormap and the event with the highest</span>
<span class="sd">        `color` property the color of the other end with all other events</span>
<span class="sd">        in between.</span>
<span class="sd">        Defaults to None which will use the default matplotlib colormap.</span>
<span class="sd">    :type colorbar: bool, optional</span>
<span class="sd">    :param colorbar: When left `None`, a colorbar is plotted if more than one</span>
<span class="sd">        object is plotted. Using `True`/`False` the colorbar can be forced</span>
<span class="sd">        on/off.</span>
<span class="sd">    :type title: str</span>
<span class="sd">    :param title: Title above plot.</span>
<span class="sd">    :type colorbar_ticklabel_format: str or function or</span>
<span class="sd">        subclass of :class:`matplotlib.ticker.Formatter`</span>
<span class="sd">    :param colorbar_ticklabel_format: Format string or Formatter used to format</span>
<span class="sd">        colorbar tick labels.</span>
<span class="sd">    :type show: bool</span>
<span class="sd">    :param show: Whether to show the figure after plotting or not. Can be used</span>
<span class="sd">        to do further customization of the plot before showing it.</span>
<span class="sd">    :type fig: :class:`matplotlib.figure.Figure`</span>
<span class="sd">    :param fig: Figure instance to reuse, returned from a previous</span>
<span class="sd">        :func:`plot_basemap` call. If a previous basemap plot is reused, any</span>
<span class="sd">        kwargs regarding the basemap plot setup will be ignored (i.e.</span>
<span class="sd">        `projection`, `resolution`, `continent_fill_color`,</span>
<span class="sd">        `water_fill_color`). Note that multiple plots using colorbars likely</span>
<span class="sd">        are problematic, but e.g. one station plot (without colorbar) and one</span>
<span class="sd">        event plot (with colorbar) together should work well.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">min_color</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">max_color</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">UTCDateTime</span><span class="p">))</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">color</span><span class="p">]):</span>
        <span class="n">datetimeplot</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="p">))</span> <span class="ow">and</span>
             <span class="n">date2num</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span> <span class="ow">or</span>
             <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">color</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">datetimeplot</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">scal_map</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">min_color</span><span class="p">,</span> <span class="n">max_color</span><span class="p">),</span>
                              <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
    <span class="n">scal_map</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="c1"># The colorbar should only be plotted if more then one event is</span>
    <span class="c1"># present.</span>
    <span class="k">if</span> <span class="n">colorbar</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">fig</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
            <span class="n">ax_x0</span><span class="p">,</span> <span class="n">ax_width</span> <span class="o">=</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.80</span>
        <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s2">&quot;global&quot;</span><span class="p">:</span>
            <span class="n">ax_x0</span><span class="p">,</span> <span class="n">ax_width</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.98</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax_x0</span><span class="p">,</span> <span class="n">ax_width</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.90</span>

        <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
            <span class="n">map_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ax_x0</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="n">ax_width</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">])</span>
            <span class="n">cm_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ax_x0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">ax_width</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax_y0</span><span class="p">,</span> <span class="n">ax_height</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.85</span>
            <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
                <span class="n">ax_y0</span> <span class="o">+=</span> <span class="mf">0.05</span>
                <span class="n">ax_height</span> <span class="o">-=</span> <span class="mf">0.05</span>
            <span class="n">map_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ax_x0</span><span class="p">,</span> <span class="n">ax_y0</span><span class="p">,</span> <span class="n">ax_width</span><span class="p">,</span> <span class="n">ax_height</span><span class="p">])</span>
        <span class="n">bmap</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">error_message_suffix</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;. Please provide a figure object from a previous call to the &quot;</span>
            <span class="s2">&quot;.plot() method of e.g. an Inventory or Catalog object.&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">map_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">error_message_suffix</span><span class="p">]</span> <span class="o">+</span>
                           <span class="nb">list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
            <span class="k">raise</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">bmap</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">bmap</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">e</span><span class="o">.</span><span class="n">args</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">([</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">error_message_suffix</span><span class="p">]</span> <span class="o">+</span>
                           <span class="nb">list</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
            <span class="k">raise</span>

    <span class="n">scatter</span> <span class="o">=</span> <span class="n">_plot_basemap_into_axes</span><span class="p">(</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">map_ax</span><span class="p">,</span> <span class="n">lons</span><span class="o">=</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">bmap</span><span class="o">=</span><span class="n">bmap</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">projection</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
        <span class="n">continent_fill_color</span><span class="o">=</span><span class="n">continent_fill_color</span><span class="p">,</span>
        <span class="n">water_fill_color</span><span class="o">=</span><span class="n">water_fill_color</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span>
        <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">adjust_aspect_to_colorbar</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">colorbar</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">colorbar_ticklabel_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">FuncFormatter</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">,</span> <span class="n">Formatter</span><span class="p">):</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">colorbar_ticklabel_format</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">datetimeplot</span><span class="p">:</span>
                <span class="n">locator</span> <span class="o">=</span> <span class="n">AutoDateLocator</span><span class="p">()</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">AutoDateFormatter</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
                <span class="c1"># Compat with old matplotlib versions.</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">formatter</span><span class="p">,</span> <span class="s2">&quot;scaled&quot;</span><span class="p">):</span>
                    <span class="n">formatter</span><span class="o">.</span><span class="n">scaled</span><span class="p">[</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">24.</span> <span class="o">*</span> <span class="mf">60.</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;%H:%M:%S&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">locator</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># normal case: axes for colorbar was set up in this routine</span>
        <span class="k">if</span> <span class="s2">&quot;cm_ax&quot;</span> <span class="ow">in</span> <span class="nb">locals</span><span class="p">():</span>
            <span class="n">cb_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cax&quot;</span><span class="p">:</span> <span class="n">cm_ax</span><span class="p">}</span>
        <span class="c1"># unusual case: reusing a plot that has no colorbar set up previously</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cb_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;ax&quot;</span><span class="p">:</span> <span class="n">map_ax</span><span class="p">}</span>

        <span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span>
            <span class="n">mappable</span><span class="o">=</span><span class="n">scatter</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
            <span class="n">ticks</span><span class="o">=</span><span class="n">locator</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="n">formatter</span><span class="p">,</span> <span class="o">**</span><span class="n">cb_kwargs</span><span class="p">)</span>
        <span class="c1"># Compat with old matplotlib versions.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="s2">&quot;update_ticks&quot;</span><span class="p">):</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="_plot_basemap_into_axes"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.maps._plot_basemap_into_axes.html#obspy.imaging.maps._plot_basemap_into_axes">[docs]</a><span class="k">def</span> <span class="nf">_plot_basemap_into_axes</span><span class="p">(</span>
        <span class="n">ax</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">bmap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;l&#39;</span><span class="p">,</span> <span class="n">continent_fill_color</span><span class="o">=</span><span class="s1">&#39;0.8&#39;</span><span class="p">,</span>
        <span class="n">water_fill_color</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">adjust_aspect_to_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a (or adds to existing) basemap plot with a data point scatter</span>
<span class="sd">    plot in given axes.</span>

<span class="sd">    See :func:`plot_basemap` for details on most args/kwargs.</span>

<span class="sd">    :type ax: :class:`matplotlib.axes.Axes`</span>
<span class="sd">    :param ax: Existing matplotlib axes instance, optionally with previous</span>
<span class="sd">        basemap plot (see `bmap` kwarg).</span>
<span class="sd">    :type bmap: :class:`mpl_toolkits.basemap.Basemap`</span>
<span class="sd">    :param bmap: Basemap instance in provided matplotlib Axes `ax` to reuse. If</span>
<span class="sd">        specified, any kwargs regarding the basemap plot setup will be ignored</span>
<span class="sd">        (i.e.  `projection`, `resolution`, `continent_fill_color`,</span>
<span class="sd">        `water_fill_color`).</span>
<span class="sd">    :rtype: :class:`matplotlib.collections.PathCollection`</span>
<span class="sd">    :returns: Matplotlib path collection (e.g. to reuse for colorbars).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">min_color</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">max_color</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="n">scal_map</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">min_color</span><span class="p">,</span> <span class="n">max_color</span><span class="p">),</span>
                              <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
    <span class="n">scal_map</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">figure</span>
    <span class="k">if</span> <span class="n">bmap</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>

        <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
            <span class="n">bmap</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;moll&#39;</span><span class="p">,</span> <span class="n">lon_0</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lons</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span>
                           <span class="n">resolution</span><span class="o">=</span><span class="n">_BASEMAP_RESOLUTIONS</span><span class="p">[</span><span class="n">resolution</span><span class="p">],</span>
                           <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s1">&#39;ortho&#39;</span><span class="p">:</span>
            <span class="n">bmap</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;ortho&#39;</span><span class="p">,</span>
                           <span class="n">resolution</span><span class="o">=</span><span class="n">_BASEMAP_RESOLUTIONS</span><span class="p">[</span><span class="n">resolution</span><span class="p">],</span>
                           <span class="n">area_thresh</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lats</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span>
                           <span class="n">lon_0</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">mean_longitude</span><span class="p">(</span><span class="n">lons</span><span class="p">),</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">150</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="p">:</span>
                <span class="n">max_lons</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>
                <span class="n">min_lons</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">max_lons</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
                <span class="n">min_lons</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
            <span class="n">lat_0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
            <span class="n">lon_0</span> <span class="o">=</span> <span class="n">max_lons</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="n">min_lons</span> <span class="o">/</span> <span class="mf">2.</span>
            <span class="k">if</span> <span class="n">lon_0</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
                <span class="n">lon_0</span> <span class="o">-=</span> <span class="mi">360</span>
            <span class="n">deg2m_lat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">6371</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="mi">360</span>
            <span class="n">deg2m_lon</span> <span class="o">=</span> <span class="n">deg2m_lat</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_0</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span> <span class="o">*</span> <span class="n">deg2m_lat</span>
                <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_lons</span> <span class="o">-</span> <span class="n">min_lons</span><span class="p">)</span> <span class="o">*</span> <span class="n">deg2m_lon</span>
                <span class="n">margin</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span>
                <span class="n">height</span> <span class="o">+=</span> <span class="n">margin</span>
                <span class="n">width</span> <span class="o">+=</span> <span class="n">margin</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">height</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">deg2m_lat</span>
                <span class="n">width</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">deg2m_lon</span>
            <span class="c1"># do intelligent aspect calculation for local projection</span>
            <span class="c1"># adjust to figure dimensions</span>
            <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>
            <span class="n">ax_bbox</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">aspect</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">ax_bbox</span><span class="o">.</span><span class="n">width</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">ax_bbox</span><span class="o">.</span><span class="n">height</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">adjust_aspect_to_colorbar</span><span class="p">:</span>
                <span class="n">aspect</span> <span class="o">*=</span> <span class="mf">1.2</span>
            <span class="k">if</span> <span class="n">width</span> <span class="o">/</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="n">aspect</span><span class="p">:</span>
                <span class="n">width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">*</span> <span class="n">aspect</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">height</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">aspect</span>

            <span class="n">bmap</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s1">&#39;aea&#39;</span><span class="p">,</span>
                           <span class="n">resolution</span><span class="o">=</span><span class="n">_BASEMAP_RESOLUTIONS</span><span class="p">[</span><span class="n">resolution</span><span class="p">],</span>
                           <span class="n">area_thresh</span><span class="o">=</span><span class="mf">1000.0</span><span class="p">,</span> <span class="n">lat_0</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">lat_0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                           <span class="n">lon_0</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">lon_0</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span>
                           <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
            <span class="c1"># not most elegant way to calculate some round lats/lons</span>

            <span class="k">def</span> <span class="nf">linspace2</span><span class="p">(</span><span class="n">val1</span><span class="p">,</span> <span class="n">val2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
                <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">                returns around n &#39;nice&#39; values between val1 and val2</span>
<span class="sd">                &quot;&quot;&quot;</span>
                <span class="n">dval</span> <span class="o">=</span> <span class="n">val2</span> <span class="o">-</span> <span class="n">val1</span>
                <span class="n">round_pos</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1.</span> <span class="o">*</span> <span class="n">dval</span> <span class="o">/</span> <span class="n">n</span><span class="p">)))</span>
                <span class="c1"># Fake negative rounding as not supported by future as of now.</span>
                <span class="k">if</span> <span class="n">round_pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">factor</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">round_pos</span><span class="p">))</span>
                    <span class="n">delta</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">dval</span> <span class="o">/</span> <span class="n">n</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span> <span class="o">*</span> <span class="n">factor</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">delta</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">dval</span> <span class="o">/</span> <span class="n">n</span><span class="p">,</span> <span class="n">round_pos</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="n">new_val1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">val1</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta</span>
                <span class="n">new_val2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">val2</span> <span class="o">/</span> <span class="n">delta</span><span class="p">)</span> <span class="o">*</span> <span class="n">delta</span>
                <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_val2</span> <span class="o">-</span> <span class="n">new_val1</span><span class="p">)</span> <span class="o">/</span> <span class="n">delta</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">new_val1</span><span class="p">,</span> <span class="n">new_val2</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

            <span class="n">n_1</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">height</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">n_2</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span> <span class="o">*</span> <span class="mi">8</span><span class="p">))</span>
            <span class="n">parallels</span> <span class="o">=</span> <span class="n">linspace2</span><span class="p">(</span><span class="n">lat_0</span> <span class="o">-</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">deg2m_lat</span><span class="p">,</span>
                                  <span class="n">lat_0</span> <span class="o">+</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">deg2m_lat</span><span class="p">,</span> <span class="n">n_1</span><span class="p">)</span>

            <span class="c1"># Old basemap versions have problems with non-integer parallels.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">bmap</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">parallels</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">parallels</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">parallels</span><span class="p">))))</span>
                <span class="n">bmap</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">parallels</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>

            <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">150</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="p">:</span>
                <span class="n">lon_0</span> <span class="o">%=</span> <span class="mi">360</span>
            <span class="n">meridians</span> <span class="o">=</span> <span class="n">linspace2</span><span class="p">(</span><span class="n">lon_0</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">deg2m_lon</span><span class="p">,</span>
                                  <span class="n">lon_0</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">deg2m_lon</span><span class="p">,</span> <span class="n">n_2</span><span class="p">)</span>
            <span class="n">meridians</span><span class="p">[</span><span class="n">meridians</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">360</span>
            <span class="n">bmap</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">meridians</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Projection &#39;</span><span class="si">%s</span><span class="s2">&#39; not supported.&quot;</span> <span class="o">%</span> <span class="n">projection</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># draw coast lines, country boundaries, fill continents.</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_bgcolor</span><span class="p">(</span><span class="n">water_fill_color</span><span class="p">)</span>
        <span class="n">bmap</span><span class="o">.</span><span class="n">drawcoastlines</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.4&quot;</span><span class="p">)</span>
        <span class="n">bmap</span><span class="o">.</span><span class="n">drawcountries</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.75&quot;</span><span class="p">)</span>
        <span class="n">bmap</span><span class="o">.</span><span class="n">fillcontinents</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">continent_fill_color</span><span class="p">,</span>
                            <span class="n">lake_color</span><span class="o">=</span><span class="n">water_fill_color</span><span class="p">)</span>
        <span class="c1"># draw the edge of the bmap projection region (the projection limb)</span>
        <span class="n">bmap</span><span class="o">.</span><span class="n">drawmapboundary</span><span class="p">(</span><span class="n">fill_color</span><span class="o">=</span><span class="n">water_fill_color</span><span class="p">)</span>
        <span class="c1"># draw lat/lon grid lines every 30 degrees.</span>
        <span class="n">bmap</span><span class="o">.</span><span class="n">drawmeridians</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
        <span class="n">bmap</span><span class="o">.</span><span class="n">drawparallels</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">bmap</span> <span class="o">=</span> <span class="n">bmap</span>

    <span class="c1"># compute the native bmap projection coordinates for events.</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">bmap</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">)</span>
    <span class="c1"># plot labels</span>
    <span class="k">if</span> <span class="n">labels</span><span class="p">:</span>
        <span class="k">if</span> <span class="mi">100</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">xpt</span><span class="p">,</span> <span class="n">ypt</span><span class="p">,</span> <span class="n">_colorpt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
                <span class="c1"># Check if the point can actually be seen with the current bmap</span>
                <span class="c1"># projection. The bmap object will set the coordinates to very</span>
                <span class="c1"># large values if it cannot project a point.</span>
                <span class="k">if</span> <span class="n">xpt</span> <span class="o">&gt;</span> <span class="mf">1e25</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xpt</span><span class="p">,</span> <span class="n">ypt</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;heavy&quot;</span><span class="p">,</span>
                        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                        <span class="n">path_effects</span><span class="o">=</span><span class="p">[</span>
                            <span class="n">PathEffects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                   <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)])</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">labels</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;heavy&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
                    <span class="n">path_effects</span><span class="o">=</span><span class="p">[</span>
                        <span class="n">PathEffects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                               <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)])</span>

    <span class="c1"># scatter plot is removing valid x/y points with invalid color value,</span>
    <span class="c1"># so we plot those points separately.</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">nan_points</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="c1"># `color&#39; was not a list of values, but a list of colors.</span>
        <span class="k">pass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">nan_points</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
            <span class="n">x_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="n">nan_points</span><span class="p">]</span>
            <span class="n">y_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="n">nan_points</span><span class="p">]</span>
            <span class="n">size_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">size</span><span class="p">)[</span><span class="n">nan_points</span><span class="p">]</span>
            <span class="n">bmap</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_</span><span class="p">,</span> <span class="n">y_</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size_</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;0.3&quot;</span><span class="p">,</span>
                         <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">scatter</span> <span class="o">=</span> <span class="n">bmap</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                           <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">scatter</span></div>


<div class="viewcode-block" id="plot_cartopy"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.maps.plot_cartopy.html#obspy.imaging.maps.plot_cartopy">[docs]</a><span class="k">def</span> <span class="nf">plot_cartopy</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;global&#39;</span><span class="p">,</span>
                 <span class="n">resolution</span><span class="o">=</span><span class="s1">&#39;110m&#39;</span><span class="p">,</span> <span class="n">continent_fill_color</span><span class="o">=</span><span class="s1">&#39;0.8&#39;</span><span class="p">,</span>
                 <span class="n">water_fill_color</span><span class="o">=</span><span class="s1">&#39;1.0&#39;</span><span class="p">,</span> <span class="n">colormap</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colorbar_ticklabel_format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">show</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">proj_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates a Cartopy plot with a data point scatter plot.</span>

<span class="sd">    :type lons: list/tuple of floats</span>
<span class="sd">    :param lons: Longitudes of the data points.</span>
<span class="sd">    :type lats: list/tuple of floats</span>
<span class="sd">    :param lats: Latitudes of the data points.</span>
<span class="sd">    :type size: float or list/tuple of floats</span>
<span class="sd">    :param size: Size of the individual points in the scatter plot.</span>
<span class="sd">    :type color: list/tuple of floats (or objects that can be</span>
<span class="sd">        converted to floats, like e.g.</span>
<span class="sd">        :class:`~obspy.core.utcdatetime.UTCDateTime`)</span>
<span class="sd">    :param color: Color information of the individual data points to be</span>
<span class="sd">        used in the specified color map (e.g. origin depths,</span>
<span class="sd">        origin times).</span>
<span class="sd">    :type labels: list/tuple of str</span>
<span class="sd">    :param labels: Annotations for the individual data points.</span>
<span class="sd">    :type projection: str, optional</span>
<span class="sd">    :param projection: The map projection.</span>
<span class="sd">        Currently supported are:</span>

<span class="sd">            * ``&quot;global&quot;`` (Will plot the whole world using</span>
<span class="sd">              :class:`~cartopy.crs.Mollweide`.)</span>
<span class="sd">            * ``&quot;ortho&quot;`` (Will center around the mean lat/long using</span>
<span class="sd">              :class:`~cartopy.crs.Orthographic`.)</span>
<span class="sd">            * ``&quot;local&quot;`` (Will plot around local events using</span>
<span class="sd">              :class:`~cartopy.crs.AlbersEqualArea`.)</span>
<span class="sd">            * Any other Cartopy :class:`~cartopy.crs.Projection`. An instance</span>
<span class="sd">              of this class will be created using the supplied ``proj_kwargs``.</span>

<span class="sd">        Defaults to &quot;global&quot;</span>
<span class="sd">    :type resolution: str, optional</span>
<span class="sd">    :param resolution: Resolution of the boundary database to use. Will be</span>
<span class="sd">        passed directly to the Cartopy module. Possible values are:</span>

<span class="sd">            * ``&quot;110m&quot;``</span>
<span class="sd">            * ``&quot;50m&quot;``</span>
<span class="sd">            * ``&quot;10m&quot;``</span>

<span class="sd">        Defaults to ``&quot;110m&quot;``. For compatibility, you may also specify any of</span>
<span class="sd">        the Basemap resolutions defined in :func:`plot_basemap`.</span>
<span class="sd">    :type continent_fill_color: Valid matplotlib color, optional</span>
<span class="sd">    :param continent_fill_color:  Color of the continents. Defaults to</span>
<span class="sd">        ``&quot;0.9&quot;`` which is a light gray.</span>
<span class="sd">    :type water_fill_color: Valid matplotlib color, optional</span>
<span class="sd">    :param water_fill_color: Color of all water bodies.</span>
<span class="sd">        Defaults to ``&quot;white&quot;``.</span>
<span class="sd">    :type colormap: str, any matplotlib colormap, optional</span>
<span class="sd">    :param colormap: The colormap for color-coding the events as provided</span>
<span class="sd">        in `color` kwarg.</span>
<span class="sd">        The event with the smallest `color` property will have the</span>
<span class="sd">        color of one end of the colormap and the event with the highest</span>
<span class="sd">        `color` property the color of the other end with all other events</span>
<span class="sd">        in between.</span>
<span class="sd">        Defaults to None which will use the default matplotlib colormap.</span>
<span class="sd">    :type colorbar: bool, optional</span>
<span class="sd">    :param colorbar: When left `None`, a colorbar is plotted if more than one</span>
<span class="sd">        object is plotted. Using `True`/`False` the colorbar can be forced</span>
<span class="sd">        on/off.</span>
<span class="sd">    :type title: str</span>
<span class="sd">    :param title: Title above plot.</span>
<span class="sd">    :type colorbar_ticklabel_format: str or function or</span>
<span class="sd">        subclass of :class:`matplotlib.ticker.Formatter`</span>
<span class="sd">    :param colorbar_ticklabel_format: Format string or Formatter used to format</span>
<span class="sd">        colorbar tick labels.</span>
<span class="sd">    :type show: bool</span>
<span class="sd">    :param show: Whether to show the figure after plotting or not. Can be used</span>
<span class="sd">        to do further customization of the plot before showing it.</span>
<span class="sd">    :type proj_kwargs: dict</span>
<span class="sd">    :param proj_kwargs: Keyword arguments to pass to the Cartopy</span>
<span class="sd">        :class:`~cartopy.ccrs.Projection`. In this dictionary, you may specify</span>
<span class="sd">        ``central_longitude=&#39;auto&#39;`` or ``central_latitude=&#39;auto&#39;`` to have</span>
<span class="sd">        this function calculate the latitude or longitude as it would for other</span>
<span class="sd">        projections. Some arguments may be ignored if you choose one of the</span>
<span class="sd">        built-in ``projection`` choices.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">min_color</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
    <span class="n">max_color</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">UTCDateTime</span><span class="p">)):</span>
        <span class="n">datetimeplot</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">color</span> <span class="o">=</span> <span class="p">[</span><span class="n">date2num</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="s1">&#39;datetime&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">))</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">color</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">datetimeplot</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">scal_map</span> <span class="o">=</span> <span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">min_color</span><span class="p">,</span> <span class="n">max_color</span><span class="p">),</span>
                              <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">)</span>
    <span class="n">scal_map</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>

    <span class="c1"># The colorbar should only be plotted if more then one event is</span>
    <span class="c1"># present.</span>
    <span class="k">if</span> <span class="n">colorbar</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">show_colorbar</span> <span class="o">=</span> <span class="n">colorbar</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="s2">&quot;__len__&quot;</span><span class="p">)</span> <span class="ow">and</span> \
                <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">color</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
            <span class="n">show_colorbar</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">show_colorbar</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
        <span class="n">ax_x0</span><span class="p">,</span> <span class="n">ax_width</span> <span class="o">=</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.80</span>
    <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s2">&quot;global&quot;</span><span class="p">:</span>
        <span class="n">ax_x0</span><span class="p">,</span> <span class="n">ax_width</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.98</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax_x0</span><span class="p">,</span> <span class="n">ax_width</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.90</span>

    <span class="n">proj_kwargs</span> <span class="o">=</span> <span class="n">proj_kwargs</span> <span class="ow">or</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s1">&#39;global&#39;</span><span class="p">:</span>
        <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Mollweide</span><span class="p">(</span><span class="o">**</span><span class="n">proj_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s1">&#39;ortho&#39;</span><span class="p">:</span>
        <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span>
        <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_longitude</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">Orthographic</span><span class="p">(</span><span class="o">**</span><span class="n">proj_kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">projection</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">min</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">150</span> <span class="ow">and</span> <span class="nb">max</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">150</span><span class="p">:</span>
            <span class="n">max_lons</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>
            <span class="n">min_lons</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">max_lons</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
            <span class="n">min_lons</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
        <span class="n">lat_0</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="nb">min</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="n">lon_0</span> <span class="o">=</span> <span class="n">max_lons</span> <span class="o">/</span> <span class="mf">2.</span> <span class="o">+</span> <span class="n">min_lons</span> <span class="o">/</span> <span class="mf">2.</span>
        <span class="k">if</span> <span class="n">lon_0</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
            <span class="n">lon_0</span> <span class="o">-=</span> <span class="mi">360</span>
        <span class="n">deg2m_lat</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">6371</span> <span class="o">*</span> <span class="mi">1000</span> <span class="o">/</span> <span class="mi">360</span>
        <span class="n">deg2m_lon</span> <span class="o">=</span> <span class="n">deg2m_lat</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat_0</span> <span class="o">/</span> <span class="mi">180</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span> <span class="o">-</span> <span class="nb">min</span><span class="p">(</span><span class="n">lats</span><span class="p">))</span> <span class="o">*</span> <span class="n">deg2m_lat</span>
            <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">max_lons</span> <span class="o">-</span> <span class="n">min_lons</span><span class="p">)</span> <span class="o">*</span> <span class="n">deg2m_lon</span>
            <span class="n">margin</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">width</span> <span class="o">+</span> <span class="n">height</span><span class="p">)</span>
            <span class="n">height</span> <span class="o">+=</span> <span class="n">margin</span>
            <span class="n">width</span> <span class="o">+=</span> <span class="n">margin</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">deg2m_lat</span>
            <span class="n">width</span> <span class="o">=</span> <span class="mf">5.0</span> <span class="o">*</span> <span class="n">deg2m_lon</span>
        <span class="c1"># Do intelligent aspect calculation for local projection</span>
        <span class="c1"># adjust to figure dimensions</span>
        <span class="n">w</span><span class="p">,</span> <span class="n">h</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">get_size_inches</span><span class="p">()</span>
        <span class="n">aspect</span> <span class="o">=</span> <span class="n">w</span> <span class="o">/</span> <span class="n">h</span>
        <span class="k">if</span> <span class="n">show_colorbar</span><span class="p">:</span>
            <span class="n">aspect</span> <span class="o">*=</span> <span class="mf">1.2</span>
        <span class="k">if</span> <span class="n">width</span> <span class="o">/</span> <span class="n">height</span> <span class="o">&lt;</span> <span class="n">aspect</span><span class="p">:</span>
            <span class="n">width</span> <span class="o">=</span> <span class="n">height</span> <span class="o">*</span> <span class="n">aspect</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="n">aspect</span>

        <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lat_0</span>
        <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">lon_0</span>
        <span class="n">proj</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">AlbersEqualArea</span><span class="p">(</span><span class="o">**</span><span class="n">proj_kwargs</span><span class="p">)</span>

    <span class="c1"># User-supplied projection.</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">projection</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;central_longitude&#39;</span> <span class="ow">in</span> <span class="n">proj_kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_longitude&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
                <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mean_longitude</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;central_latitude&#39;</span> <span class="ow">in</span> <span class="n">proj_kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_latitude&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
                <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;central_latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;pole_longitude&#39;</span> <span class="ow">in</span> <span class="n">proj_kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;pole_longitude&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
                <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;pole_longitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;pole_latitude&#39;</span> <span class="ow">in</span> <span class="n">proj_kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;pole_latitude&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;auto&#39;</span><span class="p">:</span>
                <span class="n">proj_kwargs</span><span class="p">[</span><span class="s1">&#39;pole_latitude&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">lats</span><span class="p">)</span>

        <span class="n">proj</span> <span class="o">=</span> <span class="n">projection</span><span class="p">(</span><span class="o">**</span><span class="n">proj_kwargs</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Projection &#39;</span><span class="si">%s</span><span class="s2">&#39; not supported.&quot;</span> <span class="o">%</span> <span class="n">projection</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">show_colorbar</span><span class="p">:</span>
        <span class="n">map_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ax_x0</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">,</span> <span class="n">ax_width</span><span class="p">,</span> <span class="mf">0.77</span><span class="p">],</span> <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>
        <span class="n">cm_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ax_x0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">ax_width</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">map_ax</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax_y0</span><span class="p">,</span> <span class="n">ax_height</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.85</span>
        <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s2">&quot;local&quot;</span><span class="p">:</span>
            <span class="n">ax_y0</span> <span class="o">+=</span> <span class="mf">0.05</span>
            <span class="n">ax_height</span> <span class="o">-=</span> <span class="mf">0.05</span>
        <span class="n">map_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">ax_x0</span><span class="p">,</span> <span class="n">ax_y0</span><span class="p">,</span> <span class="n">ax_width</span><span class="p">,</span> <span class="n">ax_height</span><span class="p">],</span>
                              <span class="n">projection</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="n">x0</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">proj</span><span class="o">.</span><span class="n">transform_point</span><span class="p">(</span><span class="n">lon_0</span><span class="p">,</span> <span class="n">lat_0</span><span class="p">,</span> <span class="n">proj</span><span class="o">.</span><span class="n">as_geodetic</span><span class="p">())</span>
        <span class="n">map_ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">map_ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">y0</span> <span class="o">-</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">map_ax</span><span class="o">.</span><span class="n">set_global</span><span class="p">()</span>

    <span class="c1"># Pick features at specified resolution.</span>
    <span class="n">resolution</span> <span class="o">=</span> <span class="n">_CARTOPY_RESOLUTIONS</span><span class="p">[</span><span class="n">resolution</span><span class="p">]</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">borders</span><span class="p">,</span> <span class="n">land</span><span class="p">,</span> <span class="n">ocean</span> <span class="o">=</span> <span class="n">_CARTOPY_FEATURES</span><span class="p">[</span><span class="n">resolution</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">borders</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
                                               <span class="n">cfeature</span><span class="o">.</span><span class="n">BORDERS</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                                               <span class="n">resolution</span><span class="p">,</span>
                                               <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                                               <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">land</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
                                            <span class="n">cfeature</span><span class="o">.</span><span class="n">LAND</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span>
                                            <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;face&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">ocean</span> <span class="o">=</span> <span class="n">cfeature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="o">.</span><span class="n">category</span><span class="p">,</span>
                                             <span class="n">cfeature</span><span class="o">.</span><span class="n">OCEAN</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">resolution</span><span class="p">,</span>
                                             <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;face&#39;</span><span class="p">,</span>
                                             <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
        <span class="n">_CARTOPY_FEATURES</span><span class="p">[</span><span class="n">resolution</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">borders</span><span class="p">,</span> <span class="n">land</span><span class="p">,</span> <span class="n">ocean</span><span class="p">)</span>

    <span class="c1"># Draw coast lines, country boundaries, fill continents.</span>
    <span class="n">map_ax</span><span class="o">.</span><span class="n">set_axis_bgcolor</span><span class="p">(</span><span class="n">water_fill_color</span><span class="p">)</span>
    <span class="n">map_ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">ocean</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">water_fill_color</span><span class="p">)</span>
    <span class="n">map_ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">land</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">continent_fill_color</span><span class="p">)</span>
    <span class="n">map_ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">borders</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;0.75&#39;</span><span class="p">)</span>
    <span class="n">map_ax</span><span class="o">.</span><span class="n">coastlines</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;0.4&#39;</span><span class="p">)</span>

    <span class="c1"># Draw grid lines - TODO: draw_labels=True doesn&#39;t work yet.</span>
    <span class="k">if</span> <span class="n">projection</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="n">map_ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Draw lat/lon grid lines every 30 degrees.</span>
        <span class="n">map_ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">xlocs</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">181</span><span class="p">,</span> <span class="mi">30</span><span class="p">),</span> <span class="n">ylocs</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">30</span><span class="p">))</span>

    <span class="c1"># Plot labels</span>
    <span class="k">if</span> <span class="n">labels</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">lons</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">map_ax</span><span class="o">.</span><span class="n">hold_limits</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">xpt</span><span class="p">,</span> <span class="n">ypt</span><span class="p">,</span> <span class="n">_colorpt</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">color</span><span class="p">):</span>
                <span class="n">map_ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">xpt</span><span class="p">,</span> <span class="n">ypt</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s2">&quot;heavy&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
                            <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Geodetic</span><span class="p">(),</span>
                            <span class="n">path_effects</span><span class="o">=</span><span class="p">[</span>
                                <span class="n">PathEffects</span><span class="o">.</span><span class="n">withStroke</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
                                                       <span class="n">foreground</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">)])</span>

    <span class="n">scatter</span> <span class="o">=</span> <span class="n">map_ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">lons</span><span class="p">,</span> <span class="n">lats</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                             <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
                             <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">Geodetic</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>

    <span class="c1"># Only show the colorbar for more than one event.</span>
    <span class="k">if</span> <span class="n">show_colorbar</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">colorbar_ticklabel_format</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">FormatStrFormatter</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">FuncFormatter</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">colorbar_ticklabel_format</span><span class="p">,</span> <span class="n">Formatter</span><span class="p">):</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">colorbar_ticklabel_format</span>
            <span class="n">locator</span> <span class="o">=</span> <span class="n">MaxNLocator</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">datetimeplot</span><span class="p">:</span>
                <span class="n">locator</span> <span class="o">=</span> <span class="n">AutoDateLocator</span><span class="p">()</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="n">AutoDateFormatter</span><span class="p">(</span><span class="n">locator</span><span class="p">)</span>
                <span class="c1"># Compat with old matplotlib versions.</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">formatter</span><span class="p">,</span> <span class="s2">&quot;scaled&quot;</span><span class="p">):</span>
                    <span class="n">formatter</span><span class="o">.</span><span class="n">scaled</span><span class="p">[</span><span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">24.</span> <span class="o">*</span> <span class="mf">60.</span><span class="p">)]</span> <span class="o">=</span> <span class="s1">&#39;%H:%M:%S&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">locator</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">formatter</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">Colorbar</span><span class="p">(</span><span class="n">cm_ax</span><span class="p">,</span> <span class="n">scatter</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">colormap</span><span class="p">,</span>
                      <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
                      <span class="n">ticks</span><span class="o">=</span><span class="n">locator</span><span class="p">,</span>
                      <span class="nb">format</span><span class="o">=</span><span class="n">formatter</span><span class="p">)</span>
        <span class="c1"># Compat with old matplotlib versions.</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">cb</span><span class="p">,</span> <span class="s2">&quot;update_ticks&quot;</span><span class="p">):</span>
            <span class="n">cb</span><span class="o">.</span><span class="n">update_ticks</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">show</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_map"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.maps.plot_map.html#obspy.imaging.maps.plot_map">[docs]</a><span class="k">def</span> <span class="nf">plot_map</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Creates a map plot with a data point scatter plot.</span>

<span class="sd">    :type method: str</span>
<span class="sd">    :param method: Method to use for plotting. Possible values are:</span>

<span class="sd">        * ``&#39;basemap&#39;`` to use the Basemap library. For other arguments, see</span>
<span class="sd">          the :func:`plot_basemap` function.</span>
<span class="sd">        * ``&#39;cartopy&#39;`` to use the Cartopy library. For other arguments, see</span>
<span class="sd">          the :func:`plot_cartopy` function.</span>
<span class="sd">        * ``None`` to use either the Basemap or Cartopy library, whichever is</span>
<span class="sd">          available.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">HAS_BASEMAP</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">plot_basemap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">HAS_CARTOPY</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">plot_cartopy</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;Neither Basemap nor Cartopy could be imported.&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;basemap&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">HAS_BASEMAP</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;Basemap cannot be imported but was explicitly &#39;</span>
                              <span class="s1">&#39;requested.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_basemap</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s1">&#39;cartopy&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">HAS_CARTOPY</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ImportError</span><span class="p">(</span><span class="s1">&#39;Cartopy cannot be imported but was explicitly &#39;</span>
                              <span class="s1">&#39;requested.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_cartopy</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The method argument must be either &#39;basemap&#39; or &quot;</span>
                         <span class="s2">&quot;&#39;cartopy&#39;, not &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="p">))</span></div>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a> &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, lafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Kufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaim, Sbastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clment</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Khler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>