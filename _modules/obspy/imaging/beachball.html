<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.imaging.beachball &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.imaging.beachball</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># -------------------------------------------------------------------</span>
<span class="c1"># Filename: beachball.py</span>
<span class="c1">#  Purpose: Draws a beach ball diagram of an earthquake focal mechanism.</span>
<span class="c1">#   Author: Robert Barsch</span>
<span class="c1">#    Email: barsch@egu.eu</span>
<span class="c1">#</span>
<span class="c1"># Copyright (C) 2008-2012 Robert Barsch</span>
<span class="c1"># ---------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Draws a beachball diagram of an earthquake focal mechanism</span>

<span class="sd">Most source code provided here are adopted from</span>

<span class="sd">1. MatLab script `bb.m`_ written by Andy Michael, Chen Ji and Oliver Boyd.</span>
<span class="sd">2. ps_meca program from the `Generic Mapping Tools (GMT)`_.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org)</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>

<span class="sd">.. _`Generic Mapping Tools (GMT)`: https://gmt.soest.hawaii.edu</span>
<span class="sd">.. _`bb.m`: http://www.ceri.memphis.edu/people/olboyd/Software/Software.html</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA @UnusedWildImport</span>

<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">path</span> <span class="k">as</span> <span class="n">mplpath</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="k">import</span> <span class="n">collections</span><span class="p">,</span> <span class="n">patches</span><span class="p">,</span> <span class="n">transforms</span>
<span class="kn">from</span> <span class="nn">decorator</span> <span class="k">import</span> <span class="n">decorator</span>

<span class="kn">from</span> <span class="nn">obspy.core.util.decorator</span> <span class="k">import</span> <span class="n">deprecated</span>
<span class="kn">from</span> <span class="nn">obspy.core.util.deprecation_helpers</span> <span class="k">import</span> \
    <span class="n">DynamicAttributeImportRerouteModule</span>


<span class="n">D2R</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">180</span>
<span class="n">R2D</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">EPSILON</span> <span class="o">=</span> <span class="mf">0.00001</span>


<div class="viewcode-block" id="mopad_fallback"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.mopad_fallback.html#obspy.imaging.beachball.mopad_fallback">[docs]</a><span class="nd">@decorator</span>
<span class="k">def</span> <span class="nf">mopad_fallback</span><span class="p">(</span><span class="n">func</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Encountered an exception while plotting the beachball. &quot;</span> \
              <span class="s2">&quot;Falling back to the mopad wrapper which is slower but more &quot;</span> \
              <span class="s2">&quot;stable.&quot;</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Could be done with the inspect module but this wrapper is only a</span>
        <span class="c1"># single purpose wrapper and thus KISS.</span>
        <span class="n">arguments</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;fm&quot;</span><span class="p">,</span> <span class="s2">&quot;linewidth&quot;</span><span class="p">,</span> <span class="s2">&quot;facecolor&quot;</span><span class="p">,</span> <span class="s2">&quot;bgcolor&quot;</span><span class="p">,</span> <span class="s2">&quot;edgecolor&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="s2">&quot;xy&quot;</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">,</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="s2">&quot;nofill&quot;</span><span class="p">,</span> <span class="s2">&quot;zorder&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;axes&quot;</span><span class="p">]</span>

        <span class="n">final_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">_i</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
            <span class="n">final_kwargs</span><span class="p">[</span><span class="n">arguments</span><span class="p">[</span><span class="n">_i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">arg</span>

        <span class="n">final_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="kn">from</span> <span class="nn">.mopad_wrapper</span> <span class="k">import</span> <span class="n">beach</span> <span class="k">as</span> <span class="n">_mopad_beach</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">_mopad_beach</span><span class="p">(</span><span class="o">**</span><span class="n">final_kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span></div>


<span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;Function &#39;Beach&#39; has been renamed to &#39;beach&#39;. Use that instead.&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">Beach</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># noqa</span>
    <span class="k">return</span> <span class="n">beach</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<div class="viewcode-block" id="beach"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.beach.html#obspy.imaging.beachball.beach">[docs]</a><span class="nd">@mopad_fallback</span>
<span class="k">def</span> <span class="nf">beach</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
          <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">nofill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
          <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a beach ball as a collection which can be connected to an</span>
<span class="sd">    current matplotlib axes instance (ax.add_collection).</span>

<span class="sd">    S1, D1, and R1, the strike, dip and rake of one of the focal planes, can</span>
<span class="sd">    be vectors of multiple focal mechanisms.</span>

<span class="sd">    :param fm: Focal mechanism that is either number of mechanisms (NM) by 3</span>
<span class="sd">        (strike, dip, and rake) or NM x 6 (M11, M22, M33, M12, M13, M23 - the</span>
<span class="sd">        six independent components of the moment tensor, where the coordinate</span>
<span class="sd">        system is 1,2,3 = Up,South,East which equals r,theta,phi -</span>
<span class="sd">        Harvard/Global CMT convention). The relation to Aki and Richards</span>
<span class="sd">        x,y,z equals North,East,Down convention is as follows: Mrr=Mzz,</span>
<span class="sd">        Mtt=Mxx, Mpp=Myy, Mrt=Mxz, Mrp=-Myz, Mtp=-Mxy.</span>
<span class="sd">        The strike is of the first plane, clockwise relative to north.</span>
<span class="sd">        The dip is of the first plane, defined clockwise and perpendicular to</span>
<span class="sd">        strike, relative to horizontal such that 0 is horizontal and 90 is</span>
<span class="sd">        vertical. The rake is of the first focal plane solution. 90 moves the</span>
<span class="sd">        hanging wall up-dip (thrust), 0 moves it in the strike direction</span>
<span class="sd">        (left-lateral), -90 moves it down-dip (normal), and 180 moves it</span>
<span class="sd">        opposite to strike (right-lateral).</span>
<span class="sd">    :param facecolor: Color to use for quadrants of tension; can be a string,</span>
<span class="sd">        e.g. ``&#39;r&#39;``, ``&#39;b&#39;`` or three component color vector, [R G B].</span>
<span class="sd">        Defaults to ``&#39;b&#39;`` (blue).</span>
<span class="sd">    :param bgcolor: The background color. Defaults to ``&#39;w&#39;`` (white).</span>
<span class="sd">    :param edgecolor: Color of the edges. Defaults to ``&#39;k&#39;`` (black).</span>
<span class="sd">    :param alpha: The alpha level of the beach ball. Defaults to ``1.0``</span>
<span class="sd">        (opaque).</span>
<span class="sd">    :param xy: Origin position of the beach ball as tuple. Defaults to</span>
<span class="sd">        ``(0, 0)``.</span>
<span class="sd">    :type width: int or tuple</span>
<span class="sd">    :param width: Symbol size of beach ball, or tuple for elliptically</span>
<span class="sd">        shaped patches. Defaults to size ``200``.</span>
<span class="sd">    :param size: Controls the number of interpolation points for the</span>
<span class="sd">        curves. Minimum is automatically set to ``100``.</span>
<span class="sd">    :param nofill: Do not fill the beach ball, but only plot the planes.</span>
<span class="sd">    :param zorder: Set zorder. Artists with lower zorder values are drawn</span>
<span class="sd">        first.</span>
<span class="sd">    :type axes: :class:`matplotlib.axes.Axes`</span>
<span class="sd">    :param axes: Used to make beach balls circular on non-scaled axes. Also</span>
<span class="sd">        maintains the aspect ratio when resizing the figure. Will not add</span>
<span class="sd">        the returned collection to the axes instance.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check if one or two widths are specified (Circle or Ellipse)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="n">mt</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">np1</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">MomentTensor</span><span class="p">):</span>
        <span class="n">mt</span> <span class="o">=</span> <span class="n">fm</span>
        <span class="n">np1</span> <span class="o">=</span> <span class="n">mt2plane</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">NodalPlane</span><span class="p">):</span>
        <span class="n">np1</span> <span class="o">=</span> <span class="n">fm</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
        <span class="n">mt</span> <span class="o">=</span> <span class="n">MomentTensor</span><span class="p">(</span><span class="n">fm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fm</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">fm</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">fm</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">fm</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">np1</span> <span class="o">=</span> <span class="n">mt2plane</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
        <span class="n">np1</span> <span class="o">=</span> <span class="n">NodalPlane</span><span class="p">(</span><span class="n">fm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fm</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Wrong input value for &#39;fm&#39;.&quot;</span><span class="p">)</span>

    <span class="c1"># Only at least size 100, i.e. 100 points in the matrix are allowed</span>
    <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">:</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">100</span>

    <span class="c1"># Return as collection</span>
    <span class="n">plot_dc_used</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">if</span> <span class="n">mt</span><span class="p">:</span>
        <span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span> <span class="o">=</span> <span class="n">mt2axes</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">N</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPSILON</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">T</span><span class="o">.</span><span class="n">val</span> <span class="o">+</span> <span class="n">P</span><span class="o">.</span><span class="n">val</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPSILON</span><span class="p">:</span>
            <span class="n">colors</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot_dc</span><span class="p">(</span><span class="n">np1</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">colors</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot_mt</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span>
                                <span class="n">plot_zerotrace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>
            <span class="n">plot_dc_used</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">colors</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">plot_dc</span><span class="p">(</span><span class="n">np1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">)</span>

    <span class="n">col</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">PatchCollection</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">match_original</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">nofill</span><span class="p">:</span>
        <span class="n">col</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Replace color dummies &#39;b&#39; and &#39;w&#39; by face and bgcolor</span>
        <span class="n">fc</span> <span class="o">=</span> <span class="p">[</span><span class="n">facecolor</span> <span class="k">if</span> <span class="n">c</span> <span class="o">==</span> <span class="s1">&#39;b&#39;</span> <span class="k">else</span> <span class="n">bgcolor</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">colors</span><span class="p">]</span>
        <span class="n">col</span><span class="o">.</span><span class="n">set_facecolors</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>

    <span class="c1"># Use the given axes to maintain the aspect ratio of beachballs on figure</span>
    <span class="c1"># resize.</span>
    <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># This is what holds the aspect ratio (but breaks the positioning)</span>
        <span class="n">col</span><span class="o">.</span><span class="n">set_transform</span><span class="p">(</span><span class="n">transforms</span><span class="o">.</span><span class="n">IdentityTransform</span><span class="p">())</span>
        <span class="c1"># Next is a dirty hack to fix the positioning:</span>
        <span class="c1"># 1. Need to bring the all patches to the origin (0, 0).</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">col</span><span class="o">.</span><span class="n">_paths</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">vertices</span> <span class="o">-=</span> <span class="n">xy</span>
        <span class="c1"># 2. Then use the offset property of the collection to position the</span>
        <span class="c1">#    patches</span>
        <span class="n">col</span><span class="o">.</span><span class="n">set_offsets</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>
        <span class="n">col</span><span class="o">.</span><span class="n">_transOffset</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">transData</span>

    <span class="n">col</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="n">edgecolor</span><span class="p">)</span>
    <span class="n">col</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">col</span><span class="o">.</span><span class="n">set_linewidth</span><span class="p">(</span><span class="n">linewidth</span><span class="p">)</span>
    <span class="n">col</span><span class="o">.</span><span class="n">set_zorder</span><span class="p">(</span><span class="n">zorder</span><span class="p">)</span>

    <span class="c1"># warn about color blending bug, see #1464</span>
    <span class="k">if</span> <span class="n">alpha</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">nofill</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">plot_dc_used</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;There is a known bug when plotting semi-transparent patches &quot;</span>
               <span class="s2">&quot;for non-DC sources, which leads to blending of pressure and &quot;</span>
               <span class="s2">&quot;tension color, see issue #1464.&quot;</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">col</span></div>


<span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;Function &#39;Beachball&#39; has been renamed to &#39;beachball&#39;. Use that &quot;</span>
            <span class="s2">&quot;instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
<span class="k">def</span> <span class="nf">Beachball</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">beachball</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>


<div class="viewcode-block" id="beachball"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.beachball.html#obspy.imaging.beachball.beachball">[docs]</a><span class="k">def</span> <span class="nf">beachball</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
              <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">nofill</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draws a beach ball diagram of an earthquake focal mechanism.</span>

<span class="sd">    S1, D1, and R1, the strike, dip and rake of one of the focal planes, can</span>
<span class="sd">    be vectors of multiple focal mechanisms.</span>

<span class="sd">    :param fm: Focal mechanism that is either number of mechanisms (NM) by 3</span>
<span class="sd">        (strike, dip, and rake) or NM x 6 (M11, M22, M33, M12, M13, M23 - the</span>
<span class="sd">        six independent components of the moment tensor, where the coordinate</span>
<span class="sd">        system is 1,2,3 = Up,South,East which equals r,theta,phi). The strike</span>
<span class="sd">        is of the first plane, clockwise relative to north.</span>
<span class="sd">        The dip is of the first plane, defined clockwise and perpendicular to</span>
<span class="sd">        strike, relative to horizontal such that 0 is horizontal and 90 is</span>
<span class="sd">        vertical. The rake is of the first focal plane solution. 90 moves the</span>
<span class="sd">        hanging wall up-dip (thrust), 0 moves it in the strike direction</span>
<span class="sd">        (left-lateral), -90 moves it down-dip (normal), and 180 moves it</span>
<span class="sd">        opposite to strike (right-lateral).</span>
<span class="sd">    :param facecolor: Color to use for quadrants of tension; can be a string,</span>
<span class="sd">        e.g. ``&#39;r&#39;``, ``&#39;b&#39;`` or three component color vector, [R G B].</span>
<span class="sd">        Defaults to ``&#39;b&#39;`` (blue).</span>
<span class="sd">    :param bgcolor: The background color. Defaults to ``&#39;w&#39;`` (white).</span>
<span class="sd">    :param edgecolor: Color of the edges. Defaults to ``&#39;k&#39;`` (black).</span>
<span class="sd">    :param alpha: The alpha level of the beach ball. Defaults to ``1.0``</span>
<span class="sd">        (opaque).</span>
<span class="sd">    :param xy: Origin position of the beach ball as tuple. Defaults to</span>
<span class="sd">        ``(0, 0)``.</span>
<span class="sd">    :type width: int</span>
<span class="sd">    :param width: Symbol size of beach ball. Defaults to ``200``.</span>
<span class="sd">    :param size: Controls the number of interpolation points for the</span>
<span class="sd">        curves. Minimum is automatically set to ``100``.</span>
<span class="sd">    :param nofill: Do not fill the beach ball, but only plot the planes.</span>
<span class="sd">    :param zorder: Set zorder. Artists with lower zorder values are drawn</span>
<span class="sd">        first.</span>
<span class="sd">    :param outfile: Output file string. Also used to automatically</span>
<span class="sd">        determine the output format. Supported file formats depend on your</span>
<span class="sd">        matplotlib backend. Most backends support png, pdf, ps, eps and</span>
<span class="sd">        svg. Defaults to ``None``.</span>
<span class="sd">    :param format: Format of the graph picture. If no format is given the</span>
<span class="sd">        outfile parameter will be used to try to automatically determine</span>
<span class="sd">        the output format. If no format is found it defaults to png output.</span>
<span class="sd">        If no outfile is specified but a format is, than a binary</span>
<span class="sd">        imagestring will be returned.</span>
<span class="sd">        Defaults to ``None``.</span>
<span class="sd">    :param fig: Give an existing figure instance to plot into. New Figure if</span>
<span class="sd">        set to ``None``.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
    <span class="n">plot_width</span> <span class="o">=</span> <span class="n">width</span> <span class="o">*</span> <span class="mf">0.95</span>

    <span class="c1"># plot the figure</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fig</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_figheight</span><span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_figwidth</span><span class="p">(</span><span class="n">width</span> <span class="o">//</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">)</span>

    <span class="c1"># hide axes + ticks</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axison</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="c1"># plot the collection</span>
    <span class="n">collection</span> <span class="o">=</span> <span class="n">beach</span><span class="p">(</span><span class="n">fm</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="n">facecolor</span><span class="p">,</span>
                       <span class="n">edgecolor</span><span class="o">=</span><span class="n">edgecolor</span><span class="p">,</span> <span class="n">bgcolor</span><span class="o">=</span><span class="n">bgcolor</span><span class="p">,</span>
                       <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">nofill</span><span class="o">=</span><span class="n">nofill</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="n">xy</span><span class="p">,</span>
                       <span class="n">width</span><span class="o">=</span><span class="n">plot_width</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="n">zorder</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">collection</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">autoscale_view</span><span class="p">(</span><span class="n">tight</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">scalex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">scaley</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># export</span>
    <span class="k">if</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">format</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">format</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">imgdata</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">imgdata</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">transparent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">imgdata</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">imgdata</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fig</span></div>


<div class="viewcode-block" id="plot_mt"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.plot_mt.html#obspy.imaging.beachball.plot_mt">[docs]</a><span class="k">def</span> <span class="nf">plot_mt</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">plot_zerotrace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># noqa</span>
            <span class="n">x0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses a principal axis T, N and P to draw a beach ball plot.</span>

<span class="sd">    :param ax: axis object of a matplotlib figure</span>
<span class="sd">    :param T: :class:`~PrincipalAxis`</span>
<span class="sd">    :param N: :class:`~PrincipalAxis`</span>
<span class="sd">    :param P: :class:`~PrincipalAxis`</span>

<span class="sd">    Adapted from ps_tensor / utilmeca.c / `Generic Mapping Tools (GMT)`_.</span>

<span class="sd">    .. _`Generic Mapping Tools (GMT)`: https://gmt.soest.hawaii.edu</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check if one or two widths are specified (Circle or Ellipse)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="n">collect</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">width</span><span class="p">]</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">big_iso</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">j2</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">j3</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">azi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">x2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">x3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">y3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">xp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
    <span class="n">yp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">800</span><span class="p">)</span>
    <span class="n">xp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>
    <span class="n">yp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">400</span><span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">strike</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">strike</span>
    <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">strike</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">dip</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">dip</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">dip</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">T</span><span class="o">.</span><span class="n">val</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">N</span><span class="o">.</span><span class="n">val</span>
    <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">val</span>

    <span class="n">vi</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">/</span> <span class="mf">3.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">vi</span>

    <span class="n">radius_size</span> <span class="o">=</span> <span class="n">size</span> <span class="o">*</span> <span class="mf">0.5</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">&lt;</span> <span class="n">EPSILON</span><span class="p">:</span>
        <span class="c1"># pure implosion-explosion</span>
        <span class="k">if</span> <span class="n">vi</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">cir</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cir</span><span class="p">)</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">vi</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
            <span class="n">cir</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cir</span><span class="p">)</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">colors</span><span class="p">,</span> <span class="n">collect</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]):</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">plot_zerotrace</span><span class="p">):</span>
        <span class="n">vi</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="n">f</span> <span class="o">=</span> <span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>
    <span class="n">iso</span> <span class="o">=</span> <span class="n">vi</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">d</span><span class="p">])</span>

    <span class="c1"># Cliff Frohlich, Seismological Research letters,</span>
    <span class="c1"># Vol 7, Number 1, January-February, 1996</span>
    <span class="c1"># Unless the isotropic parameter lies in the range</span>
    <span class="c1"># between -1 and 1 - f there will be no nodes whatsoever</span>

    <span class="k">if</span> <span class="n">iso</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">cir</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cir</span><span class="p">)</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">colors</span><span class="p">,</span> <span class="n">collect</span>
    <span class="k">elif</span> <span class="n">iso</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">cir</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cir</span><span class="p">)</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">colors</span><span class="p">,</span> <span class="n">collect</span>

    <span class="n">spd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">cpd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">spb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">cpb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">spm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">cpm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">sad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">cad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">sab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">cab</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">sam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>
    <span class="n">cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">):</span>
        <span class="n">fir</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">D2R</span>
        <span class="n">s2alphan</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">+</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">iso</span><span class="p">)</span> <span class="o">/</span> \
            <span class="nb">float</span><span class="p">(</span><span class="mf">3.</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="mf">2.</span> <span class="o">*</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">fir</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">s2alphan</span> <span class="o">&gt;</span> <span class="mf">1.</span><span class="p">:</span>
            <span class="n">big_iso</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alphan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">s2alphan</span><span class="p">))</span>
            <span class="n">sfi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">fir</span><span class="p">)</span>
            <span class="n">cfi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">fir</span><span class="p">)</span>
            <span class="n">san</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alphan</span><span class="p">)</span>
            <span class="n">can</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alphan</span><span class="p">)</span>

            <span class="n">xz</span> <span class="o">=</span> <span class="n">can</span> <span class="o">*</span> <span class="n">spd</span> <span class="o">+</span> <span class="n">san</span> <span class="o">*</span> <span class="n">sfi</span> <span class="o">*</span> <span class="n">spb</span> <span class="o">+</span> <span class="n">san</span> <span class="o">*</span> <span class="n">cfi</span> <span class="o">*</span> <span class="n">spm</span>
            <span class="n">xn</span> <span class="o">=</span> <span class="n">can</span> <span class="o">*</span> <span class="n">cpd</span> <span class="o">*</span> <span class="n">cad</span> <span class="o">+</span> <span class="n">san</span> <span class="o">*</span> <span class="n">sfi</span> <span class="o">*</span> <span class="n">cpb</span> <span class="o">*</span> <span class="n">cab</span> <span class="o">+</span> \
                <span class="n">san</span> <span class="o">*</span> <span class="n">cfi</span> <span class="o">*</span> <span class="n">cpm</span> <span class="o">*</span> <span class="n">cam</span>
            <span class="n">xe</span> <span class="o">=</span> <span class="n">can</span> <span class="o">*</span> <span class="n">cpd</span> <span class="o">*</span> <span class="n">sad</span> <span class="o">+</span> <span class="n">san</span> <span class="o">*</span> <span class="n">sfi</span> <span class="o">*</span> <span class="n">cpb</span> <span class="o">*</span> <span class="n">sab</span> <span class="o">+</span> \
                <span class="n">san</span> <span class="o">*</span> <span class="n">cfi</span> <span class="o">*</span> <span class="n">cpm</span> <span class="o">*</span> <span class="n">sam</span>

            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPSILON</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">xe</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">EPSILON</span><span class="p">:</span>
                <span class="n">takeoff</span> <span class="o">=</span> <span class="mf">0.</span>
                <span class="n">az</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">az</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">xe</span><span class="p">,</span> <span class="n">xn</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">az</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
                    <span class="n">az</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
                <span class="n">takeoff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">xz</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xz</span> <span class="o">*</span> <span class="n">xz</span> <span class="o">+</span> <span class="n">xn</span> <span class="o">*</span> <span class="n">xn</span> <span class="o">+</span>
                                                       <span class="n">xe</span> <span class="o">*</span> <span class="n">xe</span><span class="p">)))</span>
            <span class="k">if</span> <span class="n">takeoff</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">:</span>
                <span class="n">takeoff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">-</span> <span class="n">takeoff</span>
                <span class="n">az</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
                <span class="k">if</span> <span class="n">az</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span><span class="p">:</span>
                    <span class="n">az</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
            <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">takeoff</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
            <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
            <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">azi</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">az</span>
                <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">azp</span> <span class="o">=</span> <span class="n">az</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">az</span> <span class="o">-</span> <span class="n">azp</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">D2R</span> <span class="o">*</span> <span class="mf">10.</span><span class="p">:</span>
                    <span class="n">azi</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">azp</span>
                    <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="n">azi</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">az</span>
                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">az</span> <span class="o">-</span> <span class="n">azp</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">D2R</span> <span class="o">*</span> <span class="mf">2.</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">azp</span> <span class="o">&lt;</span> <span class="n">az</span><span class="p">:</span>
                        <span class="n">azi</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">azi</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
                <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">x</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">si</span>
                    <span class="n">y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">co</span>
                    <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">x2</span><span class="p">[</span><span class="n">j2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">si</span>
                    <span class="n">y2</span><span class="p">[</span><span class="n">j2</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">co</span>
                    <span class="n">j2</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                    <span class="n">x3</span><span class="p">[</span><span class="n">j3</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">si</span>
                    <span class="n">y3</span><span class="p">[</span><span class="n">j3</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">co</span>
                    <span class="n">j3</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">azp</span> <span class="o">=</span> <span class="n">az</span>
    <span class="n">azi</span><span class="p">[</span><span class="n">n</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">az</span>

    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">rgb1</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>
        <span class="n">rgb2</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rgb1</span> <span class="o">=</span> <span class="s1">&#39;w&#39;</span>
        <span class="n">rgb2</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span>

    <span class="n">cir</span> <span class="o">=</span> <span class="n">patches</span><span class="o">.</span><span class="n">Ellipse</span><span class="p">(</span><span class="n">xy</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="n">width</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cir</span><span class="p">)</span>
    <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgb2</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy2patch</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">360</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">360</span><span class="p">],</span> <span class="n">res</span><span class="p">,</span> <span class="n">xy</span><span class="p">))</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgb1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">colors</span><span class="p">,</span> <span class="n">collect</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
            <span class="n">xp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">yp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
        <span class="k">elif</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
        <span class="k">if</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">az</span> <span class="o">=</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">D2R</span>
            <span class="k">while</span> <span class="n">az</span> <span class="o">&gt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">xp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">yp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">az</span> <span class="o">-=</span> <span class="n">D2R</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">az</span> <span class="o">=</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">D2R</span>
            <span class="k">while</span> <span class="n">az</span> <span class="o">&lt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">xp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">yp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">az</span> <span class="o">+=</span> <span class="n">D2R</span>
        <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy2patch</span><span class="p">(</span><span class="n">xp1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">yp1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">res</span><span class="p">,</span> <span class="n">xy</span><span class="p">))</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgb1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j2</span><span class="p">):</span>
            <span class="n">xp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">yp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
        <span class="k">elif</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
        <span class="k">if</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">az</span> <span class="o">=</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">D2R</span>
            <span class="k">while</span> <span class="n">az</span> <span class="o">&gt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">xp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">yp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">az</span> <span class="o">-=</span> <span class="n">D2R</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">az</span> <span class="o">=</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">D2R</span>
            <span class="k">while</span> <span class="n">az</span> <span class="o">&lt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">xp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">yp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">az</span> <span class="o">+=</span> <span class="n">D2R</span>
        <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy2patch</span><span class="p">(</span><span class="n">xp2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">yp2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">res</span><span class="p">,</span> <span class="n">xy</span><span class="p">))</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgb1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">colors</span><span class="p">,</span> <span class="n">collect</span>
    <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j3</span><span class="p">):</span>
            <span class="n">xp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">yp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y3</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
            <span class="n">xp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">yp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">big_iso</span><span class="p">:</span>
            <span class="n">ii</span> <span class="o">=</span> <span class="n">j2</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="n">ii</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">xp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">yp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
                <span class="n">ii</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy2patch</span><span class="p">(</span><span class="n">xp1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">yp1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">res</span><span class="p">,</span> <span class="n">xy</span><span class="p">))</span>
            <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgb1</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">colors</span><span class="p">,</span> <span class="n">collect</span>

        <span class="k">if</span> <span class="n">azi</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">azi</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
        <span class="k">elif</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">azi</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">azi</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
        <span class="k">if</span> <span class="n">azi</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">az</span> <span class="o">=</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">D2R</span>
            <span class="k">while</span> <span class="n">az</span> <span class="o">&gt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">xp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">yp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">az</span> <span class="o">-=</span> <span class="n">D2R</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">az</span> <span class="o">=</span> <span class="n">azi</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">D2R</span>
            <span class="k">while</span> <span class="n">az</span> <span class="o">&lt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">xp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">yp1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">az</span> <span class="o">+=</span> <span class="n">D2R</span>
        <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy2patch</span><span class="p">(</span><span class="n">xp1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">yp1</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">res</span><span class="p">,</span> <span class="n">xy</span><span class="p">))</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgb1</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">j2</span><span class="p">):</span>
            <span class="n">xp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">yp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
        <span class="k">elif</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.</span>
        <span class="k">if</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">az</span> <span class="o">=</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">D2R</span>
            <span class="k">while</span> <span class="n">az</span> <span class="o">&gt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">xp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">yp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">az</span> <span class="o">-=</span> <span class="n">D2R</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">az</span> <span class="o">=</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">D2R</span>
            <span class="k">while</span> <span class="n">az</span> <span class="o">&lt;</span> <span class="n">azi</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">si</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">co</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">az</span><span class="p">)</span>
                <span class="n">xp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">si</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">yp2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">+</span> <span class="n">radius_size</span> <span class="o">*</span> <span class="n">co</span>
                <span class="n">az</span> <span class="o">+=</span> <span class="n">D2R</span>
        <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy2patch</span><span class="p">(</span><span class="n">xp2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">yp2</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">i</span><span class="p">],</span> <span class="n">res</span><span class="p">,</span> <span class="n">xy</span><span class="p">))</span>
        <span class="n">colors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rgb1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">colors</span><span class="p">,</span> <span class="n">collect</span></div>


<div class="viewcode-block" id="plot_dc"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.plot_dc.html#obspy.imaging.beachball.plot_dc">[docs]</a><span class="k">def</span> <span class="nf">plot_dc</span><span class="p">(</span><span class="n">np1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">width</span><span class="o">=</span><span class="mi">200</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Uses one nodal plane of a double couple to draw a beach ball plot.</span>

<span class="sd">    :param ax: axis object of a matplotlib figure</span>
<span class="sd">    :param np1: :class:`~NodalPlane`</span>

<span class="sd">    Adapted from MATLAB script</span>
<span class="sd">    `bb.m &lt;http://www.ceri.memphis.edu/people/olboyd/Software/Software.html&gt;`_</span>
<span class="sd">    written by Andy Michael, Chen Ji and Oliver Boyd.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check if one or two widths are specified (Circle or Ellipse)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">width</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">width</span><span class="p">)</span>
    <span class="n">s_1</span> <span class="o">=</span> <span class="n">np1</span><span class="o">.</span><span class="n">strike</span>
    <span class="n">d_1</span> <span class="o">=</span> <span class="n">np1</span><span class="o">.</span><span class="n">dip</span>
    <span class="n">r_1</span> <span class="o">=</span> <span class="n">np1</span><span class="o">.</span><span class="n">rake</span>

    <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">r_1</span> <span class="o">&gt;</span> <span class="mi">180</span><span class="p">:</span>
        <span class="n">r_1</span> <span class="o">-=</span> <span class="mi">180</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">r_1</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">r_1</span> <span class="o">+=</span> <span class="mi">180</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="c1"># Get azimuth and dip of second plane</span>
    <span class="p">(</span><span class="n">s_2</span><span class="p">,</span> <span class="n">d_2</span><span class="p">,</span> <span class="n">_r_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">aux_plane</span><span class="p">(</span><span class="n">s_1</span><span class="p">,</span> <span class="n">d_1</span><span class="p">,</span> <span class="n">r_1</span><span class="p">)</span>

    <span class="n">d</span> <span class="o">=</span> <span class="n">size</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">d_1</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">:</span>
        <span class="n">d_1</span> <span class="o">=</span> <span class="mf">89.9999</span>
    <span class="k">if</span> <span class="n">d_2</span> <span class="o">&gt;=</span> <span class="mi">90</span><span class="p">:</span>
        <span class="n">d_2</span> <span class="o">=</span> <span class="mf">89.9999</span>

    <span class="c1"># arange checked for numerical stability, np.pi is not multiple of 0.1</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="o">.</span><span class="mi">01</span><span class="p">)</span>
    <span class="n">l1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">d_1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span>
            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span>
            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">d_1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
    <span class="n">l2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">d_2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span>
            <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="n">d_2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mi">90</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>

    <span class="n">collect</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># plot paths, once for tension areas and once for pressure areas</span>
    <span class="k">for</span> <span class="n">m_</span> <span class="ow">in</span> <span class="p">((</span><span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
        <span class="n">inc</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">y_1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">phi</span> <span class="o">+</span> <span class="n">s_1</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">,</span> <span class="n">l1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">m_</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">lo</span> <span class="o">=</span> <span class="n">s_1</span> <span class="o">-</span> <span class="mi">180</span>
            <span class="n">hi</span> <span class="o">=</span> <span class="n">s_2</span>
            <span class="k">if</span> <span class="n">lo</span> <span class="o">&gt;</span> <span class="n">hi</span><span class="p">:</span>
                <span class="n">inc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">th1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">s_1</span> <span class="o">-</span> <span class="mi">180</span><span class="p">,</span> <span class="n">s_2</span><span class="p">,</span> <span class="n">inc</span><span class="p">)</span>
            <span class="p">(</span><span class="n">xs_1</span><span class="p">,</span> <span class="n">ys_1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">th1</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">,</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">th1</span><span class="p">))))</span>
            <span class="p">(</span><span class="n">x_2</span><span class="p">,</span> <span class="n">y_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">phi</span> <span class="o">+</span> <span class="n">s_2</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">,</span> <span class="n">l2</span><span class="p">)</span>
            <span class="n">th2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">s_2</span> <span class="o">+</span> <span class="mi">180</span><span class="p">,</span> <span class="n">s_1</span><span class="p">,</span> <span class="o">-</span><span class="n">inc</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">hi</span> <span class="o">=</span> <span class="n">s_1</span> <span class="o">-</span> <span class="mi">180</span>
            <span class="n">lo</span> <span class="o">=</span> <span class="n">s_2</span> <span class="o">-</span> <span class="mi">180</span>
            <span class="k">if</span> <span class="n">lo</span> <span class="o">&gt;</span> <span class="n">hi</span><span class="p">:</span>
                <span class="n">inc</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">th1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">lo</span><span class="p">,</span> <span class="o">-</span><span class="n">inc</span><span class="p">)</span>
            <span class="p">(</span><span class="n">xs_1</span><span class="p">,</span> <span class="n">ys_1</span><span class="p">)</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">th1</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">,</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">th1</span><span class="p">))))</span>
            <span class="p">(</span><span class="n">x_2</span><span class="p">,</span> <span class="n">y_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">phi</span> <span class="o">+</span> <span class="n">s_2</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">,</span> <span class="n">l2</span><span class="p">)</span>
            <span class="n">x_2</span> <span class="o">=</span> <span class="n">x_2</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">y_2</span> <span class="o">=</span> <span class="n">y_2</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">th2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">s_2</span><span class="p">,</span> <span class="n">s_1</span><span class="p">,</span> <span class="n">inc</span><span class="p">)</span>
        <span class="p">(</span><span class="n">xs_2</span><span class="p">,</span> <span class="n">ys_2</span><span class="p">)</span> <span class="o">=</span> <span class="n">pol2cart</span><span class="p">(</span><span class="n">th2</span> <span class="o">*</span> <span class="n">D2R</span><span class="p">,</span> <span class="mi">90</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">th2</span><span class="p">))))</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">x_1</span><span class="p">,</span> <span class="n">xs_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x_2</span><span class="p">,</span> <span class="n">xs_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">y_1</span><span class="p">,</span> <span class="n">ys_1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y_2</span><span class="p">,</span> <span class="n">ys_2</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>

        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">d</span> <span class="o">/</span> <span class="mi">90</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">d</span> <span class="o">/</span> <span class="mi">90</span>

        <span class="c1"># calculate resolution</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">size</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">width</span><span class="p">]</span>

        <span class="c1"># construct the patch</span>
        <span class="n">collect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xy2patch</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">xy</span><span class="p">))</span>
    <span class="k">return</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">],</span> <span class="n">collect</span></div>


<div class="viewcode-block" id="xy2patch"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.xy2patch.html#obspy.imaging.beachball.xy2patch">[docs]</a><span class="k">def</span> <span class="nf">xy2patch</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">xy</span><span class="p">):</span>
    <span class="c1"># check if one or two resolutions are specified (Circle or Ellipse)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
    <span class="c1"># transform into the Path coordinate system</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">xy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">xy</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">verts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">y</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
    <span class="n">codes</span> <span class="o">=</span> <span class="p">[</span><span class="n">mplpath</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">MOVETO</span><span class="p">]</span>
    <span class="n">codes</span><span class="o">.</span><span class="n">extend</span><span class="p">([</span><span class="n">mplpath</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">LINETO</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">codes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mplpath</span><span class="o">.</span><span class="n">Path</span><span class="o">.</span><span class="n">CLOSEPOLY</span><span class="p">)</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">mplpath</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">verts</span><span class="p">,</span> <span class="n">codes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">patches</span><span class="o">.</span><span class="n">PathPatch</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>


<div class="viewcode-block" id="pol2cart"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.pol2cart.html#obspy.imaging.beachball.pol2cart">[docs]</a><span class="k">def</span> <span class="nf">pol2cart</span><span class="p">(</span><span class="n">th</span><span class="p">,</span> <span class="n">r</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">r</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">th</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="strike_dip"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.strike_dip.html#obspy.imaging.beachball.strike_dip">[docs]</a><span class="k">def</span> <span class="nf">strike_dip</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">e</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds strike and dip of plane given normal vector having components n, e,</span>
<span class="sd">    and u.</span>

<span class="sd">    Adapted from MATLAB script</span>
<span class="sd">    `bb.m &lt;http://www.ceri.memphis.edu/people/olboyd/Software/Software.html&gt;`_</span>
<span class="sd">    written by Andy Michael, Chen Ji and Oliver Boyd.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r2d</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="k">if</span> <span class="n">u</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="o">-</span><span class="n">n</span>
        <span class="n">e</span> <span class="o">=</span> <span class="o">-</span><span class="n">e</span>
        <span class="n">u</span> <span class="o">=</span> <span class="o">-</span><span class="n">u</span>

    <span class="n">strike</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">*</span> <span class="n">r2d</span>
    <span class="n">strike</span> <span class="o">=</span> <span class="n">strike</span> <span class="o">-</span> <span class="mi">90</span>
    <span class="k">while</span> <span class="n">strike</span> <span class="o">&gt;=</span> <span class="mi">360</span><span class="p">:</span>
        <span class="n">strike</span> <span class="o">=</span> <span class="n">strike</span> <span class="o">-</span> <span class="mi">360</span>
    <span class="k">while</span> <span class="n">strike</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">strike</span> <span class="o">=</span> <span class="n">strike</span> <span class="o">+</span> <span class="mi">360</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">dip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="o">*</span> <span class="n">r2d</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="p">)</span></div>


<div class="viewcode-block" id="aux_plane"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.aux_plane.html#obspy.imaging.beachball.aux_plane">[docs]</a><span class="k">def</span> <span class="nf">aux_plane</span><span class="p">(</span><span class="n">s1</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">r1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get Strike and dip of second plane.</span>

<span class="sd">    Adapted from MATLAB script</span>
<span class="sd">    `bb.m &lt;http://www.ceri.memphis.edu/people/olboyd/Software/Software.html&gt;`_</span>
<span class="sd">    written by Andy Michael, Chen Ji and Oliver Boyd.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">r2d</span> <span class="o">=</span> <span class="mi">180</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

    <span class="n">z</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1</span> <span class="o">+</span> <span class="mi">90</span><span class="p">)</span> <span class="o">/</span> <span class="n">r2d</span>
    <span class="n">z2</span> <span class="o">=</span> <span class="n">d1</span> <span class="o">/</span> <span class="n">r2d</span>
    <span class="n">z3</span> <span class="o">=</span> <span class="n">r1</span> <span class="o">/</span> <span class="n">r2d</span>
    <span class="c1"># slick vector in plane 1</span>
    <span class="n">sl1</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
    <span class="n">sl2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
    <span class="n">sl3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z3</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
    <span class="p">(</span><span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="p">)</span> <span class="o">=</span> <span class="n">strike_dip</span><span class="p">(</span><span class="n">sl2</span><span class="p">,</span> <span class="n">sl1</span><span class="p">,</span> <span class="n">sl3</span><span class="p">)</span>

    <span class="n">n1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>  <span class="c1"># normal vector to plane 1</span>
    <span class="n">n2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
    <span class="n">h1</span> <span class="o">=</span> <span class="o">-</span><span class="n">sl2</span>  <span class="c1"># strike vector of plane 2</span>
    <span class="n">h2</span> <span class="o">=</span> <span class="n">sl1</span>
    <span class="c1"># note h3=0 always so we leave it out</span>
    <span class="c1"># n3 = np.cos(z2)</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">h1</span> <span class="o">*</span> <span class="n">n1</span> <span class="o">+</span> <span class="n">h2</span> <span class="o">*</span> <span class="n">n2</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">h1</span> <span class="o">*</span> <span class="n">h1</span> <span class="o">+</span> <span class="n">h2</span> <span class="o">*</span> <span class="n">h2</span><span class="p">)</span>
    <span class="c1"># we might get above 1.0 only due to floating point</span>
    <span class="c1"># precision. Clip for those cases.</span>
    <span class="n">float64epsilon</span> <span class="o">=</span> <span class="mf">2.2204460492503131e-16</span>
    <span class="k">if</span> <span class="mf">1.0</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">float64epsilon</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copysign</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">rake</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">sl3</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rake</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">r2d</span>
    <span class="k">if</span> <span class="n">sl3</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">rake</span> <span class="o">=</span> <span class="o">-</span><span class="n">z</span> <span class="o">*</span> <span class="n">r2d</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">strike</span><span class="p">,</span> <span class="n">dip</span><span class="p">,</span> <span class="n">rake</span><span class="p">)</span></div>


<div class="viewcode-block" id="mt2plane"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.mt2plane.html#obspy.imaging.beachball.mt2plane">[docs]</a><span class="k">def</span> <span class="nf">mt2plane</span><span class="p">(</span><span class="n">mt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates a nodal plane of a given moment tensor.</span>

<span class="sd">    :param mt: :class:`~MomentTensor`</span>
<span class="sd">    :return: :class:`~NodalPlane`</span>

<span class="sd">    Adapted from MATLAB script</span>
<span class="sd">    `bb.m &lt;http://www.ceri.memphis.edu/people/olboyd/Software/Software.html&gt;`_</span>
<span class="sd">    written by Andy Michael, Chen Ji and Oliver Boyd.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">mt</span><span class="p">)</span>
    <span class="n">d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                 <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span>
                 <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]])</span>
    <span class="n">imax</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span>
    <span class="n">imin</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span>
    <span class="n">ae</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[:,</span> <span class="n">imax</span><span class="p">]</span> <span class="o">+</span> <span class="n">v</span><span class="p">[:,</span> <span class="n">imin</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">an</span> <span class="o">=</span> <span class="p">(</span><span class="n">v</span><span class="p">[:,</span> <span class="n">imax</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[:,</span> <span class="n">imin</span><span class="p">])</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">aer</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">ae</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">ae</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">ae</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">anr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">an</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">an</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">an</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">ae</span> <span class="o">=</span> <span class="n">ae</span> <span class="o">/</span> <span class="n">aer</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">anr</span><span class="p">:</span>
        <span class="n">an</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">an</span> <span class="o">=</span> <span class="n">an</span> <span class="o">/</span> <span class="n">anr</span>
    <span class="k">if</span> <span class="n">an</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mf">0.</span><span class="p">:</span>
        <span class="n">an1</span> <span class="o">=</span> <span class="n">an</span>
        <span class="n">ae1</span> <span class="o">=</span> <span class="n">ae</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">an1</span> <span class="o">=</span> <span class="o">-</span><span class="n">an</span>
        <span class="n">ae1</span> <span class="o">=</span> <span class="o">-</span><span class="n">ae</span>
    <span class="p">(</span><span class="n">ft</span><span class="p">,</span> <span class="n">fd</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span> <span class="o">=</span> <span class="n">tdl</span><span class="p">(</span><span class="n">an1</span><span class="p">,</span> <span class="n">ae1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">NodalPlane</span><span class="p">(</span><span class="mi">360</span> <span class="o">-</span> <span class="n">ft</span><span class="p">,</span> <span class="n">fd</span><span class="p">,</span> <span class="mi">180</span> <span class="o">-</span> <span class="n">fl</span><span class="p">)</span></div>


<div class="viewcode-block" id="tdl"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.tdl.html#obspy.imaging.beachball.tdl">[docs]</a><span class="k">def</span> <span class="nf">tdl</span><span class="p">(</span><span class="n">an</span><span class="p">,</span> <span class="n">bn</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Helper function for mt2plane.</span>

<span class="sd">    Adapted from MATLAB script</span>
<span class="sd">    `bb.m &lt;http://www.ceri.memphis.edu/people/olboyd/Software/Software.html&gt;`_</span>
<span class="sd">    written by Andy Michael, Chen Ji and Oliver Boyd.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xn</span> <span class="o">=</span> <span class="n">an</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">yn</span> <span class="o">=</span> <span class="n">an</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">zn</span> <span class="o">=</span> <span class="n">an</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">xe</span> <span class="o">=</span> <span class="n">bn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">ye</span> <span class="o">=</span> <span class="n">bn</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">ze</span> <span class="o">=</span> <span class="n">bn</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">aaa</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1000000</span><span class="p">)</span>
    <span class="n">con</span> <span class="o">=</span> <span class="mf">57.2957795</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">zn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">aaa</span><span class="p">:</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="mf">90.</span>
        <span class="n">axn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axn</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">axn</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">ft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">axn</span><span class="p">)</span> <span class="o">*</span> <span class="n">con</span>
        <span class="n">st</span> <span class="o">=</span> <span class="o">-</span><span class="n">xn</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="n">yn</span>
        <span class="k">if</span> <span class="n">st</span> <span class="o">&gt;=</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">ct</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ft</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">ft</span>
        <span class="k">if</span> <span class="n">st</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">ct</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ft</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">+</span> <span class="n">ft</span>
        <span class="k">if</span> <span class="n">st</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">ct</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ft</span> <span class="o">=</span> <span class="mf">360.</span> <span class="o">-</span> <span class="n">ft</span>
        <span class="n">fl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">ze</span><span class="p">))</span> <span class="o">*</span> <span class="n">con</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="o">-</span><span class="n">ze</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">xn</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">aaa</span><span class="p">:</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">xe</span> <span class="o">/</span> <span class="n">yn</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="o">-</span><span class="n">ye</span> <span class="o">/</span> <span class="n">xn</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&gt;=</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">cl</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">fl</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">cl</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="n">fl</span> <span class="o">-</span> <span class="mf">180.</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">cl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="o">-</span><span class="n">fl</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="o">-</span><span class="n">zn</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">zn</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
        <span class="n">fdh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="o">-</span><span class="n">zn</span><span class="p">)</span>
        <span class="n">fd</span> <span class="o">=</span> <span class="n">fdh</span> <span class="o">*</span> <span class="n">con</span>
        <span class="n">sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">fdh</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sd</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">st</span> <span class="o">=</span> <span class="o">-</span><span class="n">xn</span> <span class="o">/</span> <span class="n">sd</span>
        <span class="n">ct</span> <span class="o">=</span> <span class="n">yn</span> <span class="o">/</span> <span class="n">sd</span>
        <span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sx</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">sx</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">ft</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span> <span class="o">*</span> <span class="n">con</span>
        <span class="k">if</span> <span class="n">st</span> <span class="o">&gt;=</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">ct</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ft</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">ft</span>
        <span class="k">if</span> <span class="n">st</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">ct</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ft</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">+</span> <span class="n">ft</span>
        <span class="k">if</span> <span class="n">st</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">ct</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ft</span> <span class="o">=</span> <span class="mf">360.</span> <span class="o">-</span> <span class="n">ft</span>
        <span class="n">sl</span> <span class="o">=</span> <span class="o">-</span><span class="n">ze</span> <span class="o">/</span> <span class="n">sd</span>
        <span class="n">sx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fabs</span><span class="p">(</span><span class="n">sl</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sx</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">:</span>
            <span class="n">sx</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="n">fl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">sx</span><span class="p">)</span> <span class="o">*</span> <span class="n">con</span>
        <span class="k">if</span> <span class="n">st</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="n">xe</span> <span class="o">/</span> <span class="n">ct</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">xxx</span> <span class="o">=</span> <span class="n">yn</span> <span class="o">*</span> <span class="n">zn</span> <span class="o">*</span> <span class="n">ze</span> <span class="o">/</span> <span class="n">sd</span> <span class="o">/</span> <span class="n">sd</span> <span class="o">+</span> <span class="n">ye</span>
            <span class="n">cl</span> <span class="o">=</span> <span class="o">-</span><span class="n">sd</span> <span class="o">*</span> <span class="n">xxx</span> <span class="o">/</span> <span class="n">xn</span>
            <span class="k">if</span> <span class="n">ct</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">cl</span> <span class="o">=</span> <span class="n">ye</span> <span class="o">/</span> <span class="n">st</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&gt;=</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">cl</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="mf">180.</span> <span class="o">-</span> <span class="n">fl</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">cl</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="n">fl</span> <span class="o">-</span> <span class="mf">180.</span>
        <span class="k">if</span> <span class="n">sl</span> <span class="o">&lt;</span> <span class="mf">0.</span> <span class="ow">and</span> <span class="n">cl</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">fl</span> <span class="o">=</span> <span class="o">-</span><span class="n">fl</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ft</span><span class="p">,</span> <span class="n">fd</span><span class="p">,</span> <span class="n">fl</span><span class="p">)</span></div>


<div class="viewcode-block" id="mt2axes"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.mt2axes.html#obspy.imaging.beachball.mt2axes">[docs]</a><span class="k">def</span> <span class="nf">mt2axes</span><span class="p">(</span><span class="n">mt</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the principal axes of a given moment tensor.</span>

<span class="sd">    :param mt: :class:`~MomentTensor`</span>
<span class="sd">    :return: tuple of :class:`~PrincipalAxis` T, N and P</span>

<span class="sd">    Adapted from ps_tensor / utilmeca.c /</span>
<span class="sd">    `Generic Mapping Tools (GMT) &lt;https://gmt.soest.hawaii.edu&gt;`_.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">mt</span><span class="p">)</span>
    <span class="n">pl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">az</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan2</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">pl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">pl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">pl</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">az</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">if</span> <span class="n">az</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">az</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
        <span class="k">if</span> <span class="n">az</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">:</span>
            <span class="n">az</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">pl</span> <span class="o">*=</span> <span class="n">R2D</span>
    <span class="n">az</span> <span class="o">*=</span> <span class="n">R2D</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">PrincipalAxis</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">az</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">pl</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">PrincipalAxis</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">az</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pl</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">PrincipalAxis</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">az</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pl</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span></div>


<div class="viewcode-block" id="PrincipalAxis"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.PrincipalAxis.html#obspy.imaging.beachball.PrincipalAxis">[docs]</a><span class="k">class</span> <span class="nc">PrincipalAxis</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A principal axis.</span>

<span class="sd">    Strike and dip values are in degrees.</span>

<span class="sd">    &gt;&gt;&gt; a = PrincipalAxis(1.3, 20, 50)</span>
<span class="sd">    &gt;&gt;&gt; a.dip</span>
<span class="sd">    50</span>
<span class="sd">    &gt;&gt;&gt; a.strike</span>
<span class="sd">    20</span>
<span class="sd">    &gt;&gt;&gt; a.val</span>
<span class="sd">    1.3</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="PrincipalAxis.__init__"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.PrincipalAxis.__init__.html#obspy.imaging.beachball.PrincipalAxis.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">val</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">strike</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dip</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strike</span> <span class="o">=</span> <span class="n">strike</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dip</span> <span class="o">=</span> <span class="n">dip</span></div></div>


<div class="viewcode-block" id="NodalPlane"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.NodalPlane.html#obspy.imaging.beachball.NodalPlane">[docs]</a><span class="k">class</span> <span class="nc">NodalPlane</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A nodal plane.</span>

<span class="sd">    All values are in degrees.</span>

<span class="sd">    &gt;&gt;&gt; a = NodalPlane(13, 20, 50)</span>
<span class="sd">    &gt;&gt;&gt; a.strike</span>
<span class="sd">    13</span>
<span class="sd">    &gt;&gt;&gt; a.dip</span>
<span class="sd">    20</span>
<span class="sd">    &gt;&gt;&gt; a.rake</span>
<span class="sd">    50</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="NodalPlane.__init__"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.NodalPlane.__init__.html#obspy.imaging.beachball.NodalPlane.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">strike</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">dip</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">rake</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strike</span> <span class="o">=</span> <span class="n">strike</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dip</span> <span class="o">=</span> <span class="n">dip</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rake</span> <span class="o">=</span> <span class="n">rake</span></div></div>


<div class="viewcode-block" id="MomentTensor"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.MomentTensor.html#obspy.imaging.beachball.MomentTensor">[docs]</a><span class="k">class</span> <span class="nc">MomentTensor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A moment tensor.</span>

<span class="sd">    &gt;&gt;&gt; a = MomentTensor(1, 1, 0, 0, 0, -1, 26)</span>
<span class="sd">    &gt;&gt;&gt; b = MomentTensor(np.array([1, 1, 0, 0, 0, -1]), 26)</span>
<span class="sd">    &gt;&gt;&gt; c = MomentTensor(np.array([[1, 0, 0], [0, 1, -1], [0, -1, 0]]), 26)</span>
<span class="sd">    &gt;&gt;&gt; a.mt</span>
<span class="sd">    array([[ 1,  0,  0],</span>
<span class="sd">           [ 0,  1, -1],</span>
<span class="sd">           [ 0, -1,  0]])</span>
<span class="sd">    &gt;&gt;&gt; b.yz</span>
<span class="sd">    -1</span>
<span class="sd">    &gt;&gt;&gt; a.expo</span>
<span class="sd">    26</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="MomentTensor.__init__"><a class="viewcode-back" href="../../../packages/autogen/obspy.imaging.beachball.MomentTensor.__init__.html#obspy.imaging.beachball.MomentTensor.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expo</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="mi">6</span><span class="p">:</span>
                <span class="c1"># six independent components</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>
                                    <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
                                    <span class="p">[</span><span class="n">a</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
                <span class="c1"># full matrix</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mt</span> <span class="o">=</span> <span class="n">a</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Wrong size of input parameter.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="c1"># six independent components</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">4</span><span class="p">]],</span>
                                <span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">5</span><span class="p">]],</span>
                                <span class="p">[</span><span class="n">args</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">args</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">expo</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Wrong size of input parameter.&quot;</span><span class="p">)</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">xz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">yz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">yy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">zz</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mt</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span></div>


<span class="c1"># Remove once 0.11 has been released.</span>
<span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span> <span class="o">=</span> <span class="n">DynamicAttributeImportRerouteModule</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">doc</span><span class="o">=</span><span class="vm">__doc__</span><span class="p">,</span> <span class="n">locs</span><span class="o">=</span><span class="nb">locals</span><span class="p">(),</span>
    <span class="n">original_module</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">],</span>
    <span class="n">import_map</span><span class="o">=</span><span class="p">{},</span>
    <span class="n">function_map</span><span class="o">=</span><span class="p">{</span>
        <span class="s1">&#39;MT2Axes&#39;</span><span class="p">:</span> <span class="s1">&#39;obspy.imaging.beachball.mt2axes&#39;</span><span class="p">,</span>
        <span class="s1">&#39;MT2Plane&#39;</span><span class="p">:</span> <span class="s1">&#39;obspy.imaging.beachball.mt2plane&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Pol2Cart&#39;</span><span class="p">:</span> <span class="s1">&#39;obspy.imaging.beachball.pol2cart&#39;</span><span class="p">,</span>
        <span class="s1">&#39;StrikeDip&#39;</span><span class="p">:</span> <span class="s1">&#39;obspy.imaging.beachball.strike_dip&#39;</span><span class="p">,</span>
        <span class="s1">&#39;TDL&#39;</span><span class="p">:</span> <span class="s1">&#39;obspy.imaging.beachball.tdl&#39;</span><span class="p">,</span>
        <span class="s1">&#39;plotDC&#39;</span><span class="p">:</span> <span class="s1">&#39;obspy.imaging.beachball.plot_dc&#39;</span><span class="p">,</span>
        <span class="s1">&#39;plotMT&#39;</span><span class="p">:</span> <span class="s1">&#39;obspy.imaging.beachball.plot_mt&#39;</span><span class="p">})</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a>™ &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, Ólafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Käufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhäusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaimé, Sébastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clément</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Köhler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n° 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>