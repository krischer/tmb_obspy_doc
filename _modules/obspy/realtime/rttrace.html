<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.realtime.rttrace &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.realtime.rttrace</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Module for handling ObsPy RtTrace objects.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org) &amp; Anthony Lomax</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>

<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">obspy</span> <span class="k">import</span> <span class="n">Trace</span>
<span class="kn">from</span> <span class="nn">obspy.core</span> <span class="k">import</span> <span class="n">Stats</span>
<span class="kn">from</span> <span class="nn">obspy.core.util.decorator</span> <span class="k">import</span> <span class="n">deprecated</span>
<span class="kn">from</span> <span class="nn">obspy.realtime</span> <span class="k">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">obspy.realtime.rtmemory</span> <span class="k">import</span> <span class="n">RtMemory</span>


<span class="c1"># dictionary to map given type-strings to processing functions keys must be all</span>
<span class="c1"># lower case - values are tuples: (function name, number of RtMemory objects)</span>
<span class="n">REALTIME_PROCESS_FUNCTIONS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;scale&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="s1">&#39;offset&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
    <span class="s1">&#39;integrate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">integrate</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;differentiate&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">differentiate</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;boxcar&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">boxcar</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;tauc&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">tauc</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
    <span class="s1">&#39;mwpintegral&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">mwpintegral</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="s1">&#39;kurtosis&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">kurtosis</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
<span class="p">}</span>


<div class="viewcode-block" id="RtTrace"><a class="viewcode-back" href="../../../packages/autogen/obspy.realtime.rttrace.RtTrace.html#obspy.realtime.rttrace.RtTrace">[docs]</a><span class="k">class</span> <span class="nc">RtTrace</span><span class="p">(</span><span class="n">Trace</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    An object containing data of a continuous series constructed dynamically</span>
<span class="sd">    from sequential data packets.</span>

<span class="sd">    New data packets may be periodically appended. Registered time-domain</span>
<span class="sd">    processes can be applied to the new data and the resulting trace will be</span>
<span class="sd">    left trimmed to maintain a specified maximum trace length.</span>

<span class="sd">    :type max_length: int, optional</span>
<span class="sd">    :param max_length: maximum trace length in seconds</span>

<span class="sd">    .. rubric:: Example</span>

<span class="sd">    RtTrace has been built to handle real time processing of periodically</span>
<span class="sd">    append data packets, such as adding and processing data requested from an</span>
<span class="sd">    SeedLink server. See :mod:`obspy.clients.seedlink` for further information.</span>

<span class="sd">    For the sake of simplicity we will just split data of an existing example</span>
<span class="sd">    file into multiple chucks (Trace objects) of about equal size (step 1 + 2)</span>
<span class="sd">    and append those chunks in a simple loop (step 4) into an RtTrace object.</span>
<span class="sd">    Additionally there are two real time processing functions registered to the</span>
<span class="sd">    RtTrace object (step 3) which will automatically process any appended data</span>
<span class="sd">    chunks.</span>

<span class="sd">    1. Read first trace of example SAC data file and extract contained time</span>
<span class="sd">       offset and epicentral distance of an earthquake::</span>

<span class="sd">        &gt;&gt;&gt; from obspy.realtime import RtTrace</span>
<span class="sd">        &gt;&gt;&gt; from obspy import read</span>
<span class="sd">        &gt;&gt;&gt; from obspy.realtime.signal import calculate_mwp_mag</span>
<span class="sd">        &gt;&gt;&gt; data_trace = read(&#39;/path/to/II.TLY.BHZ.SAC&#39;)[0]</span>
<span class="sd">        &gt;&gt;&gt; len(data_trace)</span>
<span class="sd">        12684</span>
<span class="sd">        &gt;&gt;&gt; ref_time_offset = data_trace.stats.sac.a</span>
<span class="sd">        &gt;&gt;&gt; print(ref_time_offset)</span>
<span class="sd">        301.506</span>
<span class="sd">        &gt;&gt;&gt; epicentral_distance = data_trace.stats.sac.gcarc</span>
<span class="sd">        &gt;&gt;&gt; print(epicentral_distance)</span>
<span class="sd">        30.0855</span>

<span class="sd">    2. Split given trace into a list of three sub-traces::</span>

<span class="sd">        &gt;&gt;&gt; traces = data_trace / 3</span>
<span class="sd">        &gt;&gt;&gt; [len(tr) for tr in traces]</span>
<span class="sd">        [4228, 4228, 4228]</span>

<span class="sd">    3. Assemble real time trace and register two processes::</span>

<span class="sd">        &gt;&gt;&gt; rt_trace = RtTrace()</span>
<span class="sd">        &gt;&gt;&gt; rt_trace.register_rt_process(&#39;integrate&#39;)</span>
<span class="sd">        1</span>
<span class="sd">        &gt;&gt;&gt; rt_trace.register_rt_process(&#39;mwpintegral&#39;, mem_time=240,</span>
<span class="sd">        ...     ref_time=(data_trace.stats.starttime + ref_time_offset),</span>
<span class="sd">        ...     max_time=120, gain=1.610210e+09)</span>
<span class="sd">        2</span>

<span class="sd">    4. Append and auto-process packet data into RtTrace::</span>

<span class="sd">        &gt;&gt;&gt; for tr in traces:</span>
<span class="sd">        ...     processed_trace = rt_trace.append(tr, gap_overlap_check=True)</span>
<span class="sd">        ...</span>
<span class="sd">        &gt;&gt;&gt; len(rt_trace)</span>
<span class="sd">        12684</span>

<span class="sd">    5. Some post processing to get Mwp::</span>

<span class="sd">        &gt;&gt;&gt; peak = np.amax(np.abs(rt_trace.data))</span>
<span class="sd">        &gt;&gt;&gt; print(peak)</span>
<span class="sd">        0.136404</span>
<span class="sd">        &gt;&gt;&gt; mwp = calculate_mwp_mag(peak, epicentral_distance)</span>
<span class="sd">        &gt;&gt;&gt; print(mwp)  # doctest: +ELLIPSIS</span>
<span class="sd">        8.78902911791...</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">have_appended_data</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;rtProcessFunctionsToString&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;rt_process_functions_to_string&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">rtProcessFunctionsToString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;rtProcessFunctionsToString&#39; has been renamed to</span>
<span class="sd">        &#39;rt_process_functions_to_string&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rt_process_functions_to_string</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="RtTrace.rt_process_functions_to_string"><a class="viewcode-back" href="../../../packages/autogen/obspy.realtime.rttrace.RtTrace.rt_process_functions_to_string.html#obspy.realtime.rttrace.RtTrace.rt_process_functions_to_string">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">rt_process_functions_to_string</span><span class="p">(</span><span class="bp">cls</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return doc string for all predefined real-time processing functions.</span>

<span class="sd">        :rtype: str</span>
<span class="sd">        :return: String containing doc for all real-time processing functions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;Real-time processing functions (use as: &#39;</span> <span class="o">+</span> \
            <span class="s1">&#39;RtTrace.register_rt_process(process_name, [parameter values])):</span><span class="se">\n</span><span class="s1">&#39;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">REALTIME_PROCESS_FUNCTIONS</span><span class="p">:</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="s1">&#39;  &#39;</span> <span class="o">+</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="mi">80</span> <span class="o">*</span> <span class="s1">&#39;-&#39;</span><span class="p">)[:</span><span class="mi">80</span><span class="p">]</span>
            <span class="n">string</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">REALTIME_PROCESS_FUNCTIONS</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">string</span><span class="p">)</span></div>

<div class="viewcode-block" id="RtTrace.__init__"><a class="viewcode-back" href="../../../packages/autogen/obspy.realtime.rttrace.RtTrace.__init__.html#obspy.realtime.rttrace.RtTrace.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_length</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes an RtTrace.</span>

<span class="sd">        See :class:`obspy.core.trace.Trace` for all parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># set window length attribute</span>
        <span class="k">if</span> <span class="n">max_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">max_length</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input max_length out of bounds: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">max_length</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">=</span> <span class="n">max_length</span>

        <span class="c1"># initialize processing list</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processing</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="c1"># initialize parent Trace with no data or header - all data must be</span>
        <span class="c1"># added using append</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">RtTrace</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([]),</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>

<div class="viewcode-block" id="RtTrace.__eq__"><a class="viewcode-back" href="../../../packages/autogen/obspy.realtime.rttrace.RtTrace.__eq__.html#obspy.realtime.rttrace.RtTrace.__eq__">[docs]</a>    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Implements rich comparison of RtTrace objects for &quot;==&quot; operator.</span>

<span class="sd">        Traces are the same, if both their data and stats are the same.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check if other object is a RtTrace</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">RtTrace</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">RtTrace</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></div>

<div class="viewcode-block" id="RtTrace.__add__"><a class="viewcode-back" href="../../../packages/autogen/obspy.realtime.rttrace.RtTrace.__add__.html#obspy.realtime.rttrace.RtTrace.__add__">[docs]</a>    <span class="k">def</span> <span class="nf">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># @UnusedVariable</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Too ambiguous, throw an Error.</span>

<span class="sd">        .. seealso:: :meth:`obspy.realtime.rttrace.RtTrace.append`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Too ambiguous for realtime trace data. Try: RtTrace.append()&quot;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

<div class="viewcode-block" id="RtTrace.append"><a class="viewcode-back" href="../../../packages/autogen/obspy.realtime.rttrace.RtTrace.append.html#obspy.realtime.rttrace.RtTrace.append">[docs]</a>    <span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trace</span><span class="p">,</span> <span class="n">gap_overlap_check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Appends a Trace object to this RtTrace.</span>

<span class="sd">        Registered real-time processing will be applied to copy of appended</span>
<span class="sd">        Trace object before it is appended.  This RtTrace will be truncated</span>
<span class="sd">        from the beginning to RtTrace.max_length, if specified.</span>
<span class="sd">        Sampling rate, data type and trace.id of both traces must match.</span>

<span class="sd">        :type trace: :class:`~obspy.core.trace.Trace`</span>
<span class="sd">        :param trace:  :class:`~obspy.core.trace.Trace` object to append to</span>
<span class="sd">            this RtTrace</span>
<span class="sd">        :type gap_overlap_check: bool, optional</span>
<span class="sd">        :param gap_overlap_check: Action to take when there is a gap or overlap</span>
<span class="sd">            between the end of this RtTrace and start of appended Trace:</span>

<span class="sd">            * If True, raise TypeError.</span>
<span class="sd">            * If False, all trace processing memory will be re-initialized to</span>
<span class="sd">              prevent false signal in processed trace.</span>

<span class="sd">            (default is ``True``).</span>
<span class="sd">        :type verbose: bool, optional</span>
<span class="sd">        :param verbose: Print additional information to stdout</span>
<span class="sd">        :return: NumPy :class:`~numpy.ndarray` object containing processed</span>
<span class="sd">            trace data from appended Trace object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">Trace</span><span class="p">):</span>
            <span class="c1"># only add Trace objects</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Only obspy.core.trace.Trace objects are allowed&quot;</span><span class="p">)</span>

        <span class="c1"># sanity checks</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">have_appended_data</span><span class="p">:</span>
            <span class="c1">#  check id</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">()</span> <span class="o">!=</span> <span class="n">trace</span><span class="o">.</span><span class="n">get_id</span><span class="p">():</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Trace ID differs:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_id</span><span class="p">(),</span>
                                <span class="n">trace</span><span class="o">.</span><span class="n">get_id</span><span class="p">())</span>
            <span class="c1">#  check sample rate</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">!=</span> <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Sampling rate differs:&quot;</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">,</span>
                                <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span><span class="p">)</span>
            <span class="c1">#  check calibration factor</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">calib</span> <span class="o">!=</span> <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">calib</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Calibration factor differs:&quot;</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">calib</span><span class="p">,</span> <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">calib</span><span class="p">)</span>
            <span class="c1"># check data type</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span> <span class="o">!=</span> <span class="n">trace</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Data type differs:&quot;</span><span class="p">,</span>
                                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">trace</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="c1"># TODO: IMPORTANT? Should improve check for gaps and overlaps</span>
        <span class="c1"># and handle more elegantly</span>
        <span class="c1"># check times</span>
        <span class="n">gap_or_overlap</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">have_appended_data</span><span class="p">:</span>
            <span class="c1"># delta = int(math.floor(\</span>
            <span class="c1">#    round((rt.stats.starttime - lt.stats.endtime) * sr, 5) )) - 1</span>
            <span class="n">diff</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">diff</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">-</span> <span class="mf">1.0</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: Overlap/gap of (</span><span class="si">%g</span><span class="s2">) samples in data: (</span><span class="si">%s</span><span class="s2">) (</span><span class="si">%s</span><span class="s2">) &quot;</span> <span class="o">+</span> \
                    <span class="s2">&quot;diff=</span><span class="si">%g</span><span class="s2">s  dt=</span><span class="si">%g</span><span class="s2">s&quot;</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                             <span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span><span class="p">,</span> <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="p">,</span>
                             <span class="n">diff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">delta</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Overlap of (</span><span class="si">%g</span><span class="s2">) samples in data: (</span><span class="si">%s</span><span class="s2">) (</span><span class="si">%s</span><span class="s2">) diff=</span><span class="si">%g</span><span class="s2">s&quot;</span> <span class="o">+</span> \
                    <span class="s2">&quot;  dt=</span><span class="si">%g</span><span class="s2">s&quot;</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="o">-</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span><span class="p">,</span> <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="p">,</span>
                             <span class="n">diff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">delta</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">gap_overlap_check</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">gap_or_overlap</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">delta</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Gap of (</span><span class="si">%g</span><span class="s2">) samples in data: (</span><span class="si">%s</span><span class="s2">) (</span><span class="si">%s</span><span class="s2">) diff=</span><span class="si">%g</span><span class="s2">s&quot;</span> <span class="o">+</span> \
                    <span class="s2">&quot;  dt=</span><span class="si">%g</span><span class="s2">s&quot;</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span><span class="p">,</span> <span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="p">,</span>
                             <span class="n">diff</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">delta</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">gap_overlap_check</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                <span class="n">gap_or_overlap</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">gap_or_overlap</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="s2">&quot; - Trace processing memory will be re-initialized.&quot;</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># correct start time to pin absolute trace timing to start of</span>
                <span class="c1"># appended trace, this prevents slow drift of nominal trace</span>
                <span class="c1"># timing from absolute time when nominal sample rate differs</span>
                <span class="c1"># from true sample rate</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">=</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">+</span> <span class="n">diff</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">delta</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: self.stats.starttime adjusted by: </span><span class="si">%g</span><span class="s2">s&quot;</span>
                          <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span> <span class="n">diff</span> <span class="o">-</span>
                             <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">delta</span><span class="p">))</span>
        <span class="c1"># first apply all registered processing to Trace</span>
        <span class="k">for</span> <span class="n">proc</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">processing</span><span class="p">:</span>
            <span class="n">process_name</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">rtmemory_list</span> <span class="o">=</span> <span class="n">proc</span>
            <span class="c1"># if gap or overlap, clear memory</span>
            <span class="k">if</span> <span class="n">gap_or_overlap</span> <span class="ow">and</span> <span class="n">rtmemory_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rtmemory_list</span><span class="p">)):</span>
                    <span class="n">rtmemory_list</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">RtMemory</span><span class="p">()</span>
            <span class="c1"># apply processing</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">dtype</span> <span class="o">=</span> <span class="n">trace</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">process_name</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
                <span class="c1"># check if direct function call</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">process_name</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># got predefined function</span>
                <span class="n">func</span> <span class="o">=</span> <span class="n">REALTIME_PROCESS_FUNCTIONS</span><span class="p">[</span><span class="n">process_name</span><span class="o">.</span><span class="n">lower</span><span class="p">()][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">options</span><span class="p">[</span><span class="s1">&#39;rtmemory_list&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rtmemory_list</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
            <span class="c1"># assure dtype is not changed</span>
            <span class="n">trace</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="c1"># if first data, set stats</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">have_appended_data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span> <span class="o">=</span> <span class="n">Stats</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">trace</span><span class="o">.</span><span class="n">stats</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">have_appended_data</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">return</span> <span class="n">trace</span>
        <span class="c1"># handle all following data sets</span>
        <span class="c1"># fix Trace.__add__ parameters</span>
        <span class="c1"># TODO: IMPORTANT? Should check for gaps and overlaps and handle</span>
        <span class="c1"># more elegantly</span>
        <span class="n">sum_trace</span> <span class="o">=</span> <span class="n">Trace</span><span class="o">.</span><span class="fm">__add__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">trace</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">interpolation_samples</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">fill_value</span><span class="o">=</span><span class="s1">&#39;latest&#39;</span><span class="p">,</span> <span class="n">sanity_checks</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Trace.__add__ returns new Trace, so update to this RtTrace</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">sum_trace</span><span class="o">.</span><span class="n">data</span>
        <span class="c1"># left trim if data length exceeds max_length</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">max_samples</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_length</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_samples</span><span class="p">:</span>
                <span class="n">starttime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span> <span class="o">+</span> \
                    <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">max_samples</span><span class="p">)</span> <span class="o">/</span> \
                    <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_ltrim</span><span class="p">(</span><span class="n">starttime</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">nearest_sample</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                            <span class="n">fill_value</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">trace</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span>
        <span class="s2">&quot;&#39;registerRtProcess&#39; has been renamed to &quot;</span>  <span class="c1"># noqa</span>
        <span class="s2">&quot;&#39;register_rt_process&#39;. Use that instead.&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">registerRtProcess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        DEPRECATED: &#39;registerRtProcess&#39; has been renamed to</span>
<span class="sd">        &#39;register_rt_process&#39;. Use that instead.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">register_rt_process</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="RtTrace.register_rt_process"><a class="viewcode-back" href="../../../packages/autogen/obspy.realtime.rttrace.RtTrace.register_rt_process.html#obspy.realtime.rttrace.RtTrace.register_rt_process">[docs]</a>    <span class="k">def</span> <span class="nf">register_rt_process</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">process</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Adds real-time processing algorithm to processing list of this RtTrace.</span>

<span class="sd">        Processing function must be one of:</span>
<span class="sd">            %s. % REALTIME_PROCESS_FUNCTIONS.keys()</span>
<span class="sd">            or a non-recursive, time-domain NumPy or ObsPy function which takes</span>
<span class="sd">            a single array as an argument and returns an array</span>

<span class="sd">        :type process: str or function</span>
<span class="sd">        :param process: Specifies which processing function is added,</span>
<span class="sd">            e.g. ``&quot;boxcar&quot;`` or ``np.abs``` (functions without brackets).</span>
<span class="sd">            See :mod:`obspy.realtime.signal` for all predefined processing</span>
<span class="sd">            functions.</span>
<span class="sd">        :type options: dict, optional</span>
<span class="sd">        :param options: Required keyword arguments to be passed the respective</span>
<span class="sd">            processing function, e.g. ``width=100`` for ``&#39;boxcar&#39;`` process.</span>
<span class="sd">            See :mod:`obspy.realtime.signal` for all options.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        :return: Length of processing list after registering new processing</span>
<span class="sd">            function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># create process_name either from string or function name</span>
        <span class="n">process_name</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">process</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

        <span class="c1"># set processing entry for this process</span>
        <span class="n">entry</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">rtmemory_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">process</span><span class="p">,</span> <span class="s1">&#39;__call__&#39;</span><span class="p">):</span>
            <span class="c1"># direct function call</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">process</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">process_name</span> <span class="ow">in</span> <span class="n">REALTIME_PROCESS_FUNCTIONS</span><span class="p">:</span>
            <span class="c1"># predefined function</span>
            <span class="n">num</span> <span class="o">=</span> <span class="n">REALTIME_PROCESS_FUNCTIONS</span><span class="p">[</span><span class="n">process_name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">num</span><span class="p">:</span>
                <span class="c1"># make sure we have num new RtMemory instances</span>
                <span class="n">rtmemory_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">RtMemory</span><span class="p">()</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">process_name</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">rtmemory_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># check if process name is contained within a predefined function,</span>
            <span class="c1"># e.g. &#39;int&#39; for &#39;integrate&#39;</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">REALTIME_PROCESS_FUNCTIONS</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">process_name</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="n">process_name</span> <span class="o">=</span> <span class="n">key</span>
                <span class="n">num</span> <span class="o">=</span> <span class="n">REALTIME_PROCESS_FUNCTIONS</span><span class="p">[</span><span class="n">process_name</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">num</span><span class="p">:</span>
                    <span class="c1"># make sure we have num new RtMemory instances</span>
                    <span class="n">rtmemory_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">RtMemory</span><span class="p">()</span> <span class="k">for</span> <span class="n">_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">)]</span>
                <span class="n">entry</span> <span class="o">=</span> <span class="p">(</span><span class="n">process_name</span><span class="p">,</span> <span class="n">options</span><span class="p">,</span> <span class="n">rtmemory_list</span><span class="p">)</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">entry</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t register process </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">process</span><span class="p">))</span>

        <span class="c1"># add process entry</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processing</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>

        <span class="c1"># add processing information to the stats dictionary</span>
        <span class="n">proc_info</span> <span class="o">=</span> <span class="s2">&quot;realtime_process:</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">process_name</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_internal_add_processing_info</span><span class="p">(</span><span class="n">proc_info</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processing</span><span class="p">)</span></div>

<div class="viewcode-block" id="RtTrace.copy"><a class="viewcode-back" href="../../../packages/autogen/obspy.realtime.rttrace.RtTrace.copy.html#obspy.realtime.rttrace.RtTrace.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a deepcopy of this RtTrace.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># XXX: ugly hack to allow deepcopy of an RtTrace object containing</span>
        <span class="c1"># registered NumPy function (numpy.ufunc) calls</span>
        <span class="n">temp</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">processing</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">processing</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">new</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">new</span><span class="o">.</span><span class="n">processing</span> <span class="o">=</span> <span class="n">temp</span>
        <span class="k">return</span> <span class="n">new</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">exclude_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a>™ &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, Ólafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Käufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhäusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaimé, Sébastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clément</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Köhler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n° 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>