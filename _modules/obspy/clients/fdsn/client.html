<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.clients.fdsn.client &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="http://docs.obspy.org/search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.clients.fdsn.client</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">FDSN Web service client for ObsPy.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org)</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="k">import</span> <span class="n">PY2</span><span class="p">,</span> <span class="n">native_str</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">gzip</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">socket</span> <span class="k">import</span> <span class="n">timeout</span> <span class="k">as</span> <span class="n">socket_timeout</span>
<span class="kn">import</span> <span class="nn">textwrap</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">OrderedDict</span>

<span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">version_info</span><span class="o">.</span><span class="n">major</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urllib</span> <span class="k">import</span> <span class="n">urlencode</span>
    <span class="kn">import</span> <span class="nn">urllib2</span> <span class="k">as</span> <span class="nn">urllib_request</span>
    <span class="kn">import</span> <span class="nn">Queue</span> <span class="k">as</span> <span class="nn">queue</span>
<span class="k">else</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="k">import</span> <span class="n">urlencode</span>
    <span class="kn">import</span> <span class="nn">urllib.request</span> <span class="k">as</span> <span class="nn">urllib_request</span>
    <span class="kn">import</span> <span class="nn">queue</span>

<span class="kn">from</span> <span class="nn">lxml</span> <span class="k">import</span> <span class="n">etree</span>

<span class="kn">import</span> <span class="nn">obspy</span>
<span class="kn">from</span> <span class="nn">obspy</span> <span class="k">import</span> <span class="n">UTCDateTime</span><span class="p">,</span> <span class="n">read_inventory</span>
<span class="kn">from</span> <span class="nn">.header</span> <span class="k">import</span> <span class="p">(</span><span class="n">DEFAULT_PARAMETERS</span><span class="p">,</span> <span class="n">DEFAULT_USER_AGENT</span><span class="p">,</span> <span class="n">FDSNWS</span><span class="p">,</span>
                     <span class="n">OPTIONAL_PARAMETERS</span><span class="p">,</span> <span class="n">PARAMETER_ALIASES</span><span class="p">,</span> <span class="n">URL_MAPPINGS</span><span class="p">,</span>
                     <span class="n">WADL_PARAMETERS_NOT_TO_BE_PARSED</span><span class="p">,</span> <span class="n">FDSNException</span><span class="p">,</span>
                     <span class="n">FDSNRedirectException</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.wadl_parser</span> <span class="k">import</span> <span class="n">WADLParser</span>


<span class="n">DEFAULT_SERVICE_VERSIONS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dataselect&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;station&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;event&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>


<div class="viewcode-block" id="CustomRedirectHandler"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.CustomRedirectHandler.html#obspy.clients.fdsn.client.CustomRedirectHandler">[docs]</a><span class="k">class</span> <span class="nc">CustomRedirectHandler</span><span class="p">(</span><span class="n">urllib_request</span><span class="o">.</span><span class="n">HTTPRedirectHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Custom redirection handler to also do it for POST requests which the</span>
<span class="sd">    standard library does not do by default.</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="CustomRedirectHandler.redirect_request"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.CustomRedirectHandler.redirect_request.html#obspy.clients.fdsn.client.CustomRedirectHandler.redirect_request">[docs]</a>    <span class="k">def</span> <span class="nf">redirect_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">newurl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copied and modified from the standard library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Force the same behaviour for GET, HEAD, and POST.</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">get_method</span><span class="p">()</span>
        <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="p">(</span><span class="n">code</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">301</span><span class="p">,</span> <span class="mi">302</span><span class="p">,</span> <span class="mi">303</span><span class="p">,</span> <span class="mi">307</span><span class="p">)</span> <span class="ow">and</span>
                 <span class="n">m</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="s2">&quot;HEAD&quot;</span><span class="p">,</span> <span class="s2">&quot;POST&quot;</span><span class="p">))):</span>
            <span class="k">raise</span> <span class="n">urllib_request</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">full_url</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span>
                                           <span class="n">fp</span><span class="p">)</span>

        <span class="c1"># be conciliant with URIs containing a space</span>
        <span class="n">newurl</span> <span class="o">=</span> <span class="n">newurl</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;%20&#39;</span><span class="p">)</span>
        <span class="n">content_headers</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;content-length&quot;</span><span class="p">,</span> <span class="s2">&quot;content-type&quot;</span><span class="p">)</span>
        <span class="n">newheaders</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">req</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                          <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">content_headers</span><span class="p">)</span>

        <span class="c1"># Also redirect the data of the request which the standard library</span>
        <span class="c1"># interestingly enough does not do.</span>
        <span class="k">return</span> <span class="n">urllib_request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span>
            <span class="n">newurl</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">newheaders</span><span class="p">,</span>
            <span class="n">data</span><span class="o">=</span><span class="n">req</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">origin_req_host</span><span class="o">=</span><span class="n">req</span><span class="o">.</span><span class="n">origin_req_host</span><span class="p">,</span>
            <span class="n">unverifiable</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="NoRedirectionHandler"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.NoRedirectionHandler.html#obspy.clients.fdsn.client.NoRedirectionHandler">[docs]</a><span class="k">class</span> <span class="nc">NoRedirectionHandler</span><span class="p">(</span><span class="n">urllib_request</span><span class="o">.</span><span class="n">HTTPRedirectHandler</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Handler that does not direct!</span>
<span class="sd">    &quot;&quot;&quot;</span>
<div class="viewcode-block" id="NoRedirectionHandler.redirect_request"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.NoRedirectionHandler.redirect_request.html#obspy.clients.fdsn.client.NoRedirectionHandler.redirect_request">[docs]</a>    <span class="k">def</span> <span class="nf">redirect_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">newurl</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Copied and modified from the standard library.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">raise</span> <span class="n">FDSNRedirectException</span><span class="p">(</span>
            <span class="s2">&quot;Requests with credentials (username, password) are not being &quot;</span>
            <span class="s2">&quot;redirected by default to improve security. To force redirects &quot;</span>
            <span class="s2">&quot;and if you trust the data center, set `force_redirect` to True &quot;</span>
            <span class="s2">&quot;when initializing the Client.&quot;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="Client"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.html#obspy.clients.fdsn.client.Client">[docs]</a><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    FDSN Web service request client.</span>

<span class="sd">    For details see the :meth:`~obspy.clients.fdsn.client.Client.__init__()`</span>
<span class="sd">    method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Dictionary caching any discovered service. Therefore repeatedly</span>
    <span class="c1"># initializing a client with the same base URL is cheap.</span>
    <span class="n">__service_discovery_cache</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">RE_UINT8</span> <span class="o">=</span> <span class="s1">&#39;(?:25[0-5]|2[0-4]\d|[0-1]?\d{1,2})&#39;</span>
    <span class="n">RE_HEX4</span> <span class="o">=</span> <span class="s1">&#39;(?:[\d,a-f]</span><span class="si">{4}</span><span class="s1">|[1-9,a-f][0-9,a-f]{0,2}|0)&#39;</span>

    <span class="n">RE_IPv4</span> <span class="o">=</span> <span class="s1">&#39;(?:&#39;</span> <span class="o">+</span> <span class="n">RE_UINT8</span> <span class="o">+</span> <span class="s1">&#39;(?:\.&#39;</span> <span class="o">+</span> <span class="n">RE_UINT8</span> <span class="o">+</span> <span class="s1">&#39;)</span><span class="si">{3}</span><span class="s1">)&#39;</span>
    <span class="n">RE_IPv6</span> <span class="o">=</span> \
        <span class="s1">&#39;(?:\[&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;(?::&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;)</span><span class="si">{7}</span><span class="s1">\]&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;|\[(?:&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;:){0,5}&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;::\]&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;|\[::&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;(?::&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;){0,5}\]&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;|\[::&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;(?::&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;){0,3}:&#39;</span> <span class="o">+</span> <span class="n">RE_IPv4</span> <span class="o">+</span> <span class="s1">&#39;\]&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;|\[&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;(?:&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;:|:&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;){0,4}&#39;</span> <span class="o">+</span> \
        <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="n">RE_HEX4</span> <span class="o">+</span> <span class="s1">&#39;\])&#39;</span>

    <span class="n">URL_REGEX</span> <span class="o">=</span> <span class="s1">&#39;https?://&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="n">RE_IPv4</span> <span class="o">+</span> \
                <span class="s1">&#39;|&#39;</span> <span class="o">+</span> <span class="n">RE_IPv6</span> <span class="o">+</span> \
                <span class="s1">&#39;|localhost&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;|\w+&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;|(?:\w(?:[\w-]{0,61}[\w])?\.){1,}([a-z]{2,6}))&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;(?::\d{2,5})?&#39;</span> <span class="o">+</span> \
                <span class="s1">&#39;(/[\w\.-]+)*/?$&#39;</span>

<div class="viewcode-block" id="Client._validate_base_url"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._validate_base_url.html#obspy.clients.fdsn.client.Client._validate_base_url">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_validate_base_url</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">base_url</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">URL_REGEX</span><span class="p">,</span> <span class="n">base_url</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">IGNORECASE</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Client.__init__"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.__init__.html#obspy.clients.fdsn.client.Client.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">base_url</span><span class="o">=</span><span class="s2">&quot;IRIS&quot;</span><span class="p">,</span> <span class="n">major_versions</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">user_agent</span><span class="o">=</span><span class="n">DEFAULT_USER_AGENT</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">timeout</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span> <span class="n">service_mappings</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_redirect</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes an FDSN Web Service client.</span>

<span class="sd">        &gt;&gt;&gt; client = Client(&quot;IRIS&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(client)  # doctest: +ELLIPSIS +NORMALIZE_WHITESPACE</span>
<span class="sd">        FDSN Webservice Client (base url: http://service.iris.edu)</span>
<span class="sd">        Available Services: &#39;dataselect&#39; (v...), &#39;event&#39; (v...),</span>
<span class="sd">        &#39;station&#39; (v...), &#39;available_event_catalogs&#39;,</span>
<span class="sd">        &#39;available_event_contributors&#39;</span>
<span class="sd">        Use e.g. client.help(&#39;dataselect&#39;) for the</span>
<span class="sd">        parameter description of the individual services</span>
<span class="sd">        or client.help() for parameter description of</span>
<span class="sd">        all webservices.</span>

<span class="sd">        :type base_url: str</span>
<span class="sd">        :param base_url: Base URL of FDSN web service compatible server</span>
<span class="sd">            (e.g. &quot;http://service.iris.edu&quot;) or key string for recognized</span>
<span class="sd">            server (one of %s).</span>
<span class="sd">        :type major_versions: dict</span>
<span class="sd">        :param major_versions: Allows to specify custom major version numbers</span>
<span class="sd">            for individual services (e.g.</span>
<span class="sd">            `major_versions={&#39;station&#39;: 2, &#39;dataselect&#39;: 3}`), otherwise the</span>
<span class="sd">            latest version at time of implementation will be used.</span>
<span class="sd">        :type user: str</span>
<span class="sd">        :param user: User name of HTTP Digest Authentication for access to</span>
<span class="sd">            restricted data.</span>
<span class="sd">        :type password: str</span>
<span class="sd">        :param password: Password of HTTP Digest Authentication for access to</span>
<span class="sd">            restricted data.</span>
<span class="sd">        :type user_agent: str</span>
<span class="sd">        :param user_agent: The user agent for all requests.</span>
<span class="sd">        :type debug: bool</span>
<span class="sd">        :param debug: Debug flag.</span>
<span class="sd">        :type timeout: float</span>
<span class="sd">        :param timeout: Maximum time (in seconds) to wait for a single request</span>
<span class="sd">            to receive the first byte of the response (after which an exception</span>
<span class="sd">            is raised).</span>
<span class="sd">        :type service_mappings: dict</span>
<span class="sd">        :param service_mappings: For advanced use only. Allows the direct</span>
<span class="sd">            setting of the endpoints of the different services. (e.g.</span>
<span class="sd">            ``service_mappings={&#39;station&#39;: &#39;http://example.com/test/stat/1&#39;}``)</span>
<span class="sd">            Valid keys are ``event``, ``station``, and ``dataselect``. This</span>
<span class="sd">            will overwrite the ``base_url`` and ``major_versions`` arguments.</span>
<span class="sd">            For all services not specified, the default default locations</span>
<span class="sd">            indicated by ``base_url`` and ``major_versions`` will be used. Any</span>
<span class="sd">            service that is manually specified as ``None`` (e.g.</span>
<span class="sd">            ``service_mappings={&#39;event&#39;: None}``) will be deactivated.</span>
<span class="sd">        :type force_redirect: bool</span>
<span class="sd">        :param force_redirect: By default the client will follow all HTTP</span>
<span class="sd">            redirects as long as no credentials (username and password)</span>
<span class="sd">            are given. If credentials are given it will raise an exception</span>
<span class="sd">            when a redirect is discovered. This is done to improve security.</span>
<span class="sd">            Settings this flag to ``True`` will force all redirects to be</span>
<span class="sd">            followed even if credentials are given.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>

        <span class="c1"># Cache for the webservice versions. This makes interactive use of</span>
        <span class="c1"># the client more convenient.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__version_cache</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># handle switch of SCEC to SCEDC, see #998</span>
        <span class="k">if</span> <span class="n">base_url</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;SCEC&quot;</span><span class="p">:</span>
            <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;SCEDC&quot;</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;FDSN short-URL &#39;SCEC&#39; has been replaced by &#39;SCEDC&#39;. &quot;</span>
                   <span class="s2">&quot;Please change to &#39;Client(&#39;SCEDC&#39;)&#39;. This re-routing will &quot;</span>
                   <span class="s2">&quot;be removed in a future release.&quot;</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># NIEP was misspelled for a while.</span>
        <span class="k">elif</span> <span class="n">base_url</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;NEIP&quot;</span><span class="p">:</span>
            <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;NIEP&quot;</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;FDSN short-URL &#39;NEIP&#39; has been replaced by &#39;NIEP&#39;. &quot;</span>
                   <span class="s2">&quot;Please change to &#39;Client(&#39;NIEP&#39;)&#39;. This re-routing will &quot;</span>
                   <span class="s2">&quot;be removed in a future release.&quot;</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># Deprecate FDSN URL-shortcut &#39;NERIES&#39; in favour of &#39;EMSC&#39;, see #1146.</span>
        <span class="c1"># TODO: remove in 0.12.x or 1.x release</span>
        <span class="k">elif</span> <span class="n">base_url</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;NERIES&quot;</span><span class="p">:</span>
            <span class="n">base_url</span> <span class="o">=</span> <span class="s2">&quot;EMSC&quot;</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;FDSN short-URL &#39;NERIES&#39; has been replaced by &#39;EMSC&#39;. &quot;</span>
                   <span class="s2">&quot;Please change to &#39;Client(&#39;EMSC&#39;)&#39;. This re-routing will &quot;</span>
                   <span class="s2">&quot;be removed in a future release.&quot;</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">base_url</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span> <span class="ow">in</span> <span class="n">URL_MAPPINGS</span><span class="p">:</span>
            <span class="n">base_url</span> <span class="o">=</span> <span class="n">URL_MAPPINGS</span><span class="p">[</span><span class="n">base_url</span><span class="o">.</span><span class="n">upper</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">base_url</span><span class="o">.</span><span class="n">isalpha</span><span class="p">():</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The FDSN service shortcut `</span><span class="si">{}</span><span class="s2">` is unknown.&quot;</span>\
                      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base_url</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Make sure the base_url does not end with a slash.</span>
        <span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>
        <span class="c1"># Catch invalid URLs to avoid confusing error messages</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_validate_base_url</span><span class="p">(</span><span class="n">base_url</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The FDSN service base URL `</span><span class="si">{}</span><span class="s2">` is not a valid URL.&quot;</span>\
                  <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">base_url</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span> <span class="o">=</span> <span class="n">base_url</span>

        <span class="c1"># Only add the authentication handler if required.</span>
        <span class="n">handlers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Create an OpenerDirector for HTTP Digest Authentication</span>
            <span class="n">password_mgr</span> <span class="o">=</span> <span class="n">urllib_request</span><span class="o">.</span><span class="n">HTTPPasswordMgrWithDefaultRealm</span><span class="p">()</span>
            <span class="n">password_mgr</span><span class="o">.</span><span class="n">add_password</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">base_url</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="p">)</span>
            <span class="n">handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">urllib_request</span><span class="o">.</span><span class="n">HTTPDigestAuthHandler</span><span class="p">(</span><span class="n">password_mgr</span><span class="p">))</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">or</span> <span class="n">force_redirect</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># Redirect if no credentials are given or the force_redirect</span>
            <span class="c1"># flag is True.</span>
            <span class="n">handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">CustomRedirectHandler</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">handlers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">NoRedirectionHandler</span><span class="p">())</span>

        <span class="c1"># Don&#39;t install globally to not mess with other codes.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_url_opener</span> <span class="o">=</span> <span class="n">urllib_request</span><span class="o">.</span><span class="n">build_opener</span><span class="p">(</span><span class="o">*</span><span class="n">handlers</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">request_headers</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;User-Agent&quot;</span><span class="p">:</span> <span class="n">user_agent</span><span class="p">}</span>
        <span class="c1"># Avoid mutable kwarg.</span>
        <span class="k">if</span> <span class="n">major_versions</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">major_versions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># Make a copy to avoid overwriting the default service versions.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">major_versions</span> <span class="o">=</span> <span class="n">DEFAULT_SERVICE_VERSIONS</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">major_versions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">major_versions</span><span class="p">)</span>

        <span class="c1"># Avoid mutable kwarg.</span>
        <span class="k">if</span> <span class="n">service_mappings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">service_mappings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_service_mappings</span> <span class="o">=</span> <span class="n">service_mappings</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Base URL: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_mappings</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Custom service mappings:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="si">%s</span><span class="s2">: &#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Request Headers: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">request_headers</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_discover_services</span><span class="p">()</span></div>

<div class="viewcode-block" id="Client.get_events"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.get_events.html#obspy.clients.fdsn.client.Client.get_events">[docs]</a>    <span class="k">def</span> <span class="nf">get_events</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starttime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minlatitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">maxlatitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minlongitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxlongitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minradius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">maxradius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mindepth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxdepth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">minmagnitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxmagnitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">magnitudetype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">includeallorigins</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">includeallmagnitudes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">includearrivals</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eventid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">limit</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">orderby</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">contributor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">updatedafter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the event service of the client.</span>

<span class="sd">        &gt;&gt;&gt; client = Client(&quot;IRIS&quot;)</span>
<span class="sd">        &gt;&gt;&gt; cat = client.get_events(eventid=609301)</span>
<span class="sd">        &gt;&gt;&gt; print(cat)</span>
<span class="sd">        1 Event(s) in Catalog:</span>
<span class="sd">        1997-10-14T09:53:11.070000Z | -22.145, -176.720 | 7.8 mw</span>

<span class="sd">        The return value is a :class:`~obspy.core.event.Catalog` object</span>
<span class="sd">        which can contain any number of events.</span>

<span class="sd">        &gt;&gt;&gt; t1 = UTCDateTime(&quot;2001-01-07T00:00:00&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t2 = UTCDateTime(&quot;2001-01-07T03:00:00&quot;)</span>
<span class="sd">        &gt;&gt;&gt; cat = client.get_events(starttime=t1, endtime=t2, minmagnitude=4,</span>
<span class="sd">        ...                         catalog=&quot;ISC&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(cat)</span>
<span class="sd">        3 Event(s) in Catalog:</span>
<span class="sd">        2001-01-07T02:55:59.290000Z |  +9.801,  +76.548 | 4.9 mb</span>
<span class="sd">        2001-01-07T02:35:35.170000Z | -21.291,  -68.308 | 4.4 mb</span>
<span class="sd">        2001-01-07T00:09:25.630000Z | +22.946, -107.011 | 4.0 mb</span>

<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`, optional</span>
<span class="sd">        :param starttime: Limit to events on or after the specified start time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`, optional</span>
<span class="sd">        :param endtime: Limit to events on or before the specified end time.</span>
<span class="sd">        :type minlatitude: float, optional</span>
<span class="sd">        :param minlatitude: Limit to events with a latitude larger than the</span>
<span class="sd">            specified minimum.</span>
<span class="sd">        :type maxlatitude: float, optional</span>
<span class="sd">        :param maxlatitude: Limit to events with a latitude smaller than the</span>
<span class="sd">            specified maximum.</span>
<span class="sd">        :type minlongitude: float, optional</span>
<span class="sd">        :param minlongitude: Limit to events with a longitude larger than the</span>
<span class="sd">            specified minimum.</span>
<span class="sd">        :type maxlongitude: float, optional</span>
<span class="sd">        :param maxlongitude: Limit to events with a longitude smaller than the</span>
<span class="sd">            specified maximum.</span>
<span class="sd">        :type latitude: float, optional</span>
<span class="sd">        :param latitude: Specify the latitude to be used for a radius search.</span>
<span class="sd">        :type longitude: float, optional</span>
<span class="sd">        :param longitude: Specify the longitude to the used for a radius</span>
<span class="sd">            search.</span>
<span class="sd">        :type minradius: float, optional</span>
<span class="sd">        :param minradius: Limit to events within the specified minimum number</span>
<span class="sd">            of degrees from the geographic point defined by the latitude and</span>
<span class="sd">            longitude parameters.</span>
<span class="sd">        :type maxradius: float, optional</span>
<span class="sd">        :param maxradius: Limit to events within the specified maximum number</span>
<span class="sd">            of degrees from the geographic point defined by the latitude and</span>
<span class="sd">            longitude parameters.</span>
<span class="sd">        :type mindepth: float, optional</span>
<span class="sd">        :param mindepth: Limit to events with depth, in kilometers, larger than</span>
<span class="sd">            the specified minimum.</span>
<span class="sd">        :type maxdepth: float, optional</span>
<span class="sd">        :param maxdepth: Limit to events with depth, in kilometers, smaller</span>
<span class="sd">            than the specified maximum.</span>
<span class="sd">        :type minmagnitude: float, optional</span>
<span class="sd">        :param minmagnitude: Limit to events with a magnitude larger than the</span>
<span class="sd">            specified minimum.</span>
<span class="sd">        :type maxmagnitude: float, optional</span>
<span class="sd">        :param maxmagnitude: Limit to events with a magnitude smaller than the</span>
<span class="sd">            specified maximum.</span>
<span class="sd">        :type magnitudetype: str, optional</span>
<span class="sd">        :param magnitudetype: Specify a magnitude type to use for testing the</span>
<span class="sd">            minimum and maximum limits.</span>
<span class="sd">        :type includeallorigins: bool, optional</span>
<span class="sd">        :param includeallorigins: Specify if all origins for the event should</span>
<span class="sd">            be included, default is data center dependent but is suggested to</span>
<span class="sd">            be the preferred origin only.</span>
<span class="sd">        :type includeallmagnitudes: bool, optional</span>
<span class="sd">        :param includeallmagnitudes: Specify if all magnitudes for the event</span>
<span class="sd">            should be included, default is data center dependent but is</span>
<span class="sd">            suggested to be the preferred magnitude only.</span>
<span class="sd">        :type includearrivals: bool, optional</span>
<span class="sd">        :param includearrivals: Specify if phase arrivals should be included.</span>
<span class="sd">        :type eventid: str (or int, dependent on data center), optional</span>
<span class="sd">        :param eventid: Select a specific event by ID; event identifiers are</span>
<span class="sd">            data center specific.</span>
<span class="sd">        :type limit: int, optional</span>
<span class="sd">        :param limit: Limit the results to the specified number of events.</span>
<span class="sd">        :type offset: int, optional</span>
<span class="sd">        :param offset: Return results starting at the event count specified,</span>
<span class="sd">            starting at 1.</span>
<span class="sd">        :type orderby: str, optional</span>
<span class="sd">        :param orderby: Order the result by time or magnitude with the</span>
<span class="sd">            following possibilities:</span>

<span class="sd">            * time: order by origin descending time</span>
<span class="sd">            * time-asc: order by origin ascending time</span>
<span class="sd">            * magnitude: order by descending magnitude</span>
<span class="sd">            * magnitude-asc: order by ascending magnitude</span>

<span class="sd">        :type catalog: str, optional</span>
<span class="sd">        :param catalog: Limit to events from a specified catalog</span>
<span class="sd">        :type contributor: str, optional</span>
<span class="sd">        :param contributor: Limit to events contributed by a specified</span>
<span class="sd">            contributor.</span>
<span class="sd">        :type updatedafter: :class:`~obspy.core.utcdatetime.UTCDateTime`,</span>
<span class="sd">            optional</span>
<span class="sd">        :param updatedafter: Limit to events updated after the specified time.</span>
<span class="sd">        :type filename: str or file</span>
<span class="sd">        :param filename: If given, the downloaded data will be saved there</span>
<span class="sd">            instead of being parse to an ObsPy object. Thus it will contain the</span>
<span class="sd">            raw data from the webservices.</span>


<span class="sd">        Any additional keyword arguments will be passed to the webservice as</span>
<span class="sd">        additional arguments. If you pass one of the default parameters and the</span>
<span class="sd">        webservice does not support it, a warning will be issued. Passing any</span>
<span class="sd">        non-default parameters that the webservice does not support will raise</span>
<span class="sd">        an error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;event&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The current client does not have an event service.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">locs</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        <span class="n">setup_query_dict</span><span class="p">(</span><span class="s1">&#39;event&#39;</span><span class="p">,</span> <span class="n">locs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_url_from_parameters</span><span class="p">(</span>
            <span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="n">DEFAULT_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;event&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="n">data_stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">data_stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_to_file_object</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cat</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read_events</span><span class="p">(</span><span class="n">data_stream</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;quakeml&quot;</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">cat</span></div>

<div class="viewcode-block" id="Client.get_stations"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.get_stations.html#obspy.clients.fdsn.client.Client.get_stations">[docs]</a>    <span class="k">def</span> <span class="nf">get_stations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starttime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">startbefore</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">startafter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endbefore</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">endafter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">network</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">minlatitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxlatitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minlongitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">maxlongitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">minradius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxradius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">includerestricted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">includeavailability</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">updatedafter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">matchtimeseries</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;xml&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the station service of the FDSN client.</span>

<span class="sd">        &gt;&gt;&gt; client = Client(&quot;IRIS&quot;)</span>
<span class="sd">        &gt;&gt;&gt; starttime = UTCDateTime(&quot;2001-01-01&quot;)</span>
<span class="sd">        &gt;&gt;&gt; endtime = UTCDateTime(&quot;2001-01-02&quot;)</span>
<span class="sd">        &gt;&gt;&gt; inventory = client.get_stations(network=&quot;IU&quot;, station=&quot;A*&quot;,</span>
<span class="sd">        ...                                 starttime=starttime,</span>
<span class="sd">        ...                                 endtime=endtime)</span>
<span class="sd">        &gt;&gt;&gt; print(inventory)  # doctest: +ELLIPSIS +NORMALIZE_WHITESPACE</span>
<span class="sd">        Inventory created at ...</span>
<span class="sd">            Created by: IRIS WEB SERVICE: fdsnws-station | version: ...</span>
<span class="sd">                        ...</span>
<span class="sd">            Sending institution: IRIS-DMC (IRIS-DMC)</span>
<span class="sd">            Contains:</span>
<span class="sd">                    Networks (1):</span>
<span class="sd">                            IU</span>
<span class="sd">                    Stations (3):</span>
<span class="sd">                            IU.ADK (Adak, Aleutian Islands, Alaska)</span>
<span class="sd">                            IU.AFI (Afiamalu, Samoa)</span>
<span class="sd">                            IU.ANMO (Albuquerque, New Mexico, USA)</span>
<span class="sd">                    Channels (0):</span>
<span class="sd">        &gt;&gt;&gt; inventory.plot()  # doctest: +SKIP</span>

<span class="sd">        .. plot::</span>

<span class="sd">            from obspy import UTCDateTime</span>
<span class="sd">            from obspy.clients.fdsn import Client</span>
<span class="sd">            client = Client()</span>
<span class="sd">            starttime = UTCDateTime(&quot;2001-01-01&quot;)</span>
<span class="sd">            endtime = UTCDateTime(&quot;2001-01-02&quot;)</span>
<span class="sd">            inventory = client.get_stations(network=&quot;IU&quot;, station=&quot;A*&quot;,</span>
<span class="sd">                                            starttime=starttime,</span>
<span class="sd">                                            endtime=endtime)</span>
<span class="sd">            inventory.plot()</span>


<span class="sd">        The result is an :class:`~obspy.core.inventory.inventory.Inventory`</span>
<span class="sd">        object which models a StationXML file.</span>

<span class="sd">        The ``level`` argument determines the amount of returned information.</span>
<span class="sd">        ``level=&quot;station&quot;`` is useful for availability queries whereas</span>
<span class="sd">        ``level=&quot;response&quot;`` returns the full response information for the</span>
<span class="sd">        requested channels. ``level`` can furthermore be set to ``&quot;network&quot;``</span>
<span class="sd">        and ``&quot;channel&quot;``.</span>

<span class="sd">        &gt;&gt;&gt; inventory = client.get_stations(</span>
<span class="sd">        ...     starttime=starttime, endtime=endtime,</span>
<span class="sd">        ...     network=&quot;IU&quot;, sta=&quot;ANMO&quot;, loc=&quot;00&quot;, channel=&quot;*Z&quot;,</span>
<span class="sd">        ...     level=&quot;response&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(inventory)  # doctest: +ELLIPSIS +NORMALIZE_WHITESPACE</span>
<span class="sd">        Inventory created at ...</span>
<span class="sd">            Created by: IRIS WEB SERVICE: fdsnws-station | version: ...</span>
<span class="sd">                        ...</span>
<span class="sd">            Sending institution: IRIS-DMC (IRIS-DMC)</span>
<span class="sd">            Contains:</span>
<span class="sd">                Networks (1):</span>
<span class="sd">                    IU</span>
<span class="sd">                Stations (1):</span>
<span class="sd">                    IU.ANMO (Albuquerque, New Mexico, USA)</span>
<span class="sd">                Channels (4):</span>
<span class="sd">                    IU.ANMO.00.BHZ, IU.ANMO.00.LHZ, IU.ANMO.00.UHZ,</span>
<span class="sd">                    IU.ANMO.00.VHZ</span>
<span class="sd">        &gt;&gt;&gt; inventory[0].plot_response(min_freq=1E-4)  # doctest: +SKIP</span>

<span class="sd">        .. plot::</span>

<span class="sd">            from obspy import UTCDateTime</span>
<span class="sd">            from obspy.clients.fdsn import Client</span>
<span class="sd">            client = Client()</span>
<span class="sd">            starttime = UTCDateTime(&quot;2001-01-01&quot;)</span>
<span class="sd">            endtime = UTCDateTime(&quot;2001-01-02&quot;)</span>
<span class="sd">            inventory = client.get_stations(</span>
<span class="sd">                starttime=starttime, endtime=endtime,</span>
<span class="sd">                network=&quot;IU&quot;, sta=&quot;ANMO&quot;, loc=&quot;00&quot;, channel=&quot;*Z&quot;,</span>
<span class="sd">                level=&quot;response&quot;)</span>
<span class="sd">            inventory[0].plot_response(min_freq=1E-4)</span>

<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Limit to metadata epochs starting on or after the</span>
<span class="sd">            specified start time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: Limit to metadata epochs ending on or before the</span>
<span class="sd">            specified end time.</span>
<span class="sd">        :type startbefore: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param startbefore: Limit to metadata epochs starting before specified</span>
<span class="sd">            time.</span>
<span class="sd">        :type startafter: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param startafter: Limit to metadata epochs starting after specified</span>
<span class="sd">            time.</span>
<span class="sd">        :type endbefore: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endbefore: Limit to metadata epochs ending before specified</span>
<span class="sd">            time.</span>
<span class="sd">        :type endafter: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endafter: Limit to metadata epochs ending after specified time.</span>
<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Select one or more network codes. Can be SEED network</span>
<span class="sd">            codes or data center defined codes. Multiple codes are</span>
<span class="sd">            comma-separated (e.g. ``&quot;IU,TA&quot;``).</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Select one or more SEED station codes. Multiple codes</span>
<span class="sd">            are comma-separated (e.g. ``&quot;ANMO,PFO&quot;``).</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Select one or more SEED location identifiers. Multiple</span>
<span class="sd">            identifiers are comma-separated (e.g. ``&quot;00,01&quot;``).  As a</span>
<span class="sd">            special case ``“--“`` (two dashes) will be translated to a string</span>
<span class="sd">            of two space characters to match blank location IDs.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Select one or more SEED channel codes. Multiple codes</span>
<span class="sd">            are comma-separated (e.g. ``&quot;BHZ,HHZ&quot;``).</span>
<span class="sd">        :type minlatitude: float</span>
<span class="sd">        :param minlatitude: Limit to stations with a latitude larger than the</span>
<span class="sd">            specified minimum.</span>
<span class="sd">        :type maxlatitude: float</span>
<span class="sd">        :param maxlatitude: Limit to stations with a latitude smaller than the</span>
<span class="sd">            specified maximum.</span>
<span class="sd">        :type minlongitude: float</span>
<span class="sd">        :param minlongitude: Limit to stations with a longitude larger than the</span>
<span class="sd">            specified minimum.</span>
<span class="sd">        :type maxlongitude: float</span>
<span class="sd">        :param maxlongitude: Limit to stations with a longitude smaller than</span>
<span class="sd">            the specified maximum.</span>
<span class="sd">        :type latitude: float</span>
<span class="sd">        :param latitude: Specify the latitude to be used for a radius search.</span>
<span class="sd">        :type longitude: float</span>
<span class="sd">        :param longitude: Specify the longitude to the used for a radius</span>
<span class="sd">            search.</span>
<span class="sd">        :type minradius: float</span>
<span class="sd">        :param minradius: Limit results to stations within the specified</span>
<span class="sd">            minimum number of degrees from the geographic point defined by the</span>
<span class="sd">            latitude and longitude parameters.</span>
<span class="sd">        :type maxradius: float</span>
<span class="sd">        :param maxradius: Limit results to stations within the specified</span>
<span class="sd">            maximum number of degrees from the geographic point defined by the</span>
<span class="sd">            latitude and longitude parameters.</span>
<span class="sd">        :type level: str</span>
<span class="sd">        :param level: Specify the level of detail for the results (&quot;network&quot;,</span>
<span class="sd">            &quot;station&quot;, &quot;channel&quot;, &quot;response&quot;), e.g. specify &quot;response&quot; to get</span>
<span class="sd">            full information including instrument response for each channel.</span>
<span class="sd">        :type includerestricted: bool</span>
<span class="sd">        :param includerestricted: Specify if results should include information</span>
<span class="sd">            for restricted stations.</span>
<span class="sd">        :type includeavailability: bool</span>
<span class="sd">        :param includeavailability: Specify if results should include</span>
<span class="sd">            information about time series data availability.</span>
<span class="sd">        :type updatedafter: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param updatedafter: Limit to metadata updated after specified date;</span>
<span class="sd">            updates are data center specific.</span>
<span class="sd">        :type matchtimeseries: bool</span>
<span class="sd">        :param matchtimeseries: Only include data for which matching time</span>
<span class="sd">            series data is available.</span>
<span class="sd">        :type filename: str or file</span>
<span class="sd">        :param filename: If given, the downloaded data will be saved there</span>
<span class="sd">            instead of being parse to an ObsPy object. Thus it will contain the</span>
<span class="sd">            raw data from the webservices.</span>
<span class="sd">        :type format: str</span>
<span class="sd">        :param format: The format in which to request station information.</span>
<span class="sd">            ``&quot;xml&quot;`` (StationXML) or ``&quot;text&quot;`` (FDSN station test format).</span>
<span class="sd">            XML has more information but text is much faster.</span>

<span class="sd">        :rtype: :class:`~obspy.core.inventory.inventory.Inventory`</span>
<span class="sd">        :returns: Inventory with requested station information.</span>

<span class="sd">        Any additional keyword arguments will be passed to the webservice as</span>
<span class="sd">        additional arguments. If you pass one of the default parameters and the</span>
<span class="sd">        webservice does not support it, a warning will be issued. Passing any</span>
<span class="sd">        non-default parameters that the webservice does not support will raise</span>
<span class="sd">        an error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;station&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The current client does not have a station service.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">locs</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        <span class="n">setup_query_dict</span><span class="p">(</span><span class="s1">&#39;station&#39;</span><span class="p">,</span> <span class="n">locs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_url_from_parameters</span><span class="p">(</span>
            <span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="n">DEFAULT_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;station&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="n">data_stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">data_stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_to_file_object</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># This works with XML and StationXML data.</span>
            <span class="n">inventory</span> <span class="o">=</span> <span class="n">read_inventory</span><span class="p">(</span><span class="n">data_stream</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">inventory</span></div>

<div class="viewcode-block" id="Client.get_waveforms"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.get_waveforms.html#obspy.clients.fdsn.client.Client.get_waveforms">[docs]</a>    <span class="k">def</span> <span class="nf">get_waveforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">starttime</span><span class="p">,</span>
                      <span class="n">endtime</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimumlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">longestonly</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attach_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the dataselect service of the client.</span>

<span class="sd">        &gt;&gt;&gt; client = Client(&quot;IRIS&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t1 = UTCDateTime(&quot;2010-02-27T06:30:00.000&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t2 = t1 + 5</span>
<span class="sd">        &gt;&gt;&gt; st = client.get_waveforms(&quot;IU&quot;, &quot;ANMO&quot;, &quot;00&quot;, &quot;LHZ&quot;, t1, t2)</span>
<span class="sd">        &gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS</span>
<span class="sd">        1 Trace(s) in Stream:</span>
<span class="sd">        IU.ANMO.00.LHZ | 2010-02-27T06:30:00.069538Z - ... | 1.0 Hz, 5 samples</span>

<span class="sd">        The services can deal with UNIX style wildcards.</span>

<span class="sd">        &gt;&gt;&gt; st = client.get_waveforms(&quot;IU&quot;, &quot;A*&quot;, &quot;1?&quot;, &quot;LHZ&quot;, t1, t2)</span>
<span class="sd">        &gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS</span>
<span class="sd">        3 Trace(s) in Stream:</span>
<span class="sd">        IU.ADK.10.LHZ  | 2010-02-27T06:30:00.069538Z - ... | 1.0 Hz, 5 samples</span>
<span class="sd">        IU.AFI.10.LHZ  | 2010-02-27T06:30:00.069538Z - ... | 1.0 Hz, 5 samples</span>
<span class="sd">        IU.ANMO.10.LHZ | 2010-02-27T06:30:00.069538Z - ... | 1.0 Hz, 5 samples</span>

<span class="sd">        Use ``attach_response=True`` to automatically add response information</span>
<span class="sd">        to each trace. This can be used to remove response using</span>
<span class="sd">        :meth:`~obspy.core.stream.Stream.remove_response`.</span>

<span class="sd">        &gt;&gt;&gt; t = UTCDateTime(&quot;2012-12-14T10:36:01.6Z&quot;)</span>
<span class="sd">        &gt;&gt;&gt; st = client.get_waveforms(&quot;TA&quot;, &quot;E42A&quot;, &quot;*&quot;, &quot;BH?&quot;, t+300, t+400,</span>
<span class="sd">        ...                           attach_response=True)</span>
<span class="sd">        &gt;&gt;&gt; st.remove_response(output=&quot;VEL&quot;) # doctest: +ELLIPSIS</span>
<span class="sd">        &lt;obspy.core.stream.Stream object at ...&gt;</span>
<span class="sd">        &gt;&gt;&gt; st.plot()  # doctest: +SKIP</span>

<span class="sd">        .. plot::</span>

<span class="sd">            from obspy import UTCDateTime</span>
<span class="sd">            from obspy.clients.fdsn import Client</span>
<span class="sd">            client = Client(&quot;IRIS&quot;)</span>
<span class="sd">            t = UTCDateTime(&quot;2012-12-14T10:36:01.6Z&quot;)</span>
<span class="sd">            st = client.get_waveforms(&quot;TA&quot;, &quot;E42A&quot;, &quot;*&quot;, &quot;BH?&quot;, t+300, t+400,</span>
<span class="sd">                                      attach_response=True)</span>
<span class="sd">            st.remove_response(output=&quot;VEL&quot;)</span>
<span class="sd">            st.plot()</span>

<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Select one or more network codes. Can be SEED network</span>
<span class="sd">            codes or data center defined codes. Multiple codes are</span>
<span class="sd">            comma-separated (e.g. ``&quot;IU,TA&quot;``). Wildcards are allowed.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Select one or more SEED station codes. Multiple codes</span>
<span class="sd">            are comma-separated (e.g. ``&quot;ANMO,PFO&quot;``). Wildcards are allowed.</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Select one or more SEED location identifiers. Multiple</span>
<span class="sd">            identifiers are comma-separated (e.g. ``&quot;00,01&quot;``). Wildcards are</span>
<span class="sd">            allowed.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Select one or more SEED channel codes. Multiple codes</span>
<span class="sd">            are comma-separated (e.g. ``&quot;BHZ,HHZ&quot;``).</span>
<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Limit results to time series samples on or after the</span>
<span class="sd">            specified start time</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: Limit results to time series samples on or before the</span>
<span class="sd">            specified end time</span>
<span class="sd">        :type quality: str, optional</span>
<span class="sd">        :param quality: Select a specific SEED quality indicator, handling is</span>
<span class="sd">            data center dependent.</span>
<span class="sd">        :type minimumlength: float, optional</span>
<span class="sd">        :param minimumlength: Limit results to continuous data segments of a</span>
<span class="sd">            minimum length specified in seconds.</span>
<span class="sd">        :type longestonly: bool, optional</span>
<span class="sd">        :param longestonly: Limit results to the longest continuous segment per</span>
<span class="sd">            channel.</span>
<span class="sd">        :type filename: str or file</span>
<span class="sd">        :param filename: If given, the downloaded data will be saved there</span>
<span class="sd">            instead of being parse to an ObsPy object. Thus it will contain the</span>
<span class="sd">            raw data from the webservices.</span>
<span class="sd">        :type attach_response: bool</span>
<span class="sd">        :param attach_response: Specify whether the station web service should</span>
<span class="sd">            be used to automatically attach response information to each trace</span>
<span class="sd">            in the result set. A warning will be shown if a response can not be</span>
<span class="sd">            found for a channel. Does nothing if output to a file was</span>
<span class="sd">            specified.</span>

<span class="sd">        Any additional keyword arguments will be passed to the webservice as</span>
<span class="sd">        additional arguments. If you pass one of the default parameters and the</span>
<span class="sd">        webservice does not support it, a warning will be issued. Passing any</span>
<span class="sd">        non-default parameters that the webservice does not support will raise</span>
<span class="sd">        an error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;dataselect&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The current client does not have a dataselect service.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">locs</span> <span class="o">=</span> <span class="nb">locals</span><span class="p">()</span>
        <span class="n">setup_query_dict</span><span class="p">(</span><span class="s1">&#39;dataselect&#39;</span><span class="p">,</span> <span class="n">locs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Special location handling. Convert empty strings to &quot;--&quot;.</span>
        <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_create_url_from_parameters</span><span class="p">(</span>
            <span class="s2">&quot;dataselect&quot;</span><span class="p">,</span> <span class="n">DEFAULT_PARAMETERS</span><span class="p">[</span><span class="s1">&#39;dataselect&#39;</span><span class="p">],</span> <span class="n">kwargs</span><span class="p">)</span>

        <span class="c1"># Gzip not worth it for MiniSEED and most likely disabled for this</span>
        <span class="c1"># route in any case.</span>
        <span class="n">data_stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">use_gzip</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">data_stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_to_file_object</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data_stream</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;MSEED&quot;</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">attach_response</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_attach_responses</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">st</span></div>

<div class="viewcode-block" id="Client._attach_responses"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._attach_responses.html#obspy.clients.fdsn.client.Client._attach_responses">[docs]</a>    <span class="k">def</span> <span class="nf">_attach_responses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">st</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Helper method to fetch response via get_stations() and attach it to</span>
<span class="sd">        each trace in stream.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">netids</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">st</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tr</span><span class="o">.</span><span class="n">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">netids</span><span class="p">:</span>
                <span class="n">netids</span><span class="p">[</span><span class="n">tr</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="p">,</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">netids</span><span class="p">[</span><span class="n">tr</span><span class="o">.</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="nb">min</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">starttime</span><span class="p">,</span> <span class="n">netids</span><span class="p">[</span><span class="n">tr</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]),</span>
                <span class="nb">max</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">endtime</span><span class="p">,</span> <span class="n">netids</span><span class="p">[</span><span class="n">tr</span><span class="o">.</span><span class="n">id</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>

        <span class="n">inventories</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">netids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">net</span><span class="p">,</span> <span class="n">sta</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">chan</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">inventories</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_stations</span><span class="p">(</span>
                    <span class="n">network</span><span class="o">=</span><span class="n">net</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="n">sta</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">loc</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">chan</span><span class="p">,</span>
                    <span class="n">starttime</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="s2">&quot;response&quot;</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="n">st</span><span class="o">.</span><span class="n">attach_response</span><span class="p">(</span><span class="n">inventories</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.get_waveforms_bulk"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.get_waveforms_bulk.html#obspy.clients.fdsn.client.Client.get_waveforms_bulk">[docs]</a>    <span class="k">def</span> <span class="nf">get_waveforms_bulk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk</span><span class="p">,</span> <span class="n">quality</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">minimumlength</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">longestonly</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">attach_response</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the dataselect service of the client. Bulk request.</span>

<span class="sd">        Send a bulk request for waveforms to the server. `bulk` can either be</span>
<span class="sd">        specified as a filename, a file-like object or a string (with</span>
<span class="sd">        information formatted according to the FDSN standard) or a list of</span>
<span class="sd">        lists (each specifying network, station, location, channel, starttime</span>
<span class="sd">        and endtime). See examples and parameter description for more</span>
<span class="sd">        details.</span>

<span class="sd">        `bulk` can be provided in the following forms:</span>

<span class="sd">        (1) As a list of lists. Each list item has to be list of network,</span>
<span class="sd">            station, location, channel, starttime and endtime.</span>

<span class="sd">        (2) As a valid request string/file as defined in the</span>
<span class="sd">            `FDSNWS documentation &lt;https://www.fdsn.org/webservices/&gt;`_.</span>
<span class="sd">            The request information can be provided as a..</span>

<span class="sd">            - a string containing the request information</span>
<span class="sd">            - a string with the path to a local file with the request</span>
<span class="sd">            - an open file handle (or file-like object) with the request</span>

<span class="sd">        &gt;&gt;&gt; client = Client(&quot;IRIS&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t1 = UTCDateTime(&quot;2010-02-27T06:30:00.000&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t2 = t1 + 1</span>
<span class="sd">        &gt;&gt;&gt; t3 = t1 + 3</span>
<span class="sd">        &gt;&gt;&gt; bulk = [(&quot;IU&quot;, &quot;ANMO&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2),</span>
<span class="sd">        ...         (&quot;IU&quot;, &quot;AFI&quot;, &quot;1?&quot;, &quot;BHE&quot;, t1, t3),</span>
<span class="sd">        ...         (&quot;GR&quot;, &quot;GRA1&quot;, &quot;*&quot;, &quot;BH*&quot;, t2, t3)]</span>
<span class="sd">        &gt;&gt;&gt; st = client.get_waveforms_bulk(bulk)</span>
<span class="sd">        &gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS</span>
<span class="sd">        5 Trace(s) in Stream:</span>
<span class="sd">        GR.GRA1..BHE   | 2010-02-27T06:30:01... | 20.0 Hz, 40 samples</span>
<span class="sd">        GR.GRA1..BHN   | 2010-02-27T06:30:01... | 20.0 Hz, 40 samples</span>
<span class="sd">        GR.GRA1..BHZ   | 2010-02-27T06:30:01... | 20.0 Hz, 40 samples</span>
<span class="sd">        IU.ANMO.00.BHZ | 2010-02-27T06:30:00... | 20.0 Hz, 20 samples</span>
<span class="sd">        IU.ANMO.10.BHZ | 2010-02-27T06:30:00... | 40.0 Hz, 40 samples</span>
<span class="sd">        &gt;&gt;&gt; bulk = &#39;quality=B\n&#39; + \</span>
<span class="sd">        ...        &#39;longestonly=false\n&#39; + \</span>
<span class="sd">        ...        &#39;IU ANMO * BHZ 2010-02-27 2010-02-27T00:00:02\n&#39; + \</span>
<span class="sd">        ...        &#39;IU AFI 1? BHE 2010-02-27 2010-02-27T00:00:04\n&#39; + \</span>
<span class="sd">        ...        &#39;GR GRA1 * BH? 2010-02-27 2010-02-27T00:00:02\n&#39;</span>
<span class="sd">        &gt;&gt;&gt; st = client.get_waveforms_bulk(bulk)</span>
<span class="sd">        &gt;&gt;&gt; print(st)  # doctest: +ELLIPSIS</span>
<span class="sd">        5 Trace(s) in Stream:</span>
<span class="sd">        GR.GRA1..BHE   | 2010-02-27T00:00:00... | 20.0 Hz, 40 samples</span>
<span class="sd">        GR.GRA1..BHN   | 2010-02-27T00:00:00... | 20.0 Hz, 40 samples</span>
<span class="sd">        GR.GRA1..BHZ   | 2010-02-27T00:00:00... | 20.0 Hz, 40 samples</span>
<span class="sd">        IU.ANMO.00.BHZ | 2010-02-27T00:00:00... | 20.0 Hz, 40 samples</span>
<span class="sd">        IU.ANMO.10.BHZ | 2010-02-27T00:00:00... | 40.0 Hz, 80 samples</span>
<span class="sd">        &gt;&gt;&gt; st = client.get_waveforms_bulk(&quot;/tmp/request.txt&quot;) \</span>
<span class="sd">        ...     # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; print(st)  # doctest: +SKIP</span>
<span class="sd">        5 Trace(s) in Stream:</span>
<span class="sd">        GR.GRA1..BHE   | 2010-02-27T00:00:00... | 20.0 Hz, 40 samples</span>
<span class="sd">        GR.GRA1..BHN   | 2010-02-27T00:00:00... | 20.0 Hz, 40 samples</span>
<span class="sd">        GR.GRA1..BHZ   | 2010-02-27T00:00:00... | 20.0 Hz, 40 samples</span>
<span class="sd">        IU.ANMO.00.BHZ | 2010-02-27T00:00:00... | 20.0 Hz, 40 samples</span>
<span class="sd">        IU.ANMO.10.BHZ | 2010-02-27T00:00:00... | 40.0 Hz, 80 samples</span>
<span class="sd">        &gt;&gt;&gt; t = UTCDateTime(&quot;2012-12-14T10:36:01.6Z&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t1 = t + 300</span>
<span class="sd">        &gt;&gt;&gt; t2 = t + 400</span>
<span class="sd">        &gt;&gt;&gt; bulk = [(&quot;TA&quot;, &quot;S42A&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2),</span>
<span class="sd">        ...         (&quot;TA&quot;, &quot;W42A&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2),</span>
<span class="sd">        ...         (&quot;TA&quot;, &quot;Z42A&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2)]</span>
<span class="sd">        &gt;&gt;&gt; st = client.get_waveforms_bulk(bulk, attach_response=True)</span>
<span class="sd">        &gt;&gt;&gt; st.remove_response(output=&quot;VEL&quot;) # doctest: +ELLIPSIS</span>
<span class="sd">        &lt;obspy.core.stream.Stream object at ...&gt;</span>
<span class="sd">        &gt;&gt;&gt; st.plot()  # doctest: +SKIP</span>

<span class="sd">        .. plot::</span>

<span class="sd">            from obspy import UTCDateTime</span>
<span class="sd">            from obspy.clients.fdsn import Client</span>
<span class="sd">            client = Client(&quot;IRIS&quot;)</span>
<span class="sd">            t = UTCDateTime(&quot;2012-12-14T10:36:01.6Z&quot;)</span>
<span class="sd">            t1 = t + 300</span>
<span class="sd">            t2 = t + 400</span>
<span class="sd">            bulk = [(&quot;TA&quot;, &quot;S42A&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2),</span>
<span class="sd">                    (&quot;TA&quot;, &quot;W42A&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2),</span>
<span class="sd">                    (&quot;TA&quot;, &quot;Z42A&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2)]</span>
<span class="sd">            st = client.get_waveforms_bulk(bulk, attach_response=True)</span>
<span class="sd">            st.remove_response(output=&quot;VEL&quot;)</span>
<span class="sd">            st.plot()</span>

<span class="sd">        .. note::</span>

<span class="sd">            Use `attach_response=True` to automatically add response</span>
<span class="sd">            information to each trace. This can be used to remove response</span>
<span class="sd">            using :meth:`~obspy.core.stream.Stream.remove_response`.</span>

<span class="sd">        :type bulk: str, file or list of lists</span>
<span class="sd">        :param bulk: Information about the requested data. See above for</span>
<span class="sd">            details.</span>
<span class="sd">        :type quality: str, optional</span>
<span class="sd">        :param quality: Select a specific SEED quality indicator, handling is</span>
<span class="sd">            data center dependent. Ignored when `bulk` is provided as a</span>
<span class="sd">            request string/file.</span>
<span class="sd">        :type minimumlength: float, optional</span>
<span class="sd">        :param minimumlength: Limit results to continuous data segments of a</span>
<span class="sd">            minimum length specified in seconds. Ignored when `bulk` is</span>
<span class="sd">            provided as a request string/file.</span>
<span class="sd">        :type longestonly: bool, optional</span>
<span class="sd">        :param longestonly: Limit results to the longest continuous segment per</span>
<span class="sd">            channel. Ignored when `bulk` is provided as a request string/file.</span>
<span class="sd">        :type filename: str or file</span>
<span class="sd">        :param filename: If given, the downloaded data will be saved there</span>
<span class="sd">            instead of being parse to an ObsPy object. Thus it will contain the</span>
<span class="sd">            raw data from the webservices.</span>
<span class="sd">        :type attach_response: bool</span>
<span class="sd">        :param attach_response: Specify whether the station web service should</span>
<span class="sd">            be used to automatically attach response information to each trace</span>
<span class="sd">            in the result set. A warning will be shown if a response can not be</span>
<span class="sd">            found for a channel. Does nothing if output to a file was</span>
<span class="sd">            specified.</span>

<span class="sd">        Any additional keyword arguments will be passed to the webservice as</span>
<span class="sd">        additional arguments. If you pass one of the default parameters and the</span>
<span class="sd">        webservice does not support it, a warning will be issued. Passing any</span>
<span class="sd">        non-default parameters that the webservice does not support will raise</span>
<span class="sd">        an error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;dataselect&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The current client does not have a dataselect service.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="n">quality</span><span class="o">=</span><span class="n">quality</span><span class="p">,</span>
            <span class="n">minimumlength</span><span class="o">=</span><span class="n">minimumlength</span><span class="p">,</span>
            <span class="n">longestonly</span><span class="o">=</span><span class="n">longestonly</span>
        <span class="p">)</span>
        <span class="n">bulk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bulk_string</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span><span class="s2">&quot;dataselect&quot;</span><span class="p">,</span> <span class="s2">&quot;query&quot;</span><span class="p">)</span>

        <span class="n">data_stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                                     <span class="n">data</span><span class="o">=</span><span class="n">bulk</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="p">))</span>
        <span class="n">data_stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_to_file_object</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">st</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">data_stream</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;MSEED&quot;</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">attach_response</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_attach_responses</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">st</span></div>

<div class="viewcode-block" id="Client.get_stations_bulk"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.get_stations_bulk.html#obspy.clients.fdsn.client.Client.get_stations_bulk">[docs]</a>    <span class="k">def</span> <span class="nf">get_stations_bulk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">includerestricted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">includeavailability</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the station service of the client. Bulk request.</span>

<span class="sd">        Send a bulk request for stations to the server. `bulk` can either be</span>
<span class="sd">        specified as a filename, a file-like object or a string (with</span>
<span class="sd">        information formatted according to the FDSN standard) or a list of</span>
<span class="sd">        lists (each specifying network, station, location, channel, starttime</span>
<span class="sd">        and endtime). See examples and parameter description for more</span>
<span class="sd">        details.</span>

<span class="sd">        `bulk` can be provided in the following forms:</span>

<span class="sd">        (1) As a list of lists. Each list item has to be list of network,</span>
<span class="sd">            station, location, channel, starttime and endtime.</span>

<span class="sd">        (2) As a valid request string/file as defined in the</span>
<span class="sd">            `FDSNWS documentation &lt;https://www.fdsn.org/webservices/&gt;`_.</span>
<span class="sd">            The request information can be provided as a..</span>

<span class="sd">            - a string containing the request information</span>
<span class="sd">            - a string with the path to a local file with the request</span>
<span class="sd">            - an open file handle (or file-like object) with the request</span>

<span class="sd">        &gt;&gt;&gt; client = Client(&quot;IRIS&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t1 = UTCDateTime(&quot;2010-02-27T06:30:00.000&quot;)</span>
<span class="sd">        &gt;&gt;&gt; t2 = t1 + 1</span>
<span class="sd">        &gt;&gt;&gt; t3 = t1 + 3</span>
<span class="sd">        &gt;&gt;&gt; bulk = [(&quot;IU&quot;, &quot;ANMO&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2),</span>
<span class="sd">        ...         (&quot;IU&quot;, &quot;AFI&quot;, &quot;1?&quot;, &quot;BHE&quot;, t1, t3),</span>
<span class="sd">        ...         (&quot;GR&quot;, &quot;GRA1&quot;, &quot;*&quot;, &quot;BH*&quot;, t2, t3)]</span>
<span class="sd">        &gt;&gt;&gt; inv = client.get_stations_bulk(bulk)</span>
<span class="sd">        &gt;&gt;&gt; print(inv)  # doctest: +ELLIPSIS +NORMALIZE_WHITESPACE</span>
<span class="sd">        Inventory created at ...</span>
<span class="sd">            Created by: IRIS WEB SERVICE: fdsnws-station | version: ...</span>
<span class="sd">                        ...</span>
<span class="sd">            Sending institution: IRIS-DMC (IRIS-DMC)</span>
<span class="sd">            Contains:</span>
<span class="sd">                Networks (2):</span>
<span class="sd">                    GR</span>
<span class="sd">                    IU</span>
<span class="sd">                Stations (2):</span>
<span class="sd">                    GR.GRA1 (GRAFENBERG ARRAY, BAYERN)</span>
<span class="sd">                    IU.ANMO (Albuquerque, New Mexico, USA)</span>
<span class="sd">                Channels (0):</span>
<span class="sd">        &gt;&gt;&gt; inv.plot()  # doctest: +SKIP</span>

<span class="sd">        .. plot::</span>

<span class="sd">            from obspy import UTCDateTime</span>
<span class="sd">            from obspy.clients.fdsn import Client</span>

<span class="sd">            client = Client(&quot;IRIS&quot;)</span>
<span class="sd">            t1 = UTCDateTime(&quot;2010-02-27T06:30:00.000&quot;)</span>
<span class="sd">            t2 = t1 + 1</span>
<span class="sd">            t3 = t1 + 3</span>
<span class="sd">            bulk = [(&quot;IU&quot;, &quot;ANMO&quot;, &quot;*&quot;, &quot;BHZ&quot;, t1, t2),</span>
<span class="sd">                    (&quot;IU&quot;, &quot;AFI&quot;, &quot;1?&quot;, &quot;BHE&quot;, t1, t3),</span>
<span class="sd">                    (&quot;GR&quot;, &quot;GRA1&quot;, &quot;*&quot;, &quot;BH*&quot;, t2, t3)]</span>
<span class="sd">            inv = client.get_stations_bulk(bulk)</span>
<span class="sd">            inv.plot()</span>

<span class="sd">        &gt;&gt;&gt; inv = client.get_stations_bulk(bulk, level=&quot;channel&quot;)</span>
<span class="sd">        &gt;&gt;&gt; print(inv)  # doctest: +ELLIPSIS +NORMALIZE_WHITESPACE</span>
<span class="sd">        Inventory created at ...</span>
<span class="sd">            Created by: IRIS WEB SERVICE: fdsnws-station | version: ...</span>
<span class="sd">                        ...</span>
<span class="sd">            Sending institution: IRIS-DMC (IRIS-DMC)</span>
<span class="sd">            Contains:</span>
<span class="sd">                Networks (2):</span>
<span class="sd">                    GR</span>
<span class="sd">                    IU</span>
<span class="sd">                Stations (2):</span>
<span class="sd">                    GR.GRA1 (GRAFENBERG ARRAY, BAYERN)</span>
<span class="sd">                    IU.ANMO (Albuquerque, New Mexico, USA)</span>
<span class="sd">                Channels (5):</span>
<span class="sd">                    GR.GRA1..BHE, GR.GRA1..BHN, GR.GRA1..BHZ, IU.ANMO.00.BHZ,</span>
<span class="sd">                    IU.ANMO.10.BHZ</span>
<span class="sd">        &gt;&gt;&gt; inv = client.get_stations_bulk(&quot;/tmp/request.txt&quot;) \</span>
<span class="sd">        ...     # doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; print(inv)  # doctest: +SKIP</span>
<span class="sd">        Inventory created at 2014-04-28T14:42:26.000000Z</span>
<span class="sd">            Created by: IRIS WEB SERVICE: fdsnws-station | version: 1.0.14</span>
<span class="sd">                    None</span>
<span class="sd">            Sending institution: IRIS-DMC (IRIS-DMC)</span>
<span class="sd">            Contains:</span>
<span class="sd">                Networks (2):</span>
<span class="sd">                    GR</span>
<span class="sd">                    IU</span>
<span class="sd">                Stations (2):</span>
<span class="sd">                    GR.GRA1 (GRAFENBERG ARRAY, BAYERN)</span>
<span class="sd">                    IU.ANMO (Albuquerque, New Mexico, USA)</span>
<span class="sd">                Channels (5):</span>
<span class="sd">                    GR.GRA1..BHE, GR.GRA1..BHN, GR.GRA1..BHZ, IU.ANMO.00.BHZ,</span>
<span class="sd">                    IU.ANMO.10.BHZ</span>

<span class="sd">        :type bulk: str, file or list of lists</span>
<span class="sd">        :param bulk: Information about the requested data. See above for</span>
<span class="sd">            details.</span>
<span class="sd">        :type quality: str, optional</span>
<span class="sd">        :param quality: Select a specific SEED quality indicator, handling is</span>
<span class="sd">            data center dependent. Ignored when `bulk` is provided as a</span>
<span class="sd">            request string/file.</span>
<span class="sd">        :type minimumlength: float, optional</span>
<span class="sd">        :param minimumlength: Limit results to continuous data segments of a</span>
<span class="sd">            minimum length specified in seconds. Ignored when `bulk` is</span>
<span class="sd">            provided as a request string/file.</span>
<span class="sd">        :type longestonly: bool, optional</span>
<span class="sd">        :param longestonly: Limit results to the longest continuous segment per</span>
<span class="sd">            channel. Ignored when `bulk` is provided as a request string/file.</span>
<span class="sd">        :type filename: str or file</span>
<span class="sd">        :param filename: If given, the downloaded data will be saved there</span>
<span class="sd">            instead of being parse to an ObsPy object. Thus it will contain the</span>
<span class="sd">            raw data from the webservices.</span>
<span class="sd">        :type attach_response: bool</span>
<span class="sd">        :param attach_response: Specify whether the station web service should</span>
<span class="sd">            be used to automatically attach response information to each trace</span>
<span class="sd">            in the result set. A warning will be shown if a response can not be</span>
<span class="sd">            found for a channel. Does nothing if output to a file was</span>
<span class="sd">            specified.</span>

<span class="sd">        Any additional keyword arguments will be passed to the webservice as</span>
<span class="sd">        additional arguments. If you pass one of the default parameters and the</span>
<span class="sd">        webservice does not support it, a warning will be issued. Passing any</span>
<span class="sd">        non-default parameters that the webservice does not support will raise</span>
<span class="sd">        an error.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;dataselect&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;The current client does not have a dataselect service.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">(</span>
            <span class="n">level</span><span class="o">=</span><span class="n">level</span><span class="p">,</span>
            <span class="n">includerestriced</span><span class="o">=</span><span class="n">includerestricted</span><span class="p">,</span>
            <span class="n">includeavailability</span><span class="o">=</span><span class="n">includeavailability</span>
        <span class="p">)</span>
        <span class="n">bulk</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_bulk_string</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="n">arguments</span><span class="p">)</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span><span class="s2">&quot;station&quot;</span><span class="p">,</span> <span class="s2">&quot;query&quot;</span><span class="p">)</span>

        <span class="n">data_stream</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span>
                                     <span class="n">data</span><span class="o">=</span><span class="n">bulk</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="s1">&#39;strict&#39;</span><span class="p">))</span>
        <span class="n">data_stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">filename</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_to_file_object</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inv</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read_inventory</span><span class="p">(</span><span class="n">data_stream</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;stationxml&quot;</span><span class="p">)</span>
            <span class="n">data_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">inv</span></div>

<div class="viewcode-block" id="Client._get_bulk_string"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._get_bulk_string.html#obspy.clients.fdsn.client.Client._get_bulk_string">[docs]</a>    <span class="k">def</span> <span class="nf">_get_bulk_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk</span><span class="p">,</span> <span class="n">arguments</span><span class="p">):</span>
        <span class="c1"># If its an iterable, we build up the query string from it</span>
        <span class="c1"># StringIO objects also have __iter__ so check for &#39;read&#39; as well</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="n">collections</span><span class="o">.</span><span class="n">Iterable</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
            <span class="n">tmp</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2">=</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
                   <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">arguments</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">]</span>
            <span class="c1"># empty location codes have to be represented by two dashes</span>
            <span class="n">tmp</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">net</span><span class="p">,</span> <span class="n">sta</span><span class="p">,</span> <span class="n">loc</span> <span class="ow">or</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">cha</span><span class="p">,</span>
                              <span class="n">convert_to_string</span><span class="p">(</span><span class="n">t1</span><span class="p">),</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">t2</span><span class="p">)))</span>
                    <span class="k">for</span> <span class="n">net</span><span class="p">,</span> <span class="n">sta</span><span class="p">,</span> <span class="n">loc</span><span class="p">,</span> <span class="n">cha</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="ow">in</span> <span class="n">bulk</span><span class="p">]</span>
            <span class="n">bulk</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">any</span><span class="p">([</span><span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">arguments</span><span class="o">.</span><span class="n">values</span><span class="p">()]):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Parameters </span><span class="si">%s</span><span class="s2"> are ignored when request data is &quot;</span>
                       <span class="s2">&quot;provided as a string or file!&quot;</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="n">arguments</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
            <span class="c1"># if it has a read method, read data from there</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="s2">&quot;read&quot;</span><span class="p">):</span>
                <span class="n">bulk</span> <span class="o">=</span> <span class="n">bulk</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
                <span class="c1"># check if bulk is a local file</span>
                <span class="k">if</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">bulk</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">bulk</span><span class="p">):</span>
                    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">bulk</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
                        <span class="n">tmp</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                    <span class="n">bulk</span> <span class="o">=</span> <span class="n">tmp</span>
                <span class="c1"># just use bulk as input data</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Unrecognized input for &#39;bulk&#39; argument. Please &quot;</span>
                       <span class="s2">&quot;contact developers if you think this is a bug.&quot;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">bulk</span></div>

<div class="viewcode-block" id="Client._write_to_file_object"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._write_to_file_object.html#obspy.clients.fdsn.client.Client._write_to_file_object">[docs]</a>    <span class="k">def</span> <span class="nf">_write_to_file_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename_or_object</span><span class="p">,</span> <span class="n">data_stream</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filename_or_object</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">):</span>
            <span class="n">filename_or_object</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data_stream</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="k">return</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename_or_object</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
            <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data_stream</span><span class="o">.</span><span class="n">read</span><span class="p">())</span></div>

<div class="viewcode-block" id="Client._create_url_from_parameters"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._create_url_from_parameters.html#obspy.clients.fdsn.client.Client._create_url_from_parameters">[docs]</a>    <span class="k">def</span> <span class="nf">_create_url_from_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">default_params</span><span class="p">,</span> <span class="n">parameters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">service_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="n">service</span><span class="p">]</span>
        <span class="c1"># Get all required parameters and make sure they are available!</span>
        <span class="n">required_parameters</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">key</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">service_params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">value</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">req_param</span> <span class="ow">in</span> <span class="n">required_parameters</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">req_param</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Parameter &#39;</span><span class="si">%s</span><span class="s2">&#39; is required.&quot;</span> <span class="o">%</span> <span class="n">req_param</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">final_parameter_set</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Now loop over all parameters, convert them and make sure they are</span>
        <span class="c1"># accepted by the service.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">service_params</span><span class="p">:</span>
                <span class="c1"># If it is not in the service but in the default parameters</span>
                <span class="c1"># raise a warning.</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">default_params</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;The standard parameter &#39;</span><span class="si">%s</span><span class="s2">&#39; is not supported by &quot;</span>
                           <span class="s2">&quot;the webservice. It will be silently ignored.&quot;</span> <span class="o">%</span>
                           <span class="n">key</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">WADL_PARAMETERS_NOT_TO_BE_PARSED</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;The parameter &#39;</span><span class="si">%s</span><span class="s2">&#39; is ignored because it is not &quot;</span>
                           <span class="s2">&quot;useful within ObsPy&quot;</span><span class="p">)</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="c1"># Otherwise raise an error.</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> \
                        <span class="s2">&quot;The parameter &#39;</span><span class="si">%s</span><span class="s2">&#39; is not supported by the service.&quot;</span> \
                        <span class="o">%</span> <span class="n">key</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="c1"># Now attempt to convert the parameter to the correct type.</span>
            <span class="n">this_type</span> <span class="o">=</span> <span class="n">service_params</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;type&quot;</span><span class="p">]</span>

            <span class="c1"># Try to decode to be able to work with bytes.</span>
            <span class="k">if</span> <span class="n">this_type</span> <span class="ow">is</span> <span class="n">native_str</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                    <span class="k">pass</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">this_type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; could not be converted to type &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">this_type</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
            <span class="c1"># Now convert to a string that is accepted by the webservice.</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">convert_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">value</span> <span class="ow">and</span> <span class="n">key</span> <span class="o">!=</span> <span class="s2">&quot;location&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>
            <span class="n">final_parameter_set</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="s2">&quot;query&quot;</span><span class="p">,</span>
                               <span class="n">parameters</span><span class="o">=</span><span class="n">final_parameter_set</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.__str__"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.__str__.html#obspy.clients.fdsn.client.Client.__str__">[docs]</a>    <span class="k">def</span> <span class="nf">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">versions</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">([(</span><span class="n">s</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_webservice_versionstring</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
                         <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">FDSNWS</span><span class="p">])</span>
        <span class="n">services_string</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; (v</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">versions</span><span class="p">[</span><span class="n">s</span><span class="p">])</span>
                           <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">FDSNWS</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">]</span>
        <span class="n">other_services</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">FDSNWS</span><span class="p">])</span>
        <span class="n">services_string</span> <span class="o">+=</span> <span class="p">[</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39;&quot;</span> <span class="o">%</span> <span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">other_services</span><span class="p">]</span>
        <span class="n">services_string</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">services_string</span><span class="p">)</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;FDSN Webservice Client (base url: </span><span class="si">{url}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span>
               <span class="s2">&quot;Available Services: </span><span class="si">{services}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
               <span class="s2">&quot;Use e.g. client.help(&#39;dataselect&#39;) for the</span><span class="se">\n</span><span class="s2">&quot;</span>
               <span class="s2">&quot;parameter description of the individual services</span><span class="se">\n</span><span class="s2">&quot;</span>
               <span class="s2">&quot;or client.help() for parameter description of</span><span class="se">\n</span><span class="s2">&quot;</span>
               <span class="s2">&quot;all webservices.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="p">,</span>
                                         <span class="n">services</span><span class="o">=</span><span class="n">services_string</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span></div>

<div class="viewcode-block" id="Client._repr_pretty_"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._repr_pretty_.html#obspy.clients.fdsn.client.Client._repr_pretty_">[docs]</a>    <span class="k">def</span> <span class="nf">_repr_pretty_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">cycle</span><span class="p">):</span>
        <span class="n">p</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

<div class="viewcode-block" id="Client.help"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.help.html#obspy.clients.fdsn.client.Client.help">[docs]</a>    <span class="k">def</span> <span class="nf">help</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Print a more extensive help for a given service.</span>

<span class="sd">        This will use the already parsed WADL files and be specific for each</span>
<span class="sd">        data center and always up-to-date.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">service</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">service</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Service &#39;</span><span class="si">%s</span><span class="s2">&#39; not available for current client.&quot;</span> <span class="o">%</span> <span class="n">service</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">service</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">services</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">FDSNWS</span><span class="p">:</span>
            <span class="n">services</span> <span class="o">=</span> <span class="p">[</span><span class="n">service</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Service &#39;</span><span class="si">%s</span><span class="s2"> is not a valid FDSN web service.&quot;</span> <span class="o">%</span> <span class="n">service</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">services</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">service</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">FDSNWS</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="n">service_default</span> <span class="o">=</span> <span class="n">DEFAULT_PARAMETERS</span><span class="p">[</span><span class="n">service</span><span class="p">]</span>
            <span class="n">service_optional</span> <span class="o">=</span> <span class="n">OPTIONAL_PARAMETERS</span><span class="p">[</span><span class="n">service</span><span class="p">]</span>

            <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Parameter description for the &quot;</span>
                       <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; service (v</span><span class="si">%s</span><span class="s2">) of &#39;</span><span class="si">%s</span><span class="s2">&#39;:&quot;</span> <span class="o">%</span> <span class="p">(</span>
                           <span class="n">service</span><span class="p">,</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">_get_webservice_versionstring</span><span class="p">(</span><span class="n">service</span><span class="p">),</span>
                           <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="p">))</span>

            <span class="c1"># Loop over all parameters and group them in four lists: available</span>
            <span class="c1"># default parameters, missing default parameters, optional</span>
            <span class="c1"># parameters and additional parameters.</span>
            <span class="n">available_default_parameters</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">missing_default_parameters</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">optional_parameters</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">additional_parameters</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="n">printed_something</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">service_default</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="n">service</span><span class="p">]:</span>
                    <span class="n">available_default_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">missing_default_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">service_optional</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="n">service</span><span class="p">]:</span>
                    <span class="n">optional_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

            <span class="n">defined_parameters</span> <span class="o">=</span> <span class="n">service_default</span> <span class="o">+</span> <span class="n">service_optional</span>
            <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="n">service</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">defined_parameters</span><span class="p">:</span>
                    <span class="n">additional_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">_param_info_string</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
                <span class="n">param</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="n">service</span><span class="p">][</span><span class="n">name</span><span class="p">]</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span>
                    <span class="s1">&#39;new&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">))</span>
                <span class="n">req_def</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
                <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;required&quot;</span><span class="p">]:</span>
                    <span class="n">req_def</span> <span class="o">=</span> <span class="s2">&quot;Required Parameter&quot;</span>
                <span class="k">elif</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;default_value&quot;</span><span class="p">]:</span>
                    <span class="n">req_def</span> <span class="o">=</span> <span class="s2">&quot;Default value: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s2">&quot;default_value&quot;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">]:</span>
                    <span class="n">req_def</span> <span class="o">+=</span> <span class="s2">&quot;, Choices: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> \
                        <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;options&quot;</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">req_def</span><span class="p">:</span>
                    <span class="n">req_def</span> <span class="o">=</span> <span class="s2">&quot;, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">req_def</span>
                <span class="k">if</span> <span class="n">param</span><span class="p">[</span><span class="s2">&quot;doc_title&quot;</span><span class="p">]:</span>
                    <span class="n">doc_title</span> <span class="o">=</span> <span class="n">textwrap</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">param</span><span class="p">[</span><span class="s2">&quot;doc_title&quot;</span><span class="p">],</span> <span class="n">width</span><span class="o">=</span><span class="mi">79</span><span class="p">,</span>
                                              <span class="n">initial_indent</span><span class="o">=</span><span class="s2">&quot;        &quot;</span><span class="p">,</span>
                                              <span class="n">subsequent_indent</span><span class="o">=</span><span class="s2">&quot;        &quot;</span><span class="p">,</span>
                                              <span class="n">break_long_words</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                    <span class="n">doc_title</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">doc_title</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">doc_title</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>

                <span class="k">return</span> <span class="s2">&quot;    </span><span class="si">{name}{req_def}{doc_title}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">req_def</span><span class="o">=</span><span class="n">req_def</span><span class="p">,</span> <span class="n">doc_title</span><span class="o">=</span><span class="n">doc_title</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">optional_parameters</span><span class="p">:</span>
                <span class="n">printed_something</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;The service offers the following optional &quot;</span>
                           <span class="s2">&quot;standard parameters:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">optional_parameters</span><span class="p">:</span>
                    <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_param_info_string</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">additional_parameters</span><span class="p">:</span>
                <span class="n">printed_something</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;The service offers the following &quot;</span>
                           <span class="s2">&quot;non-standard parameters:&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">additional_parameters</span><span class="p">):</span>
                    <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_param_info_string</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">missing_default_parameters</span><span class="p">:</span>
                <span class="n">printed_something</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;WARNING: The service does not offer the following &quot;</span>
                           <span class="s2">&quot;standard parameters: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                           <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">missing_default_parameters</span><span class="p">))</span>

            <span class="k">if</span> <span class="n">service</span> <span class="o">==</span> <span class="s2">&quot;event&quot;</span> <span class="ow">and</span> \
                    <span class="s2">&quot;available_event_catalogs&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
                <span class="n">printed_something</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Available catalogs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                           <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s2">&quot;available_event_catalogs&quot;</span><span class="p">]))</span>

            <span class="k">if</span> <span class="n">service</span> <span class="o">==</span> <span class="s2">&quot;event&quot;</span> <span class="ow">and</span> \
                    <span class="s2">&quot;available_event_contributors&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
                <span class="n">printed_something</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Available contributors: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span>
                           <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                               <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s2">&quot;available_event_contributors&quot;</span><span class="p">]))</span>

            <span class="k">if</span> <span class="n">printed_something</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">msg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;No derivations from standard detected&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span></div>

<div class="viewcode-block" id="Client._download"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._download.html#obspy.clients.fdsn.client.Client._download">[docs]</a>    <span class="k">def</span> <span class="nf">_download</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">return_string</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_gzip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">code</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">download_url</span><span class="p">(</span>
            <span class="n">url</span><span class="p">,</span> <span class="n">opener</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_url_opener</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">request_headers</span><span class="p">,</span>
            <span class="n">debug</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">,</span> <span class="n">return_string</span><span class="o">=</span><span class="n">return_string</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">,</span> <span class="n">use_gzip</span><span class="o">=</span><span class="n">use_gzip</span><span class="p">)</span>
        <span class="c1"># get detailed server response message</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">server_info</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span>
                    <span class="n">line</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span> <span class="k">if</span> <span class="n">line</span><span class="p">])</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">server_info</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># No data.</span>
        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;No data available for request.&quot;</span><span class="p">,</span> <span class="n">server_info</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">400</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Bad request. If you think your request was valid &quot;</span>
                   <span class="s2">&quot;please contact the developers.&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">server_info</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">401</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Unauthorized, authentication required.&quot;</span><span class="p">,</span>
                                <span class="n">server_info</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">403</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Authentication failed.&quot;</span><span class="p">,</span> <span class="n">server_info</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">413</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Request would result in too much data. &quot;</span>
                                <span class="s2">&quot;Denied by the datacenter. Split the request &quot;</span>
                                <span class="s2">&quot;in smaller parts&quot;</span><span class="p">,</span> <span class="n">server_info</span><span class="p">)</span>
        <span class="c1"># Request URI too large.</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">414</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;The request URI is too large. Please contact the ObsPy &quot;</span>
                   <span class="s2">&quot;developers.&quot;</span><span class="p">,</span> <span class="n">server_info</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">500</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Service responds: Internal server error&quot;</span><span class="p">,</span>
                                <span class="n">server_info</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">503</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Service temporarily unavailable&quot;</span><span class="p">,</span> <span class="n">server_info</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="s2">&quot;timeout&quot;</span> <span class="ow">in</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
                <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Timed Out&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Unknown Error (</span><span class="si">%s</span><span class="s2">): </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">),</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">))))</span>
        <span class="c1"># Catch any non 200 codes.</span>
        <span class="k">elif</span> <span class="n">code</span> <span class="o">!=</span> <span class="mi">200</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Unknown HTTP code: </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">code</span><span class="p">,</span> <span class="n">server_info</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">data</span></div>

<div class="viewcode-block" id="Client._build_url"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._build_url.html#obspy.clients.fdsn.client.Client._build_url">[docs]</a>    <span class="k">def</span> <span class="nf">_build_url</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="p">{}):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds the correct URL.</span>

<span class="sd">        Replaces &quot;query&quot; with &quot;queryauth&quot; if client has authentication</span>
<span class="sd">        information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># authenticated dataselect queries have different target URL</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">service</span> <span class="o">==</span> <span class="s2">&quot;dataselect&quot;</span> <span class="ow">and</span> <span class="n">resource_type</span> <span class="o">==</span> <span class="s2">&quot;query&quot;</span><span class="p">:</span>
                <span class="n">resource_type</span> <span class="o">=</span> <span class="s2">&quot;queryauth&quot;</span>
        <span class="k">return</span> <span class="n">build_url</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">major_versions</span><span class="p">[</span><span class="n">service</span><span class="p">],</span>
                         <span class="n">resource_type</span><span class="p">,</span> <span class="n">parameters</span><span class="p">,</span>
                         <span class="n">service_mappings</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_service_mappings</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client._discover_services"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._discover_services.html#obspy.clients.fdsn.client.Client._discover_services">[docs]</a>    <span class="k">def</span> <span class="nf">_discover_services</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Automatically discovers available services.</span>

<span class="sd">        They are discovered by downloading the corresponding WADL files. If a</span>
<span class="sd">        WADL does not exist, the services are assumed to be non-existent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">services</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;dataselect&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="s2">&quot;station&quot;</span><span class="p">]</span>
        <span class="c1"># omit manually deactivated services</span>
        <span class="k">for</span> <span class="n">service</span><span class="p">,</span> <span class="n">custom_target</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_service_mappings</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">custom_target</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">services</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">service</span><span class="p">)</span>
        <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="s2">&quot;application.wadl&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">services</span><span class="p">]</span>
        <span class="k">if</span> <span class="s2">&quot;event&quot;</span> <span class="ow">in</span> <span class="n">services</span><span class="p">:</span>
            <span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="s2">&quot;catalogs&quot;</span><span class="p">))</span>
            <span class="n">urls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span><span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="s2">&quot;contributors&quot;</span><span class="p">))</span>

        <span class="c1"># Access cache if available.</span>
        <span class="n">url_hash</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">urls</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">url_hash</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__service_discovery_cache</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Loading discovered services from cache.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">services</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__service_discovery_cache</span><span class="p">[</span><span class="n">url_hash</span><span class="p">])</span>
            <span class="k">return</span>

        <span class="c1"># Request all in parallel.</span>
        <span class="n">wadl_queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>

        <span class="n">headers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">request_headers</span>
        <span class="n">debug</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span>
        <span class="n">opener</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_url_opener</span>

        <span class="k">def</span> <span class="nf">get_download_thread</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
            <span class="k">class</span> <span class="nc">ThreadURL</span><span class="p">(</span><span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">):</span>
                <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
                    <span class="c1"># Catch 404s.</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">code</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">download_url</span><span class="p">(</span>
                            <span class="n">url</span><span class="p">,</span> <span class="n">opener</span><span class="o">=</span><span class="n">opener</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span>
                            <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                            <span class="n">wadl_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
                        <span class="c1"># Pass on the redirect exception.</span>
                        <span class="k">elif</span> <span class="n">code</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span>
                                <span class="n">data</span><span class="p">,</span> <span class="n">FDSNRedirectException</span><span class="p">):</span>
                            <span class="n">wadl_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">wadl_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">url</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                    <span class="k">except</span> <span class="n">urllib_request</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">404</span><span class="p">,</span> <span class="mi">502</span><span class="p">]:</span>
                            <span class="n">wadl_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">url</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">raise</span>
                    <span class="k">except</span> <span class="n">urllib_request</span><span class="o">.</span><span class="n">URLError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">wadl_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">url</span><span class="p">,</span> <span class="s2">&quot;timeout&quot;</span><span class="p">))</span>
                    <span class="k">except</span> <span class="n">socket_timeout</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                        <span class="n">wadl_queue</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">url</span><span class="p">,</span> <span class="s2">&quot;timeout&quot;</span><span class="p">))</span>
            <span class="k">return</span> <span class="n">ThreadURL</span><span class="p">()</span>

        <span class="n">threads</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">get_download_thread</span><span class="p">,</span> <span class="n">urls</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">thread</span> <span class="ow">in</span> <span class="n">threads</span><span class="p">:</span>
            <span class="n">thread</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">services</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># Collect the redirection exceptions to be able to raise nicer</span>
        <span class="c1"># exceptions.</span>
        <span class="n">redirect_messages</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">wadl_queue</span><span class="o">.</span><span class="n">qsize</span><span class="p">()):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">wadl_queue</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
            <span class="n">url</span><span class="p">,</span> <span class="n">wadl</span> <span class="o">=</span> <span class="n">item</span>

            <span class="k">if</span> <span class="n">wadl</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wadl</span><span class="p">,</span> <span class="n">FDSNRedirectException</span><span class="p">):</span>
                <span class="n">redirect_messages</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">wadl</span><span class="p">))</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">wadl</span> <span class="o">==</span> <span class="s2">&quot;timeout&quot;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="s2">&quot;Timeout while requesting &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="n">url</span><span class="p">)</span>

            <span class="k">if</span> <span class="s2">&quot;dataselect&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s2">&quot;dataselect&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WADLParser</span><span class="p">(</span><span class="n">wadl</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Discovered dataselect service&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s2">&quot;event&quot;</span> <span class="ow">in</span> <span class="n">url</span> <span class="ow">and</span> <span class="s2">&quot;application.wadl&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s2">&quot;event&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WADLParser</span><span class="p">(</span><span class="n">wadl</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Discovered event service&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s2">&quot;station&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s2">&quot;station&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">WADLParser</span><span class="p">(</span><span class="n">wadl</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Discovered station service&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="s2">&quot;event&quot;</span> <span class="ow">in</span> <span class="n">url</span> <span class="ow">and</span> <span class="s2">&quot;catalogs&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s2">&quot;available_event_catalogs&quot;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">parse_simple_xml</span><span class="p">(</span><span class="n">wadl</span><span class="p">)[</span><span class="s2">&quot;catalogs&quot;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Could not parse the catalogs at &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="n">url</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="k">elif</span> <span class="s2">&quot;event&quot;</span> <span class="ow">in</span> <span class="n">url</span> <span class="ow">and</span> <span class="s2">&quot;contributors&quot;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">[</span><span class="s2">&quot;available_event_contributors&quot;</span><span class="p">]</span> <span class="o">=</span> \
                        <span class="n">parse_simple_xml</span><span class="p">(</span><span class="n">wadl</span><span class="p">)[</span><span class="s2">&quot;contributors&quot;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Could not parse the contributors at &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="n">url</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">redirect_messages</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">FDSNRedirectException</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">redirect_messages</span><span class="p">))</span>

            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;No FDSN services could be discovered at &#39;</span><span class="si">%s</span><span class="s2">&#39;. This could &quot;</span>
                   <span class="s2">&quot;be due to a temporary service outage or an invalid FDSN &quot;</span>
                   <span class="s2">&quot;service address.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">base_url</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Cache.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Storing discovered services in cache.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__service_discovery_cache</span><span class="p">[</span><span class="n">url_hash</span><span class="p">]</span> <span class="o">=</span> \
            <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client.get_webservice_version"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client.get_webservice_version.html#obspy.clients.fdsn.client.Client.get_webservice_version">[docs]</a>    <span class="k">def</span> <span class="nf">get_webservice_version</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get full version information of webservice (as a tuple of ints).</span>

<span class="sd">        This method is cached and will only be called once for each service</span>
<span class="sd">        per client object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">service</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">service</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">services</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Service &#39;</span><span class="si">%s</span><span class="s2">&#39; not available for current client.&quot;</span> <span class="o">%</span> <span class="n">service</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">service</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">FDSNWS</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Service &#39;</span><span class="si">%s</span><span class="s2"> is not a valid FDSN web service.&quot;</span> <span class="o">%</span> <span class="n">service</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Access cache.</span>
        <span class="k">if</span> <span class="n">service</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__version_cache</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__version_cache</span><span class="p">[</span><span class="n">service</span><span class="p">]</span>

        <span class="n">url</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_build_url</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="s2">&quot;version&quot;</span><span class="p">)</span>
        <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">return_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">version</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">version</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">b</span><span class="s2">&quot;.&quot;</span><span class="p">)))</span>

        <span class="c1"># Store in cache.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__version_cache</span><span class="p">[</span><span class="n">service</span><span class="p">]</span> <span class="o">=</span> <span class="n">version</span>

        <span class="k">return</span> <span class="n">version</span></div>

<div class="viewcode-block" id="Client._get_webservice_versionstring"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.Client._get_webservice_versionstring.html#obspy.clients.fdsn.client.Client._get_webservice_versionstring">[docs]</a>    <span class="k">def</span> <span class="nf">_get_webservice_versionstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">service</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get full version information of webservice as a string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_webservice_version</span><span class="p">(</span><span class="n">service</span><span class="p">)</span>
        <span class="k">return</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">version</span><span class="p">))</span></div></div>


<div class="viewcode-block" id="convert_to_string"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.convert_to_string.html#obspy.clients.fdsn.client.convert_to_string">[docs]</a><span class="k">def</span> <span class="nf">convert_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Takes any value and converts it to a string compliant with the FDSN</span>
<span class="sd">    webservices.</span>

<span class="sd">    Will raise a ValueError if the value could not be converted.</span>

<span class="sd">    &gt;&gt;&gt; print(convert_to_string(&quot;abcd&quot;))</span>
<span class="sd">    abcd</span>
<span class="sd">    &gt;&gt;&gt; print(convert_to_string(1))</span>
<span class="sd">    1</span>
<span class="sd">    &gt;&gt;&gt; print(convert_to_string(1.2))</span>
<span class="sd">    1.2</span>
<span class="sd">    &gt;&gt;&gt; print(convert_to_string( \</span>
<span class="sd">              UTCDateTime(2012, 1, 2, 3, 4, 5, 666666)))</span>
<span class="sd">    2012-01-02T03:04:05.666666</span>
<span class="sd">    &gt;&gt;&gt; print(convert_to_string(True))</span>
<span class="sd">    true</span>
<span class="sd">    &gt;&gt;&gt; print(convert_to_string(False))</span>
<span class="sd">    false</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">)):</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="c1"># Boolean test must come before integer check!</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">UTCDateTime</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Z&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">PY2</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Unexpected type </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">repr</span><span class="p">(</span><span class="n">value</span><span class="p">))</span></div>


<div class="viewcode-block" id="build_url"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.build_url.html#obspy.clients.fdsn.client.build_url">[docs]</a><span class="k">def</span> <span class="nf">build_url</span><span class="p">(</span><span class="n">base_url</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span> <span class="n">major_version</span><span class="p">,</span> <span class="n">resource_type</span><span class="p">,</span>
              <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">service_mappings</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    URL builder for the FDSN webservices.</span>

<span class="sd">    Built as a separate function to enhance testability.</span>

<span class="sd">    &gt;&gt;&gt; print(build_url(&quot;http://service.iris.edu&quot;, &quot;dataselect&quot;, 1, \</span>
<span class="sd">                        &quot;application.wadl&quot;))</span>
<span class="sd">    http://service.iris.edu/fdsnws/dataselect/1/application.wadl</span>

<span class="sd">    &gt;&gt;&gt; print(build_url(&quot;http://service.iris.edu&quot;, &quot;dataselect&quot;, 1, \</span>
<span class="sd">                        &quot;query&quot;, {&quot;cha&quot;: &quot;EHE&quot;}))</span>
<span class="sd">    http://service.iris.edu/fdsnws/dataselect/1/query?cha=EHE</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Avoid mutable kwargs.</span>
    <span class="k">if</span> <span class="n">parameters</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">parameters</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">service_mappings</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">service_mappings</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="c1"># Only allow certain resource types.</span>
    <span class="k">if</span> <span class="n">service</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;dataselect&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="s2">&quot;station&quot;</span><span class="p">]:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Resource type &#39;</span><span class="si">%s</span><span class="s2">&#39; not allowed. Allowed types: </span><span class="se">\n</span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s2">&quot;dataselect&quot;</span><span class="p">,</span> <span class="s2">&quot;event&quot;</span><span class="p">,</span> <span class="s2">&quot;station&quot;</span><span class="p">)))</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Special location handling.</span>
    <span class="k">if</span> <span class="s2">&quot;location&quot;</span> <span class="ow">in</span> <span class="n">parameters</span><span class="p">:</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="c1"># Empty location.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">loc</span><span class="p">:</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span>
        <span class="c1"># Empty location at start of list.</span>
        <span class="k">if</span> <span class="n">loc</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
            <span class="n">loc</span> <span class="o">=</span> <span class="s2">&quot;--&quot;</span> <span class="o">+</span> <span class="n">loc</span>
        <span class="c1"># Empty location at end of list.</span>
        <span class="k">if</span> <span class="n">loc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">):</span>
            <span class="n">loc</span> <span class="o">+=</span> <span class="s2">&quot;--&quot;</span>
        <span class="c1"># Empty location in middle of list.</span>
        <span class="n">loc</span> <span class="o">=</span> <span class="n">loc</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;,,&quot;</span><span class="p">,</span> <span class="s2">&quot;,--,&quot;</span><span class="p">)</span>
        <span class="n">parameters</span><span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">loc</span>

    <span class="c1"># Apply per-service mappings if any.</span>
    <span class="k">if</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">service_mappings</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">service_mappings</span><span class="p">[</span><span class="n">service</span><span class="p">],</span> <span class="n">resource_type</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">base_url</span><span class="p">,</span> <span class="s2">&quot;fdsnws&quot;</span><span class="p">,</span> <span class="n">service</span><span class="p">,</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">major_version</span><span class="p">),</span> <span class="n">resource_type</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">parameters</span><span class="p">:</span>
        <span class="c1"># Strip parameters.</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">parameters</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;?&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="n">url</span><span class="p">,</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">parameters</span><span class="p">)))</span>
    <span class="k">return</span> <span class="n">url</span></div>


<div class="viewcode-block" id="download_url"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.download_url.html#obspy.clients.fdsn.client.download_url">[docs]</a><span class="k">def</span> <span class="nf">download_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">opener</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{},</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">return_string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">use_gzip</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a pair of tuples.</span>

<span class="sd">    The first one is the returned HTTP code and the second the data as</span>
<span class="sd">    string.</span>

<span class="sd">    Will return a tuple of Nones if the service could not be found.</span>
<span class="sd">    All encountered exceptions will get raised unless `debug=True` is</span>
<span class="sd">    specified.</span>

<span class="sd">    Performs a http GET if data=None, otherwise a http POST.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading </span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2"> requesting gzip compression&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">url</span><span class="p">,</span> <span class="s2">&quot;with&quot;</span> <span class="k">if</span> <span class="n">use_gzip</span> <span class="k">else</span> <span class="s2">&quot;without&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Sending along the following payload:&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">70</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">request</span> <span class="o">=</span> <span class="n">urllib_request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="c1"># Request gzip encoding if desired.</span>
        <span class="k">if</span> <span class="n">use_gzip</span><span class="p">:</span>
            <span class="n">request</span><span class="o">.</span><span class="n">add_header</span><span class="p">(</span><span class="s2">&quot;Accept-encoding&quot;</span><span class="p">,</span> <span class="s2">&quot;gzip&quot;</span><span class="p">)</span>

        <span class="n">url_obj</span> <span class="o">=</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="n">timeout</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
    <span class="c1"># Catch HTTP errors.</span>
    <span class="k">except</span> <span class="n">urllib_request</span><span class="o">.</span><span class="n">HTTPError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;HTTP error </span><span class="si">%i</span><span class="s2">, reason </span><span class="si">%s</span><span class="s2">, while downloading &#39;</span><span class="si">%s</span><span class="s2">&#39;: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> \
                  <span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">reason</span><span class="p">),</span> <span class="n">url</span><span class="p">,</span> <span class="n">e</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">e</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">e</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error while downloading: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">e</span>

    <span class="n">code</span> <span class="o">=</span> <span class="n">url_obj</span><span class="o">.</span><span class="n">getcode</span><span class="p">()</span>

    <span class="c1"># Unpack gzip if necessary.</span>
    <span class="k">if</span> <span class="n">url_obj</span><span class="o">.</span><span class="n">info</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Content-Encoding&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="s2">&quot;gzip&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Uncompressing gzipped response for </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">url</span><span class="p">)</span>
        <span class="c1"># Cannot directly stream to gzip from urllib!</span>
        <span class="c1"># http://www.enricozini.org/2011/cazzeggio/python-gzip/</span>
        <span class="n">buf</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">url_obj</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
        <span class="n">buf</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">gzip</span><span class="o">.</span><span class="n">GzipFile</span><span class="p">(</span><span class="n">fileobj</span><span class="o">=</span><span class="n">buf</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">url_obj</span>

    <span class="k">if</span> <span class="n">return_string</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">debug</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloaded </span><span class="si">%s</span><span class="s2"> with HTTP code: </span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">code</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">code</span><span class="p">,</span> <span class="n">data</span></div>


<div class="viewcode-block" id="setup_query_dict"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.setup_query_dict.html#obspy.clients.fdsn.client.setup_query_dict">[docs]</a><span class="k">def</span> <span class="nf">setup_query_dict</span><span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">locs</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># check if alias is used together with the normal parameter</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">PARAMETER_ALIASES</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">locs</span><span class="p">[</span><span class="n">PARAMETER_ALIASES</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;two parameters were provided for the same option: &quot;</span>
                       <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">PARAMETER_ALIASES</span><span class="p">[</span><span class="n">key</span><span class="p">]))</span>
                <span class="k">raise</span> <span class="n">FDSNException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="c1"># short aliases are not mentioned in the downloaded WADLs, so we have</span>
    <span class="c1"># to map it here according to the official FDSN WS documentation</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">PARAMETER_ALIASES</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="n">PARAMETER_ALIASES</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">DEFAULT_PARAMETERS</span><span class="p">[</span><span class="n">service</span><span class="p">]</span> <span class="o">+</span> <span class="n">OPTIONAL_PARAMETERS</span><span class="p">[</span><span class="n">service</span><span class="p">]:</span>
        <span class="n">param</span> <span class="o">=</span> <span class="n">PARAMETER_ALIASES</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">param</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">locs</span><span class="p">[</span><span class="n">param</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="n">param</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span></div>


<div class="viewcode-block" id="parse_simple_xml"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.fdsn.client.parse_simple_xml.html#obspy.clients.fdsn.client.parse_simple_xml">[docs]</a><span class="k">def</span> <span class="nf">parse_simple_xml</span><span class="p">(</span><span class="n">xml_string</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Simple helper function for parsing the Catalog and Contributor availability</span>
<span class="sd">    files.</span>

<span class="sd">    Parses XMLs of the form::</span>

<span class="sd">        &lt;Bs&gt;</span>
<span class="sd">            &lt;total&gt;4&lt;/total&gt;</span>
<span class="sd">            &lt;B&gt;1&lt;/B&gt;</span>
<span class="sd">            &lt;B&gt;2&lt;/B&gt;</span>
<span class="sd">            &lt;B&gt;3&lt;/B&gt;</span>
<span class="sd">            &lt;B&gt;4&lt;/B&gt;</span>
<span class="sd">        &lt;/Bs&gt;</span>

<span class="sd">    and return a dictionary with a single item::</span>

<span class="sd">        {&quot;Bs&quot;: set((&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;))}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_string</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Could not parse the XML.&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="n">child_tag</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">children</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">text</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">root</span> <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="n">child_tag</span><span class="p">]</span>

    <span class="k">return</span> <span class="p">{</span><span class="n">root</span><span class="o">.</span><span class="n">tag</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span> <span class="nb">set</span><span class="p">(</span><span class="n">children</span><span class="p">)}</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">exclude_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a>™ &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, Ólafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Käufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhäusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaimé, Sébastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clément</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Köhler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n° 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>