<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>obspy.clients.arclink.client &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="http://docs.obspy.org/search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../../../py-modindex.html" title="Python Module Index"
         >modules</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../../../index.html" accesskey="U">Module code</a></li> 
    </ol>
  
  <h1>Source code for obspy.clients.arclink.client</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">ArcLink/WebDC client for ObsPy.</span>

<span class="sd">:copyright:</span>
<span class="sd">    The ObsPy Development Team (devs@obspy.org)</span>
<span class="sd">:license:</span>
<span class="sd">    GNU Lesser General Public License, Version 3</span>
<span class="sd">    (https://www.gnu.org/copyleft/lesser.html)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="p">(</span><span class="n">absolute_import</span><span class="p">,</span> <span class="n">division</span><span class="p">,</span> <span class="n">print_function</span><span class="p">,</span>
                        <span class="n">unicode_literals</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">future.builtins</span> <span class="k">import</span> <span class="o">*</span>  <span class="c1"># NOQA @UnusedWildImport</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="k">import</span> <span class="n">native_str</span>

<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">fnmatch</span> <span class="k">import</span> <span class="n">fnmatch</span>
<span class="kn">from</span> <span class="nn">telnetlib</span> <span class="k">import</span> <span class="n">Telnet</span>

<span class="kn">from</span> <span class="nn">lxml</span> <span class="k">import</span> <span class="n">etree</span><span class="p">,</span> <span class="n">objectify</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">obspy</span> <span class="k">import</span> <span class="n">UTCDateTime</span><span class="p">,</span> <span class="n">read</span>
<span class="kn">from</span> <span class="nn">obspy.core.util</span> <span class="k">import</span> <span class="n">AttribDict</span><span class="p">,</span> <span class="n">complexify_string</span>
<span class="kn">from</span> <span class="nn">obspy.core.util.decorator</span> <span class="k">import</span> <span class="n">deprecated</span>


<span class="n">DCID_KEY_FILE</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;HOME&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;dcidpasswords.txt&#39;</span><span class="p">)</span>
<span class="n">MAX_REQUESTS</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">_ROUTING_NS_1_0</span> <span class="o">=</span> <span class="s2">&quot;http://geofon.gfz-potsdam.de/ns/Routing/1.0/&quot;</span>
<span class="n">_ROUTING_NS_0_1</span> <span class="o">=</span> <span class="s2">&quot;http://geofon.gfz-potsdam.de/ns/routing/0.1/&quot;</span>
<span class="n">_INVENTORY_NS_1_0</span> <span class="o">=</span> <span class="s2">&quot;http://geofon.gfz-potsdam.de/ns/Inventory/1.0/&quot;</span>
<span class="n">_INVENTORY_NS_0_2</span> <span class="o">=</span> <span class="s2">&quot;http://geofon.gfz-potsdam.de/ns/inventory/0.2/&quot;</span>

<span class="n">MSG_NOPAZ</span> <span class="o">=</span> <span class="s2">&quot;No Poles and Zeros information returned by server.&quot;</span>


<div class="viewcode-block" id="ArcLinkException"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.ArcLinkException.html#obspy.clients.arclink.client.ArcLinkException">[docs]</a><span class="k">class</span> <span class="nc">ArcLinkException</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Raised by the ArcLink client for known exceptions.</span>
<span class="sd">    &quot;&quot;&quot;</span></div>


<div class="viewcode-block" id="Client"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.html#obspy.clients.arclink.client.Client">[docs]</a><span class="k">class</span> <span class="nc">Client</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The ArcLink/WebDC client.</span>

<span class="sd">    :type user: str</span>
<span class="sd">    :param user: The user name is used for identification with the ArcLink</span>
<span class="sd">        server. This entry is also used for usage statistics within the data</span>
<span class="sd">        centers, so please provide a meaningful user id such as your email</span>
<span class="sd">        address.</span>
<span class="sd">    :type host: str, optional</span>
<span class="sd">    :param host: Host name of the remote ArcLink server (default host is</span>
<span class="sd">        ``&#39;webdc.eu&#39;``).</span>
<span class="sd">    :type port: int, optional</span>
<span class="sd">    :param port: Port of the remote ArcLink server (default port is ``18002``).</span>
<span class="sd">    :type timeout: int, optional</span>
<span class="sd">    :param timeout: Seconds before a connection timeout is raised (default is</span>
<span class="sd">        ``20`` seconds).</span>
<span class="sd">    :type password: str, optional</span>
<span class="sd">    :param password: A password used for authentication with the ArcLink server</span>
<span class="sd">        (default is an empty string).</span>
<span class="sd">    :type institution: str, optional</span>
<span class="sd">    :param institution: A string containing the name of the institution of the</span>
<span class="sd">        requesting person (default is an ``&#39;Anonymous&#39;``).</span>
<span class="sd">    :type dcid_keys: dict, optional</span>
<span class="sd">    :param dcid_keys: Dictionary of data center ids (DCID) and passwords used</span>
<span class="sd">        for decoding encrypted waveform requests.</span>
<span class="sd">    :type dcid_key_file: str, optional</span>
<span class="sd">    :param dcid_key_file: Simple text configuration file containing lines of</span>
<span class="sd">        data center ids (DCIDs) and password pairs separated by a equal sign,</span>
<span class="sd">        e.g. for DCID ``BIA`` and password ``OfH9ekhi`` use ``&quot;BIA=OfH9ekhi&quot;``.</span>
<span class="sd">        If not set, passwords found in a file called `$HOME/dcidpasswords.txt`</span>
<span class="sd">        will be used automatically.</span>
<span class="sd">    :type debug: bool, optional</span>
<span class="sd">    :param debug: Enables verbose output of the connection handling (default is</span>
<span class="sd">        ``False``).</span>
<span class="sd">    :type command_delay: float, optional</span>
<span class="sd">    :param command_delay: Delay between each command send to the ArcLink server</span>
<span class="sd">        (default is ``0``).</span>
<span class="sd">    :type status_delay: float, optional</span>
<span class="sd">    :param status_delay: Delay in seconds between each status request (default</span>
<span class="sd">        is ``0.5`` seconds).</span>

<span class="sd">    .. rubric:: Notes</span>

<span class="sd">    The following ArcLink servers may be accessed (also see</span>
<span class="sd">    http://www.orfeus-eu.org/eida/eida_advanced_users.html;</span>
<span class="sd">    maybe partly restricted access only):</span>

<span class="sd">    * WebDC: webdc.eu:18001, webdc.eu:18002</span>
<span class="sd">    * ODC:   eida.knmi.nl:18002</span>
<span class="sd">    * GFZ:   eida.gfz-potsdam.de:18001</span>
<span class="sd">    * RESIF: eida.resif.fr:18001</span>
<span class="sd">    * INGV:  --</span>
<span class="sd">    * ETHZ:  eida.ethz.ch:18001</span>
<span class="sd">    * BGR:   eida.bgr.de:18001</span>
<span class="sd">    * IPGP:  eida.ipgp.fr:18001</span>
<span class="sd">    * USP:   seisrequest.iag.usp.br:18001</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">max_status_requests</span> <span class="o">=</span> <span class="n">MAX_REQUESTS</span>

<div class="viewcode-block" id="Client.__init__"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.__init__.html#obspy.clients.arclink.client.Client.__init__">[docs]</a>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s2">&quot;webdc.eu&quot;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">18002</span><span class="p">,</span>
                 <span class="n">password</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">institution</span><span class="o">=</span><span class="s2">&quot;Anonymous&quot;</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                 <span class="n">dcid_keys</span><span class="o">=</span><span class="p">{},</span> <span class="n">dcid_key_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">command_delay</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">status_delay</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes an ArcLink client.</span>

<span class="sd">        See :class:`obspy.clients.arclink.client.Client` for all parameters.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">user</span> <span class="o">=</span> <span class="n">user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="n">password</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">institution</span> <span class="o">=</span> <span class="n">institution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_delay</span> <span class="o">=</span> <span class="n">command_delay</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">status_delay</span> <span class="o">=</span> <span class="n">status_delay</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">init_host</span> <span class="o">=</span> <span class="n">host</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_port</span> <span class="o">=</span> <span class="n">port</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dcid_keys</span> <span class="o">=</span> <span class="n">dcid_keys</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span> <span class="o">=</span> <span class="n">Telnet</span><span class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="c1"># silent connection check</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hello</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Connected to </span><span class="si">%s</span><span class="s1">:</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span><span class="p">,</span>
                                            <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span><span class="p">)))</span>
        <span class="c1"># check for dcid_key_file</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">dcid_key_file</span><span class="p">:</span>
            <span class="c1"># check in user directory</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">DCID_KEY_FILE</span><span class="p">):</span>
                <span class="k">return</span>
            <span class="n">dcid_key_file</span> <span class="o">=</span> <span class="n">DCID_KEY_FILE</span>
        <span class="c1"># parse dcid_key_file</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">dcid_key_file</span><span class="p">,</span> <span class="s1">&#39;rt&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="n">lines</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># skip empty lines</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># skip comments</span>
                <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;#&#39;</span><span class="p">):</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="s1">&#39; &#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="c1"># ensure that dcid_keys set via parameters are not overwritten</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcid_keys</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dcid_keys</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span></div>

<div class="viewcode-block" id="Client._reconnect"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client._reconnect.html#obspy.clients.arclink.client.Client._reconnect">[docs]</a>    <span class="k">def</span> <span class="nf">_reconnect</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">native_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span><span class="p">),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span><span class="p">,</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="c1"># old Python 2.7: port needs to be native int or string -&gt; not long</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">native_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span><span class="p">),</span>
                              <span class="n">native_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span><span class="p">),</span>
                              <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client._write_ln"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client._write_ln.html#obspy.clients.arclink.client.Client._write_ln">[docs]</a>    <span class="k">def</span> <span class="nf">_write_ln</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer</span><span class="p">):</span>
        <span class="c1"># Py3k: might be confusing, _write_ln accepts str</span>
        <span class="c1"># readln accepts bytes (but was smallest change like that)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command_delay</span><span class="p">:</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">command_delay</span><span class="p">)</span>
        <span class="n">b_buffer</span> <span class="o">=</span> <span class="p">(</span><span class="n">buffer</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">b_buffer</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&gt;&gt;&gt; &#39;</span> <span class="o">+</span> <span class="n">buffer</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client._read_ln"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client._read_ln.html#obspy.clients.arclink.client.Client._read_ln">[docs]</a>    <span class="k">def</span> <span class="nf">_read_ln</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="sa">b</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="n">line</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">read_until</span><span class="p">(</span><span class="n">value</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">timeout</span><span class="p">)</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Timeout waiting for expected </span><span class="si">%s</span><span class="s2">, got </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">()))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;... &#39;</span> <span class="o">+</span> <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">line</span></div>

<div class="viewcode-block" id="Client._hello"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client._hello.html#obspy.clients.arclink.client.Client._hello">[docs]</a>    <span class="k">def</span> <span class="nf">_hello</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_reconnect</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;HELLO&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">version</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_ln</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_ln</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;USER </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">password</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;USER </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_ln</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;INSTITUTION </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">institution</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_ln</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Client._bye"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client._bye.html#obspy.clients.arclink.client.Client._bye">[docs]</a>    <span class="k">def</span> <span class="nf">_bye</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;BYE&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

<div class="viewcode-block" id="Client._fetch"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client._fetch.html#obspy.clients.arclink.client.Client._fetch">[docs]</a>    <span class="k">def</span> <span class="nf">_fetch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request_data</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="c1"># skip routing on request</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">route</span><span class="p">:</span>
            <span class="c1"># always use initial node if routing is disabled</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_host</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_port</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">request_type</span><span class="p">,</span> <span class="n">request_data</span><span class="p">)</span>
        <span class="c1"># request routing table for given network/station/times combination</span>
        <span class="c1"># location and channel information are ignored by ArcLink</span>
        <span class="n">routes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_routing</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">request_data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                  <span class="n">station</span><span class="o">=</span><span class="n">request_data</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                                  <span class="n">starttime</span><span class="o">=</span><span class="n">request_data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                                  <span class="n">endtime</span><span class="o">=</span><span class="n">request_data</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># search routes for network/station/location/channel</span>
        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_find_route</span><span class="p">(</span><span class="n">routes</span><span class="p">,</span> <span class="n">request_data</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">table</span><span class="p">:</span>
            <span class="c1"># retry first ArcLink node if host or port has been changed</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_host</span> <span class="ow">or</span> \
               <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_port</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_host</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">init_port</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Requesting </span><span class="si">%s</span><span class="s1">:</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span><span class="p">,</span>
                                                  <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span><span class="p">))</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">request_type</span><span class="p">,</span> <span class="n">request_data</span><span class="p">,</span> <span class="n">route</span><span class="p">)</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Could not find route to </span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">. If you think the data &#39;</span> <span class="o">+</span> \
                  <span class="s1">&#39;should be there, you might want to retry &#39;</span> <span class="o">+</span> \
                  <span class="s1">&#39;with manually connecting to a different ArcLink node &#39;</span> <span class="o">+</span> \
                  <span class="s1">&#39;(see docstring of Client) to see if there is a problem &#39;</span> <span class="o">+</span> \
                  <span class="s1">&#39;with a routing table at a specific ArcLink node (and &#39;</span> <span class="o">+</span> \
                  <span class="s1">&#39;contact the ArcLink node operators).&#39;</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">request_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span>
        <span class="c1"># we got a routing table</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">table</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="p">{}:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">request_type</span><span class="p">,</span> <span class="n">request_data</span><span class="p">)</span>
            <span class="c1"># check if current connection is enough</span>
            <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span> <span class="ow">and</span> \
               <span class="n">item</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">request_type</span><span class="p">,</span> <span class="n">request_data</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">item</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Requesting </span><span class="si">%s</span><span class="s1">:</span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">host</span><span class="p">,</span>
                                              <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">port</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reconnect</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="n">request_type</span><span class="p">,</span> <span class="n">request_data</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">ArcLinkException</span><span class="p">:</span>
                <span class="k">raise</span>
            <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                <span class="k">raise</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Could not find route to </span><span class="si">%s</span><span class="s1">.</span><span class="si">%s</span><span class="s1">&#39;</span>
        <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">request_data</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">request_data</span><span class="p">[</span><span class="mi">3</span><span class="p">]))</span></div>

<div class="viewcode-block" id="Client._request"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client._request.html#obspy.clients.arclink.client.Client._request">[docs]</a>    <span class="k">def</span> <span class="nf">_request</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request_type</span><span class="p">,</span> <span class="n">request_data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_hello</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="n">request_type</span><span class="p">)</span>
        <span class="c1"># create request string</span>
        <span class="c1"># adding one second to start and end time to ensure right date times</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">(</span><span class="n">request_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format_arclink</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="p">(</span><span class="n">request_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">format_arclink</span><span class="p">()</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>
        <span class="n">out</span> <span class="o">+=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">request_data</span><span class="p">[</span><span class="mi">2</span><span class="p">:]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;END&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_read_ln</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;OK&#39;</span><span class="p">)</span>
        <span class="c1"># get status id</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">status</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_ln</span><span class="p">()</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">req_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">status</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;ERROR&#39;</span> <span class="ow">in</span> <span class="n">status</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_bye</span><span class="p">()</span>
                    <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="s1">&#39;Error requesting status id&#39;</span><span class="p">)</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="c1"># loop until we hit ready=&quot;true&quot; in the status message</span>
        <span class="n">_loops</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">_old_xml_doc</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;STATUS </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">req_id</span><span class="p">)</span>
            <span class="n">xml_doc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_read_ln</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;END&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;ready=&quot;true&quot;&#39;</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="c1"># check if status messages changes over time</span>
            <span class="k">if</span> <span class="n">_old_xml_doc</span> <span class="o">==</span> <span class="n">xml_doc</span><span class="p">:</span>
                <span class="n">_loops</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_loops</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="n">_old_xml_doc</span> <span class="o">=</span> <span class="n">xml_doc</span>
            <span class="c1"># if we hit max_status_requests equal status break the loop</span>
            <span class="k">if</span> <span class="n">_loops</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_status_requests</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;max_status_requests (</span><span class="si">%s</span><span class="s1">) exceeded - breaking current &#39;</span>
                       <span class="s1">&#39;request loop&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_status_requests</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="ne">UserWarning</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="c1"># wait a bit</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">status_delay</span><span class="p">)</span>
        <span class="c1"># check for errors</span>
        <span class="k">for</span> <span class="n">err_code</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">b</span><span class="s1">&#39;DENIED&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;CANCELLED&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;CANCEL&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;ERROR&#39;</span><span class="p">,</span>
                         <span class="sa">b</span><span class="s1">&#39;RETRY&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;WARN&#39;</span><span class="p">,</span> <span class="sa">b</span><span class="s1">&#39;UNSET&#39;</span><span class="p">):</span>
            <span class="n">err_str</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;status=&quot;&#39;</span> <span class="o">+</span> <span class="n">err_code</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;&quot;&#39;</span>
            <span class="k">if</span> <span class="n">err_str</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="p">:</span>
                <span class="c1"># cleanup</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;PURGE </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">req_id</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_bye</span><span class="p">()</span>
                <span class="c1"># parse XML for reason</span>
                <span class="n">xml_doc</span> <span class="o">=</span> <span class="n">objectify</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_doc</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="s2"> </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">err_code</span><span class="p">,</span> <span class="n">msg</span><span class="p">))</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;status=&quot;NODATA&quot;&#39;</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="p">:</span>
            <span class="c1"># cleanup</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;PURGE </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">req_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bye</span><span class="p">()</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="s1">&#39;No data available&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="sa">b</span><span class="s1">&#39;id=&quot;NODATA&quot;&#39;</span> <span class="ow">in</span> <span class="n">xml_doc</span> <span class="ow">or</span> <span class="sa">b</span><span class="s1">&#39;id=&quot;ERROR&quot;&#39;</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="p">:</span>
            <span class="c1"># cleanup</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;PURGE </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">req_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bye</span><span class="p">()</span>
            <span class="c1"># parse XML for error message</span>
            <span class="n">xml_doc</span> <span class="o">=</span> <span class="n">objectify</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_doc</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;message&#39;</span><span class="p">))</span>
        <span class="k">elif</span> <span class="sa">b</span><span class="s1">&#39;&lt;line content&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="p">:</span>
            <span class="c1"># safeguard for not covered status messages</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;PURGE </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">req_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bye</span><span class="p">()</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Uncovered status message - contact a developer to fix this&quot;</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;DOWNLOAD </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">req_id</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_client</span><span class="o">.</span><span class="n">get_socket</span><span class="p">()</span><span class="o">.</span><span class="n">makefile</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">)</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">fd</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">data</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;&#39;</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">length</span><span class="p">:</span>
                <span class="n">buf</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="mi">4096</span><span class="p">,</span> <span class="n">length</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
                <span class="n">data</span> <span class="o">+=</span> <span class="n">buf</span>
            <span class="n">buf</span> <span class="o">=</span> <span class="n">fd</span><span class="o">.</span><span class="n">readline</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">buf</span> <span class="o">!=</span> <span class="sa">b</span><span class="s2">&quot;END&quot;</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">!=</span> <span class="n">length</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Wrong length!&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;&lt;?xml&#39;</span><span class="p">):</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> bytes of data read&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_write_ln</span><span class="p">(</span><span class="s1">&#39;PURGE </span><span class="si">%d</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">req_id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_bye</span><span class="p">()</span>
        <span class="c1"># check for encryption</span>
        <span class="k">if</span> <span class="sa">b</span><span class="s1">&#39;encrypted=&quot;true&quot;&#39;</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="p">:</span>
            <span class="c1"># extract dcid</span>
            <span class="n">xml_doc</span> <span class="o">=</span> <span class="n">objectify</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_doc</span><span class="p">[:</span><span class="o">-</span><span class="mi">3</span><span class="p">])</span>
            <span class="n">dcid</span> <span class="o">=</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">volume</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;dcid&#39;</span><span class="p">)</span>
            <span class="c1"># check if given in known list of keys</span>
            <span class="k">if</span> <span class="n">dcid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dcid_keys</span><span class="p">:</span>
                <span class="c1"># call decrypt routine</span>
                <span class="kn">from</span> <span class="nn">obspy.clients.arclink.decrypt</span> <span class="k">import</span> <span class="n">SSLWrapper</span>
                <span class="n">decryptor</span> <span class="o">=</span> <span class="n">SSLWrapper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dcid_keys</span><span class="p">[</span><span class="n">dcid</span><span class="p">])</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">+=</span> <span class="n">decryptor</span><span class="o">.</span><span class="n">final</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Could not decrypt waveform data for dcid </span><span class="si">%s</span><span class="s2">.&quot;</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="n">dcid</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">data</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getWaveform&#39; has been renamed to &#39;get_waveforms&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getWaveform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_waveforms</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.get_waveforms"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.get_waveforms.html#obspy.clients.arclink.client.Client.get_waveforms">[docs]</a>    <span class="k">def</span> <span class="nf">get_waveforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">starttime</span><span class="p">,</span>
                      <span class="n">endtime</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;MSEED&quot;</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">metadata</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">route</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves waveform data via ArcLink and returns an ObsPy Stream object.</span>

<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Station code, e.g. ``&#39;MANZ&#39;``.</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Location code, e.g. ``&#39;01&#39;``. Location code may</span>
<span class="sd">            contain wild cards.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Channel code, e.g. ``&#39;EHE&#39;``. Channel code may</span>
<span class="sd">            contain wild cards.</span>
<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Start date and time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: End date and time.</span>
<span class="sd">        :type format: str, optional</span>
<span class="sd">        :param format: Output format. Either as full SEED (``&#39;FSEED&#39;``) or</span>
<span class="sd">            Mini-SEED (``&#39;MSEED&#39;``) volume. Defaults to ``&#39;MSEED&#39;``.</span>
<span class="sd">        :type compressed: bool, optional</span>
<span class="sd">        :param compressed: Request compressed files from ArcLink server.</span>
<span class="sd">            Defaults to ``True``.</span>
<span class="sd">        :type metadata: bool, optional</span>
<span class="sd">        :param metadata: Fetch PAZ and coordinate information and append to</span>
<span class="sd">            :class:`~obspy.core.trace.Stats` of all fetched traces. Defaults</span>
<span class="sd">            to ``False``.</span>
<span class="sd">        :type route: bool, optional</span>
<span class="sd">        :param route: Enables ArcLink routing. Defaults to ``True``.</span>
<span class="sd">        :return: ObsPy :class:`~obspy.core.stream.Stream` object.</span>

<span class="sd">        .. rubric:: Example</span>

<span class="sd">        &gt;&gt;&gt; from obspy.clients.arclink import Client</span>
<span class="sd">        &gt;&gt;&gt; from obspy import UTCDateTime</span>
<span class="sd">        &gt;&gt;&gt; client = Client(&#39;test@obspy.org&#39;, &#39;webdc.eu&#39;, 18001)</span>
<span class="sd">        &gt;&gt;&gt; t = UTCDateTime(&quot;2009-08-20 04:03:12&quot;)</span>
<span class="sd">        &gt;&gt;&gt; st = client.get_waveforms(&quot;BW&quot;, &quot;RJOB&quot;, &quot;&quot;, &quot;EH*&quot;, t - 3, t + 15)</span>
<span class="sd">        &gt;&gt;&gt; st.plot() #doctest: +SKIP</span>

<span class="sd">        .. plot::</span>

<span class="sd">            from obspy import UTCDateTime</span>
<span class="sd">            from obspy.clients.arclink.client import Client</span>
<span class="sd">            client = Client(&#39;test@obspy.org&#39;, &#39;webdc.eu&#39;, 18001)</span>
<span class="sd">            t = UTCDateTime(&quot;2009-08-20 04:03:12&quot;)</span>
<span class="sd">            st = client.get_waveforms(&quot;BW&quot;, &quot;RJOB&quot;, &quot;&quot;, &quot;EH*&quot;, t - 3, t + 15)</span>
<span class="sd">            st.plot()</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># handle deprecated keywords - one must be True to enable metadata</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span>
        <span class="n">file_stream</span> <span class="o">=</span> <span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">save_waveforms</span><span class="p">(</span><span class="n">file_stream</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span>
                            <span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span>
                            <span class="n">compressed</span><span class="o">=</span><span class="n">compressed</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="n">route</span><span class="p">)</span>
        <span class="n">file_stream</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">stream</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">file_stream</span><span class="p">,</span> <span class="s1">&#39;MSEED&#39;</span><span class="p">)</span>
        <span class="n">file_stream</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="c1"># trim stream</span>
        <span class="n">stream</span><span class="o">.</span><span class="n">trim</span><span class="p">(</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">)</span>
        <span class="c1"># fetching PAZ and coordinates</span>
        <span class="k">if</span> <span class="n">metadata</span><span class="p">:</span>
            <span class="c1"># fetch metadata only once</span>
            <span class="n">inv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span>
                                     <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span>
                                     <span class="n">starttime</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span>
                                     <span class="n">instruments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="n">route</span><span class="p">)</span>
            <span class="n">netsta</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">])</span>
            <span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;elevation&#39;</span><span class="p">]:</span>
                <span class="n">coordinates</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">inv</span><span class="p">[</span><span class="n">netsta</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">tr</span> <span class="ow">in</span> <span class="n">stream</span><span class="p">:</span>
                <span class="c1"># add coordinates</span>
                <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coordinates</span>
                <span class="c1"># add PAZ</span>
                <span class="n">entries</span> <span class="o">=</span> <span class="n">inv</span><span class="p">[</span><span class="n">tr</span><span class="o">.</span><span class="n">id</span><span class="p">]</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># multiple entries found</span>
                    <span class="k">for</span> <span class="n">entry</span> <span class="ow">in</span> <span class="n">entries</span><span class="p">:</span>
                        <span class="c1"># trim current trace to timespan of current entry</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">slice</span><span class="p">(</span><span class="n">entry</span><span class="o">.</span><span class="n">starttime</span><span class="p">,</span>
                                        <span class="n">entry</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;endtime&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
                        <span class="c1"># append valid paz</span>
                        <span class="k">if</span> <span class="s1">&#39;paz&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">MSG_NOPAZ</span><span class="p">)</span>
                        <span class="n">temp</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;paz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">paz</span>
                        <span class="c1"># add to end of stream</span>
                        <span class="n">stream</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
                    <span class="c1"># remove split trace</span>
                    <span class="n">stream</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">tr</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># single entry found - apply direct</span>
                    <span class="n">entry</span> <span class="o">=</span> <span class="n">entries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="s1">&#39;paz&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">entry</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">MSG_NOPAZ</span><span class="p">)</span>
                    <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="p">[</span><span class="s1">&#39;paz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">entry</span><span class="o">.</span><span class="n">paz</span>
        <span class="k">return</span> <span class="n">stream</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;saveWaveform&#39; has been renamed to &#39;save_waveforms&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">saveWaveform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_waveforms</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.save_waveforms"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.save_waveforms.html#obspy.clients.arclink.client.Client.save_waveforms">[docs]</a>    <span class="k">def</span> <span class="nf">save_waveforms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span>
                       <span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;MSEED&quot;</span><span class="p">,</span> <span class="n">compressed</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                       <span class="n">route</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes a retrieved waveform directly into a file.</span>

<span class="sd">        This method ensures the storage of the unmodified waveform data</span>
<span class="sd">        delivered by the ArcLink server, e.g. preserving the record based</span>
<span class="sd">        quality flags of MiniSEED files which would be neglected reading it</span>
<span class="sd">        with :mod:`obspy.io.mseed`.</span>

<span class="sd">        :type filename: str</span>
<span class="sd">        :param filename: Name of the output file.</span>
<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Station code, e.g. ``&#39;MANZ&#39;``.</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Location code, e.g. ``&#39;01&#39;``. Location code may</span>
<span class="sd">            contain wild cards.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Channel code, e.g. ``&#39;EHE&#39;``. Channel code may</span>
<span class="sd">            contain wild cards.</span>
<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Start date and time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: End date and time.</span>
<span class="sd">        :type format: str, optional</span>
<span class="sd">        :param format: Output format. Either as full SEED (``&#39;FSEED&#39;``) or</span>
<span class="sd">            Mini-SEED (``&#39;MSEED&#39;``) volume. Defaults to ``&#39;MSEED&#39;``.</span>

<span class="sd">            .. note::</span>
<span class="sd">                A format ``&#39;XSEED&#39;`` is documented, but not yet implemented in</span>
<span class="sd">                ArcLink.</span>
<span class="sd">        :type compressed: bool, optional</span>
<span class="sd">        :param compressed: Request compressed files from ArcLink server.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        :type route: bool, optional</span>
<span class="sd">        :param route: Enables ArcLink routing. Default is ``True``.</span>
<span class="sd">        :type unpack: bool, optional</span>
<span class="sd">        :param unpack: Unpack compressed waveform files before storing to disk.</span>
<span class="sd">            Default is ``True``.</span>
<span class="sd">        :return: None</span>

<span class="sd">        .. rubric:: Example</span>

<span class="sd">        &gt;&gt;&gt; from obspy.clients.arclink import Client</span>
<span class="sd">        &gt;&gt;&gt; from obspy import UTCDateTime</span>
<span class="sd">        &gt;&gt;&gt; client = Client(&#39;test@obspy.org&#39;, &#39;webdc.eu&#39;, 18001)</span>
<span class="sd">        &gt;&gt;&gt; t = UTCDateTime(2009, 1, 1, 12, 0)</span>
<span class="sd">        &gt;&gt;&gt; client.save_waveforms(&#39;BW.MANZ.fullseed&#39;, &#39;BW&#39;, &#39;MANZ&#39;, &#39;&#39;, &#39;*&#39;,</span>
<span class="sd">        ...                     t, t + 20, format=&#39;FSEED&#39;)  # doctest: +SKIP</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;MSEED&quot;</span><span class="p">,</span> <span class="s2">&quot;FSEED&quot;</span><span class="p">]:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not a valid format. Choose either &#39;MSEED&#39; or &quot;</span>
                   <span class="s2">&quot;&#39;FSEED&#39;&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># check parameters</span>
        <span class="n">is_name</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">native_str</span><span class="p">))</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Parameter filename must be either string or file handler.&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># request type</span>
        <span class="n">rtype</span> <span class="o">=</span> <span class="s1">&#39;REQUEST WAVEFORM format=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">format</span>
        <span class="k">if</span> <span class="n">compressed</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="kn">import</span> <span class="nn">bz2</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">compressed</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">rtype</span> <span class="o">+=</span> <span class="s2">&quot; compression=bzip2&quot;</span>
        <span class="c1"># request data</span>
        <span class="n">rdata</span> <span class="o">=</span> <span class="p">[</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">location</span><span class="p">]</span>
        <span class="c1"># fetch waveform</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">rtype</span><span class="p">,</span> <span class="n">rdata</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="n">route</span><span class="p">)</span>
        <span class="c1"># check if data is still encrypted</span>
        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;Salted__&#39;</span><span class="p">):</span>
            <span class="c1"># set &quot;good&quot; file names</span>
            <span class="k">if</span> <span class="n">is_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">compressed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.bz2.openssl&#39;</span><span class="p">):</span>
                    <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;.bz2.openssl&#39;</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">compressed</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.openssl&#39;</span><span class="p">):</span>
                    <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;.openssl&#39;</span>
            <span class="c1"># warn user that encoded files will not be unpacked</span>
            <span class="k">if</span> <span class="n">unpack</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Cannot unpack encrypted waveforms.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># not encoded - handle as usual</span>
            <span class="k">if</span> <span class="n">compressed</span><span class="p">:</span>
                <span class="c1"># unpack compressed data if option unpack is set</span>
                <span class="k">if</span> <span class="n">unpack</span><span class="p">:</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">bz2</span><span class="o">.</span><span class="n">decompress</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">is_name</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.bz2&#39;</span><span class="p">):</span>
                    <span class="c1"># set &quot;good&quot; file names</span>
                    <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;.bz2&#39;</span>
        <span class="c1"># create file handler if a file name is given</span>
        <span class="k">if</span> <span class="n">is_name</span><span class="p">:</span>
            <span class="n">fh</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fh</span> <span class="o">=</span> <span class="n">filename</span>
        <span class="n">fh</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">is_name</span><span class="p">:</span>
            <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getRouting&#39; has been renamed to &#39;get_routing&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getRouting</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_routing</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.get_routing"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.get_routing.html#obspy.clients.arclink.client.Client.get_routing">[docs]</a>    <span class="k">def</span> <span class="nf">get_routing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span>
                    <span class="n">modified_after</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get primary ArcLink host for given network/stations/time combination.</span>

<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Station code, e.g. ``&#39;MANZ&#39;``.</span>
<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Start date and time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: End date and time.</span>
<span class="sd">        :type modified_after: :class:`~obspy.core.utcdatetime.UTCDateTime`,</span>
<span class="sd">            optional</span>
<span class="sd">        :param modified_after: Returns only data modified after given date.</span>
<span class="sd">            Default is ``None``, returning all available data.</span>
<span class="sd">        :return: Dictionary of host names.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># request type</span>
        <span class="n">rtype</span> <span class="o">=</span> <span class="s1">&#39;REQUEST ROUTING &#39;</span>
        <span class="k">if</span> <span class="n">modified_after</span><span class="p">:</span>
            <span class="n">rtype</span> <span class="o">+=</span> <span class="s1">&#39;modified_after=</span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">modified_after</span><span class="o">.</span><span class="n">format_arclink</span><span class="p">()</span>
        <span class="c1"># request data</span>
        <span class="n">rdata</span> <span class="o">=</span> <span class="p">[</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">]</span>
        <span class="c1"># fetch plain XML document</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">rtype</span><span class="p">,</span> <span class="n">rdata</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># parse XML document</span>
        <span class="n">xml_doc</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="c1"># get routing version</span>
        <span class="k">if</span> <span class="n">_ROUTING_NS_1_0</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">nsmap</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">xml_ns</span> <span class="o">=</span> <span class="n">_ROUTING_NS_1_0</span>
        <span class="k">elif</span> <span class="n">_ROUTING_NS_0_1</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">nsmap</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">xml_ns</span> <span class="o">=</span> <span class="n">_ROUTING_NS_0_1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Unknown routing namespace </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">nsmap</span><span class="p">)</span>
        <span class="c1"># convert into dictionary</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">route</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns0:route&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns0&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">}):</span>
            <span class="k">if</span> <span class="n">xml_ns</span> <span class="o">==</span> <span class="n">_ROUTING_NS_0_1</span><span class="p">:</span>
                <span class="c1"># no location/stream codes in 0.1</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="n">route</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;net_code&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">route</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;sta_code&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;..&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">id</span> <span class="o">=</span> <span class="n">route</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;networkCode&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> \
                    <span class="n">route</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;stationCode&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> \
                    <span class="n">route</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;locationCode&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> \
                    <span class="n">route</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;streamCode&#39;</span><span class="p">)</span>
            <span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">route</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns0:arclink&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns0&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">}):</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="p">{}</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;priority&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;priority&#39;</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;priority&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">):</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;end&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="c1"># address field may contain multiple addresses (?)</span>
                <span class="n">address</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;address&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;host&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">address</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">address</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Client._find_route"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client._find_route.html#obspy.clients.arclink.client.Client._find_route">[docs]</a>    <span class="k">def</span> <span class="nf">_find_route</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">routes</span><span class="p">,</span> <span class="n">request_data</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Searches routing table for requested stream id and date/times.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Note: Filtering by date/times is not really supported by ArcLink yet,</span>
        <span class="c1"># therefore not included here</span>
        <span class="c1"># Multiple fitting entries are sorted by priority only</span>
        <span class="n">net</span><span class="p">,</span> <span class="n">sta</span><span class="p">,</span> <span class="n">cha</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="p">(</span><span class="n">request_data</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">])[</span><span class="mi">2</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">keys</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">routes</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="n">key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">net</span> <span class="o">!=</span> <span class="s1">&#39;*&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fnmatch</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">net</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">sta</span> <span class="o">!=</span> <span class="s1">&#39;*&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fnmatch</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sta</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="ow">and</span> <span class="n">loc</span> <span class="o">!=</span> <span class="s1">&#39;*&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fnmatch</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">loc</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">parts</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="ow">and</span> <span class="n">cha</span> <span class="o">!=</span> <span class="s1">&#39;*&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">fnmatch</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">cha</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">keys</span><span class="p">:</span>
            <span class="c1"># no route found</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="c1"># merge all</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">routes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">temp</span> <span class="o">==</span> <span class="p">[]:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">append</span><span class="p">({})</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>
        <span class="c1"># sort by priority</span>
        <span class="n">out</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;priority&#39;</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">out</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getQC&#39; has been renamed to &#39;get_qc&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getQC</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_qc</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.get_qc"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.get_qc.html#obspy.clients.arclink.client.Client.get_qc">[docs]</a>    <span class="k">def</span> <span class="nf">get_qc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">starttime</span><span class="p">,</span>
               <span class="n">endtime</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">outages</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logs</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieve QC information of ArcLink streams.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Requesting QC is documented but seems not to work at the moment.</span>

<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Station code, e.g. ``&#39;MANZ&#39;``.</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Location code, e.g. ``&#39;01&#39;``.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Channel code, e.g. ``&#39;EHE&#39;``.</span>
<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Start date and time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: End date and time.</span>
<span class="sd">        :type parameters: str, optional</span>
<span class="sd">        :param parameters: Comma-separated list of QC parameters. The following</span>
<span class="sd">            QC parameters are implemented in the present version:</span>
<span class="sd">            ``&#39;availability&#39;``, ``&#39;delay&#39;``, ``&#39;gaps count&#39;``,</span>
<span class="sd">            ``&#39;gaps interval&#39;``, ``&#39;gaps length&#39;``, ``&#39;latency&#39;``,</span>
<span class="sd">            ``&#39;offset&#39;``, ``&#39;overlaps count&#39;``, ``&#39;overlaps interval&#39;``,</span>
<span class="sd">            ``&#39;overlaps length&#39;``, ``&#39;rms&#39;``, ``&#39;spikes amplitude&#39;``,</span>
<span class="sd">            ``&#39;spikes count&#39;``, ``&#39;spikes interval&#39;``, ``&#39;timing quality&#39;``</span>
<span class="sd">            (default is ``&#39;*&#39;`` for requesting all parameters).</span>
<span class="sd">        :type outages: bool, optional</span>
<span class="sd">        :param outages: Include list of outages (default is ``True``).</span>
<span class="sd">        :type logs: bool, optional</span>
<span class="sd">        :param logs: Include log messages (default is ``True``).</span>
<span class="sd">        :return: XML document as string.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># request type</span>
        <span class="n">rtype</span> <span class="o">=</span> <span class="s1">&#39;REQUEST QC&#39;</span>
        <span class="k">if</span> <span class="n">outages</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">rtype</span> <span class="o">+=</span> <span class="s1">&#39; outages=true&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rtype</span> <span class="o">+=</span> <span class="s1">&#39; outages=false&#39;</span>
        <span class="k">if</span> <span class="n">logs</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">rtype</span> <span class="o">+=</span> <span class="s1">&#39; logs=false&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rtype</span> <span class="o">+=</span> <span class="s1">&#39; logs=false&#39;</span>
        <span class="n">rtype</span> <span class="o">+=</span> <span class="s1">&#39; parameters=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
        <span class="c1"># request data</span>
        <span class="n">rdata</span> <span class="o">=</span> <span class="p">[</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">location</span><span class="p">]</span>
        <span class="c1"># fetch plain XML document</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">rtype</span><span class="p">,</span> <span class="n">rdata</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getMetadata&#39; has been renamed to &#39;get_metadata&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getMetadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_metadata</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.get_metadata"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.get_metadata.html#obspy.clients.arclink.client.Client.get_metadata">[docs]</a>    <span class="k">def</span> <span class="nf">get_metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span>
                     <span class="n">route</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns poles, zeros, normalization factor and sensitivity and station</span>
<span class="sd">        coordinates for a single channel at a given time.</span>

<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Station code, e.g. ``&#39;MANZ&#39;``.</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Location code, e.g. ``&#39;01&#39;``.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Channel code, e.g. ``&#39;EHE&#39;``.</span>
<span class="sd">        :type time: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param time: Date and time.</span>
<span class="sd">        :type route: bool, optional</span>
<span class="sd">        :param route: Enables ArcLink routing (default is ``True``).</span>
<span class="sd">        :return: Dictionary containing keys &#39;paz&#39; and &#39;coordinates&#39;.</span>


<span class="sd">        .. rubric:: Example</span>

<span class="sd">        &gt;&gt;&gt; from obspy.clients.arclink import Client</span>
<span class="sd">        &gt;&gt;&gt; from obspy import UTCDateTime</span>
<span class="sd">        &gt;&gt;&gt; client = Client(&#39;test@obspy.org&#39;, &#39;webdc.eu&#39;, 18001)</span>
<span class="sd">        &gt;&gt;&gt; t = UTCDateTime(2009, 1, 1)</span>
<span class="sd">        &gt;&gt;&gt; data = client.get_metadata(&#39;BW&#39;, &#39;MANZ&#39;, &#39;&#39;, &#39;EHZ&#39;, t)</span>
<span class="sd">        &gt;&gt;&gt; data  # doctest: +NORMALIZE_WHITESPACE +SKIP</span>
<span class="sd">        {&#39;paz&#39;: AttribDict({&#39;poles&#39;: [(-0.037004+0.037016j),</span>
<span class="sd">                                      (-0.037004-0.037016j), (-251.33+0j),</span>
<span class="sd">                                      (-131.04-467.29j), (-131.04+467.29j)],</span>
<span class="sd">                            &#39;sensitivity&#39;: 2516778600.0, &#39;zeros&#39;: [0j, 0j],</span>
<span class="sd">                            &#39;name&#39;: &#39;LMU:STS-2/N/g=1500&#39;,</span>
<span class="sd">                            &#39;normalization_factor&#39;: 60077000.0}),</span>
<span class="sd">        &#39;coordinates&#39;: AttribDict({&#39;latitude&#39;: 49.9862, &#39;elevation&#39;: 635.0,</span>
<span class="sd">                                   &#39;longitude&#39;: 12.1083})}</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">time</span><span class="p">:</span>
            <span class="c1"># if not temporal keyword is given raise an exception</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;keyword &#39;time&#39; is required&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># time is given</span>
            <span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span>
            <span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="mf">0.000001</span>
        <span class="c1"># check if single trace</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="nb">id</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;get_metadata supports only a single channel, use &#39;</span> <span class="o">+</span> \
                  <span class="s1">&#39;get_inventory instead&#39;</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># fetch inventory</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span>
                                    <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span>
                                    <span class="n">starttime</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span>
                                    <span class="n">instruments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="n">route</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="c1"># paz</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">])</span>
        <span class="c1"># HACK: returning first PAZ only for now - should happen only for a</span>
        <span class="c1"># timespan and not a single time</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Multiple PAZ found for </span><span class="si">%s</span><span class="s2">. Applying first PAZ.&quot;</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="ne">UserWarning</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;paz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">paz</span>
        <span class="c1"># coordinates</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">])</span>
        <span class="n">data</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;elevation&#39;</span><span class="p">]:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;coordinates&#39;</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="n">key</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">data</span></div>

    <span class="k">def</span> <span class="nf">__parse_paz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">xml_doc</span><span class="p">,</span> <span class="n">xml_ns</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">()</span>
        <span class="c1"># instrument name</span>
        <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>

        <span class="c1"># Response type: A=Laplace(rad/s), B=Analog(Hz), C, D</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># normalization factor</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xml_ns</span> <span class="o">==</span> <span class="n">_INVENTORY_NS_1_0</span><span class="p">:</span>
                <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_factor&#39;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="nb">float</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normalizationFactor&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;norm_fac&#39;</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">xml_ns</span> <span class="o">==</span> <span class="n">_INVENTORY_NS_1_0</span><span class="p">:</span>
                <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_frequency&#39;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="nb">float</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;normalizationFrequency&#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_frequency&#39;</span><span class="p">]</span> <span class="o">=</span> \
                    <span class="nb">float</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;norm_freq&#39;</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># for backwards compatibility (but this is wrong naming!)</span>
        <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;gain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_factor&#39;</span><span class="p">]</span>

        <span class="c1"># zeros</span>
        <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">xml_ns</span> <span class="o">==</span> <span class="n">_INVENTORY_NS_1_0</span><span class="p">:</span>
            <span class="n">nzeros</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;numberOfZeros&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nzeros</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;nzeros&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">zeros</span> <span class="o">=</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns:zeros/text()&#39;</span><span class="p">,</span>
                                  <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">zeros</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)(&#39;</span><span class="p">,</span> <span class="s1">&#39;) (&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">zeros</span> <span class="ow">in</span> <span class="n">temp</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complexify_string</span><span class="p">(</span><span class="n">zeros</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c1"># check number of zeros</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paz</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="n">nzeros</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="s1">&#39;Could not parse all zeros&#39;</span><span class="p">)</span>
        <span class="c1"># poles</span>
        <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">xml_ns</span> <span class="o">==</span> <span class="n">_INVENTORY_NS_1_0</span><span class="p">:</span>
            <span class="n">npoles</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;numberOfPoles&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">npoles</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_doc</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;npoles&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">poles</span> <span class="o">=</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns:poles/text()&#39;</span><span class="p">,</span>
                                  <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">temp</span> <span class="o">=</span> <span class="n">poles</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;)(&#39;</span><span class="p">,</span> <span class="s1">&#39;) (&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">poles</span> <span class="ow">in</span> <span class="n">temp</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
                <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">complexify_string</span><span class="p">(</span><span class="n">poles</span><span class="p">))</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c1"># check number of poles</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">paz</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">])</span> <span class="o">!=</span> <span class="n">npoles</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="s1">&#39;Could not parse all poles&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">paz</span>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getPAZ&#39; has been renamed to &#39;get_paz&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getPAZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_paz</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.get_paz"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.get_paz.html#obspy.clients.arclink.client.Client.get_paz">[docs]</a>    <span class="k">def</span> <span class="nf">get_paz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span>
                <span class="n">route</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns poles, zeros, normalization factor and sensitivity for a</span>
<span class="sd">        single channel at a given time.</span>

<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Station code, e.g. ``&#39;MANZ&#39;``.</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Location code, e.g. ``&#39;01&#39;``.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Channel code, e.g. ``&#39;EHE&#39;``.</span>
<span class="sd">        :type time: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param time: Date and time.</span>
<span class="sd">        :type route: bool, optional</span>
<span class="sd">        :param route: Enables ArcLink routing. Defaults to ``True``.</span>
<span class="sd">        :return: Dictionary containing PAZ information.</span>

<span class="sd">        .. rubric:: Example</span>

<span class="sd">        &gt;&gt;&gt; from obspy.clients.arclink import Client</span>
<span class="sd">        &gt;&gt;&gt; from obspy import UTCDateTime</span>
<span class="sd">        &gt;&gt;&gt; client = Client(&#39;test@obspy.org&#39;, &#39;webdc.eu&#39;, 18001)</span>
<span class="sd">        &gt;&gt;&gt; t = UTCDateTime(2009, 1, 1)</span>
<span class="sd">        &gt;&gt;&gt; paz = client.get_paz(&#39;BW&#39;, &#39;MANZ&#39;, &#39;&#39;, &#39;EHZ&#39;, t)</span>
<span class="sd">        &gt;&gt;&gt; paz  # doctest: +NORMALIZE_WHITESPACE +SKIP</span>
<span class="sd">        AttribDict({&#39;poles&#39;: [(-0.037004+0.037016j), (-0.037004-0.037016j),</span>
<span class="sd">                              (-251.33+0j), (-131.04-467.29j),</span>
<span class="sd">                              (-131.04+467.29j)],</span>
<span class="sd">                    &#39;sensitivity&#39;: 2516778600.0,</span>
<span class="sd">                    &#39;zeros&#39;: [0j, 0j],</span>
<span class="sd">                    &#39;name&#39;: &#39;LMU:STS-2/N/g=1500&#39;,</span>
<span class="sd">                    &#39;normalization_factor&#39;: 60077000.0})</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">time</span><span class="p">:</span>
            <span class="c1"># if not temporal keyword is given raise an exception</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;keyword &#39;time&#39; is required&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># time is given</span>
            <span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span>
            <span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="mf">0.000001</span>
        <span class="c1"># check if single trace</span>
        <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">])</span>
        <span class="k">if</span> <span class="s1">&#39;*&#39;</span> <span class="ow">in</span> <span class="nb">id</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;get_paz supports only a single channel, &#39;</span>
                   <span class="s1">&#39;use get_inventory instead&#39;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># fetch inventory</span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="n">station</span><span class="p">,</span>
                                    <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="n">channel</span><span class="p">,</span>
                                    <span class="n">starttime</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span>
                                    <span class="n">instruments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="n">route</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">time</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># old deprecated schema (ARGS!!!!)</span>
                <span class="c1"># HACK: returning first PAZ only for now</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Multiple PAZ found for </span><span class="si">%s</span><span class="s2">. Applying first PAZ.&quot;</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="p">(</span><span class="nb">id</span><span class="p">),</span> <span class="ne">UserWarning</span><span class="p">)</span>
                <span class="n">paz</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">paz</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">paz</span><span class="o">.</span><span class="n">name</span><span class="p">:</span> <span class="n">paz</span><span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># new schema</span>
                <span class="k">return</span> <span class="n">result</span><span class="p">[</span><span class="nb">id</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">paz</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s1">&#39;Could not find PAZ for channel </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">id</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;saveResponse&#39; has been renamed to &#39;save_response&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">saveResponse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">save_response</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.save_response"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.save_response.html#obspy.clients.arclink.client.Client.save_response">[docs]</a>    <span class="k">def</span> <span class="nf">save_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span>
                      <span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;SEED&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes response information into a file.</span>

<span class="sd">        :type filename: str or file</span>
<span class="sd">        :param filename: Name of the output file or open file like object.</span>
<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Station code, e.g. ``&#39;MANZ&#39;``.</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Location code, e.g. ``&#39;01&#39;``.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Channel code, e.g. ``&#39;EHE&#39;``.</span>
<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Start date and time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: End date and time.</span>
<span class="sd">        :type format: str, optional</span>
<span class="sd">        :param format: Output format. Currently only Dataless SEED (``&#39;SEED&#39;``)</span>
<span class="sd">            is supported.</span>
<span class="sd">        :return: None</span>

<span class="sd">        .. rubric:: Example</span>

<span class="sd">        &gt;&gt;&gt; from obspy.clients.arclink import Client</span>
<span class="sd">        &gt;&gt;&gt; from obspy import UTCDateTime</span>
<span class="sd">        &gt;&gt;&gt; client = Client(&#39;test@obspy.org&#39;, &#39;webdc.eu&#39;, 18001)</span>
<span class="sd">        &gt;&gt;&gt; t = UTCDateTime(2009, 1, 1)</span>
<span class="sd">        &gt;&gt;&gt; client.save_response(&#39;BW.MANZ..EHZ.dataless&#39;, &#39;BW&#39;, &#39;MANZ&#39;, &#39;&#39;,</span>
<span class="sd">        ...                      &#39;*&#39;, t, t + 1, format=&quot;SEED&quot;) # doctest: +SKIP</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check format</span>
        <span class="nb">format</span> <span class="o">=</span> <span class="nb">format</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>

        <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s2">&quot;SEED&quot;</span><span class="p">:</span>
            <span class="c1"># request type</span>
            <span class="n">rtype</span> <span class="o">=</span> <span class="s1">&#39;REQUEST RESPONSE format=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">format</span>
            <span class="c1"># request data</span>
            <span class="n">rdata</span> <span class="o">=</span> <span class="p">[</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">location</span><span class="p">]</span>
            <span class="c1"># fetch dataless</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">rtype</span><span class="p">,</span> <span class="n">rdata</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Unsupported format </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">format</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;write&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">write</span><span class="p">,</span> <span class="s2">&quot;__call__&quot;</span><span class="p">):</span>
            <span class="n">filename</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
                <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getInventory&#39; has been renamed to &#39;get_inventory&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getInventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.get_inventory"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.get_inventory.html#obspy.clients.arclink.client.Client.get_inventory">[docs]</a>    <span class="k">def</span> <span class="nf">get_inventory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
                      <span class="n">starttime</span><span class="o">=</span><span class="n">UTCDateTime</span><span class="p">(),</span> <span class="n">endtime</span><span class="o">=</span><span class="n">UTCDateTime</span><span class="p">(),</span>
                      <span class="n">instruments</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sensortype</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                      <span class="n">min_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_latitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">min_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">max_longitude</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">restricted</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">permanent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modified_after</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns information about the available networks and stations in that</span>
<span class="sd">        particular space/time region.</span>

<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :type station: str</span>
<span class="sd">        :param station: Station code, e.g. ``&#39;MANZ&#39;``. Station code may contain</span>
<span class="sd">            wild cards.</span>
<span class="sd">        :type location: str</span>
<span class="sd">        :param location: Location code, e.g. ``&#39;01&#39;``. Location code may</span>
<span class="sd">            contain wild cards.</span>
<span class="sd">        :type channel: str</span>
<span class="sd">        :param channel: Channel code, e.g. ``&#39;EHE&#39;``. Channel code may contain</span>
<span class="sd">            wild cards.</span>
<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Start date and time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: End date and time.</span>
<span class="sd">        :type instruments: bool, optional</span>
<span class="sd">        :param instruments: Include instrument data (default is ``False``).</span>
<span class="sd">        :type route: bool, optional</span>
<span class="sd">        :param route: Enables ArcLink routing (default is ``True``).</span>
<span class="sd">        :type sensortype: str, optional</span>
<span class="sd">        :param sensortype: Limit streams to those using specific sensor types:</span>
<span class="sd">            ``&quot;VBB&quot;``, ``&quot;BB&quot;``, ``&quot;SM&quot;``, ``&quot;OBS&quot;``, etc. Can be also a</span>
<span class="sd">            combination like ``&quot;VBB+BB+SM&quot;``.</span>
<span class="sd">        :type min_latitude: float, optional</span>
<span class="sd">        :param min_latitude: Minimum latitude.</span>
<span class="sd">        :type max_latitude: float, optional</span>
<span class="sd">        :param max_latitude: Maximum latitude.</span>
<span class="sd">        :type min_longitude: float, optional</span>
<span class="sd">        :param min_longitude: Minimum longitude.</span>
<span class="sd">        :type max_longitude: float, optional</span>
<span class="sd">        :param max_longitude: Maximum longitude</span>
<span class="sd">        :type permanent: bool, optional</span>
<span class="sd">        :param permanent: Requesting only permanent or temporary networks</span>
<span class="sd">            respectively. Default is ``None``, therefore requesting all data.</span>
<span class="sd">        :type restricted: bool, optional</span>
<span class="sd">        :param restricted: Requesting only networks/stations/streams that have</span>
<span class="sd">            restricted or open data respectively. Default is ``None``.</span>
<span class="sd">        :type modified_after: :class:`~obspy.core.utcdatetime.UTCDateTime`,</span>
<span class="sd">            optional</span>
<span class="sd">        :param modified_after: Returns only data modified after given date.</span>
<span class="sd">            Default is ``None``, returning all available data.</span>
<span class="sd">        :return: Dictionary of inventory information.</span>

<span class="sd">        .. rubric:: Example</span>

<span class="sd">        &gt;&gt;&gt; from obspy.clients.arclink import Client</span>
<span class="sd">        &gt;&gt;&gt; client = Client(&#39;test@obspy.org&#39;, &#39;webdc.eu&#39;, 18001)</span>
<span class="sd">        &gt;&gt;&gt; inv = client.get_inventory(&#39;BW&#39;, &#39;M*&#39;, &#39;*&#39;, &#39;EHZ&#39;,</span>
<span class="sd">        ...                            restricted=False,</span>
<span class="sd">        ...                            permanent=True, min_longitude=12,</span>
<span class="sd">        ...                            max_longitude=12.2) #doctest: +SKIP</span>
<span class="sd">        &gt;&gt;&gt; inv.keys()  # doctest: +SKIP</span>
<span class="sd">        [&#39;BW.MROB&#39;, &#39;BW.MANZ..EHZ&#39;, &#39;BW&#39;, &#39;BW.MANZ&#39;, &#39;BW.MROB..EHZ&#39;]</span>
<span class="sd">        &gt;&gt;&gt; inv[&#39;BW&#39;]  # doctest: +SKIP</span>
<span class="sd">        AttribDict({&#39;description&#39;: &#39;BayernNetz&#39;, &#39;region&#39;: &#39;Germany&#39;, ...</span>
<span class="sd">        &gt;&gt;&gt; inv[&#39;BW.MROB&#39;]  # doctest: +SKIP</span>
<span class="sd">        AttribDict({&#39;code&#39;: &#39;MROB&#39;, &#39;description&#39;: &#39;Rosenbuehl, Bavaria&#39;, ...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># request type</span>
        <span class="n">rtype</span> <span class="o">=</span> <span class="s1">&#39;REQUEST INVENTORY &#39;</span>
        <span class="k">if</span> <span class="n">instruments</span><span class="p">:</span>
            <span class="n">rtype</span> <span class="o">+=</span> <span class="s1">&#39;instruments=true &#39;</span>
        <span class="k">if</span> <span class="n">modified_after</span><span class="p">:</span>
            <span class="n">rtype</span> <span class="o">+=</span> <span class="s1">&#39;modified_after=</span><span class="si">%s</span><span class="s1"> &#39;</span> <span class="o">%</span> <span class="n">modified_after</span><span class="o">.</span><span class="n">format_arclink</span><span class="p">()</span>
        <span class="c1"># request data</span>
        <span class="n">rdata</span> <span class="o">=</span> <span class="p">[</span><span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">station</span><span class="p">,</span> <span class="n">channel</span><span class="p">,</span> <span class="n">location</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">restricted</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;restricted=true&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">restricted</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;restricted=false&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">permanent</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;permanent=true&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">permanent</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;permanent=false&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sensortype</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;sensortype=</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">sensortype</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">min_latitude</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;latmin=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">min_latitude</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_latitude</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;latmax=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">max_latitude</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">min_longitude</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;lonmin=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">min_longitude</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">max_longitude</span><span class="p">:</span>
            <span class="n">rdata</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;lonmax=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">max_longitude</span><span class="p">)</span>
        <span class="c1"># fetch plain XML document</span>
        <span class="k">if</span> <span class="n">network</span> <span class="o">==</span> <span class="s1">&#39;*&#39;</span><span class="p">:</span>
            <span class="c1"># set route to False if not network id is given</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">rtype</span><span class="p">,</span> <span class="n">rdata</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fetch</span><span class="p">(</span><span class="n">rtype</span><span class="p">,</span> <span class="n">rdata</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="n">route</span><span class="p">)</span>
        <span class="c1"># parse XML document</span>
        <span class="n">xml_doc</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="c1"># get routing version</span>
        <span class="k">if</span> <span class="n">_INVENTORY_NS_1_0</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">nsmap</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">xml_ns</span> <span class="o">=</span> <span class="n">_INVENTORY_NS_1_0</span>
            <span class="n">stream_ns</span> <span class="o">=</span> <span class="s1">&#39;sensorLocation&#39;</span>
            <span class="n">component_ns</span> <span class="o">=</span> <span class="s1">&#39;stream&#39;</span>
            <span class="n">seismometer_ns</span> <span class="o">=</span> <span class="s1">&#39;sensor&#39;</span>
            <span class="n">name_ns</span> <span class="o">=</span> <span class="s1">&#39;publicID&#39;</span>
            <span class="n">resp_paz_ns</span> <span class="o">=</span> <span class="s1">&#39;responsePAZ&#39;</span>
        <span class="k">elif</span> <span class="n">_INVENTORY_NS_0_2</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">nsmap</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
            <span class="n">xml_ns</span> <span class="o">=</span> <span class="n">_INVENTORY_NS_0_2</span>
            <span class="n">stream_ns</span> <span class="o">=</span> <span class="s1">&#39;seis_stream&#39;</span>
            <span class="n">component_ns</span> <span class="o">=</span> <span class="s1">&#39;component&#39;</span>
            <span class="n">seismometer_ns</span> <span class="o">=</span> <span class="s1">&#39;seismometer&#39;</span>
            <span class="n">name_ns</span> <span class="o">=</span> <span class="s1">&#39;name&#39;</span>
            <span class="n">resp_paz_ns</span> <span class="o">=</span> <span class="s1">&#39;resp_paz&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Unknown inventory namespace </span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="n">ArcLinkException</span><span class="p">(</span><span class="n">msg</span> <span class="o">%</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">nsmap</span><span class="p">)</span>

        <span class="n">sensors</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">sensor</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns:sensor&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">}):</span>
            <span class="n">entry</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;manufacturer&#39;</span><span class="p">,</span> <span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;unit&#39;</span><span class="p">,</span> <span class="s1">&#39;response&#39;</span><span class="p">]:</span>
                <span class="n">entry</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">sensor</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">sensors</span><span class="p">[</span><span class="n">entry</span><span class="p">[</span><span class="s1">&#39;response&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">entry</span>

        <span class="c1"># convert into dictionary</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">network</span> <span class="ow">in</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns:network&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">}):</span>
            <span class="n">net</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">()</span>
            <span class="c1"># strings</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;archive&#39;</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;institutions&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;net_class&#39;</span><span class="p">,</span> <span class="s1">&#39;region&#39;</span><span class="p">,</span> <span class="s1">&#39;type&#39;</span><span class="p">]:</span>
                <span class="n">net</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="c1"># restricted</span>
            <span class="k">if</span> <span class="n">network</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;false&#39;</span><span class="p">:</span>
                <span class="n">net</span><span class="p">[</span><span class="s1">&#39;restricted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">net</span><span class="p">[</span><span class="s1">&#39;restricted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="c1"># date / times</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">net</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">net</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">net</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">net</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="c1"># remark</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">net</span><span class="o">.</span><span class="n">remark</span> <span class="o">=</span> <span class="n">network</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span>
                    <span class="s1">&#39;ns:remark&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">net</span><span class="o">.</span><span class="n">remark</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="c1"># write network entries</span>
            <span class="n">data</span><span class="p">[</span><span class="n">net</span><span class="o">.</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">net</span>
            <span class="c1"># stations</span>
            <span class="k">for</span> <span class="n">station</span> <span class="ow">in</span> <span class="n">network</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns0:station&#39;</span><span class="p">,</span>
                                         <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns0&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">}):</span>
                <span class="n">sta</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">()</span>
                <span class="c1"># strings</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;affiliation&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;place&#39;</span><span class="p">,</span> <span class="s1">&#39;restricted&#39;</span><span class="p">,</span> <span class="s1">&#39;archive_net&#39;</span><span class="p">]:</span>
                    <span class="n">sta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
                <span class="c1"># floats</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;elevation&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;depth&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span><span class="p">]:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">sta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">station</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">))</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">sta</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="c1"># restricted</span>
                <span class="k">if</span> <span class="n">station</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;restricted&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;false&#39;</span><span class="p">:</span>
                    <span class="n">sta</span><span class="p">[</span><span class="s1">&#39;restricted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">sta</span><span class="p">[</span><span class="s1">&#39;restricted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="c1"># date / times</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">station</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">start</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">station</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">end</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="c1"># remark</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">remark</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span>
                        <span class="s1">&#39;ns:remark&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">})[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="ow">or</span> <span class="s1">&#39;&#39;</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="n">sta</span><span class="o">.</span><span class="n">remark</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                <span class="c1"># write station entry</span>
                <span class="n">data</span><span class="p">[</span><span class="n">net</span><span class="o">.</span><span class="n">code</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span> <span class="o">+</span> <span class="n">sta</span><span class="o">.</span><span class="n">code</span><span class="p">]</span> <span class="o">=</span> <span class="n">sta</span>
                <span class="c1"># instruments</span>
                <span class="k">for</span> <span class="n">stream</span> <span class="ow">in</span> <span class="n">station</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns:&#39;</span> <span class="o">+</span> <span class="n">stream_ns</span><span class="p">,</span>
                                            <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">}):</span>
                    <span class="c1"># fetch component</span>
                    <span class="k">for</span> <span class="n">comp</span> <span class="ow">in</span> <span class="n">stream</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns:&#39;</span> <span class="o">+</span> <span class="n">component_ns</span><span class="p">,</span>
                                             <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">}):</span>
                        <span class="c1"># date / times</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">start</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">end</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">end</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="c1"># check date/time boundaries</span>
                        <span class="k">if</span> <span class="n">start</span> <span class="o">&gt;</span> <span class="n">endtime</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">end</span> <span class="ow">and</span> <span class="n">starttime</span> <span class="o">&gt;</span> <span class="n">end</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="k">if</span> <span class="n">xml_ns</span> <span class="o">==</span> <span class="n">_INVENTORY_NS_0_2</span><span class="p">:</span>
                            <span class="n">seismometer_id</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">seismometer_ns</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">seismometer_id</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">seismometer_ns</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
                        <span class="c1"># channel id</span>
                        <span class="k">if</span> <span class="n">xml_ns</span> <span class="o">==</span> <span class="n">_INVENTORY_NS_0_2</span><span class="p">:</span>
                            <span class="c1"># channel code is split into two attributes</span>
                            <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">net</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                                           <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;loc_code&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                                           <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;  &#39;</span><span class="p">)</span> <span class="o">+</span>
                                           <span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)])</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">id</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">net</span><span class="o">.</span><span class="n">code</span><span class="p">,</span> <span class="n">sta</span><span class="o">.</span><span class="n">code</span><span class="p">,</span>
                                           <span class="n">stream</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                                           <span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;code&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)])</span>
                        <span class="c1"># write channel entry</span>
                        <span class="k">if</span> <span class="nb">id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                            <span class="n">data</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                        <span class="n">temp</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">()</span>
                        <span class="n">data</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">temp</span><span class="p">)</span>

                        <span class="c1"># fetch sensitivity etc</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gain&#39;</span><span class="p">))</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="c1"># again keep it backwards compatible</span>
                        <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;gain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity&#39;</span><span class="p">]</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity_frequency&#39;</span><span class="p">]</span> <span class="o">=</span> \
                                <span class="nb">float</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gainFrequency&#39;</span><span class="p">))</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity_frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity_unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;gainUnit&#39;</span><span class="p">)</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity_unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

                        <span class="c1"># date / times</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;starttime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;starttime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;endtime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="n">comp</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;endtime&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">instruments</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">seismometer_id</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="c1"># PAZ</span>
                        <span class="n">paz_id</span> <span class="o">=</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns:&#39;</span> <span class="o">+</span> <span class="n">seismometer_ns</span> <span class="o">+</span>
                                               <span class="s1">&#39;[@&#39;</span> <span class="o">+</span> <span class="n">name_ns</span> <span class="o">+</span> <span class="s1">&#39;=&quot;&#39;</span> <span class="o">+</span>
                                               <span class="n">seismometer_id</span> <span class="o">+</span> <span class="s1">&#39;&quot;]/@response&#39;</span><span class="p">,</span>
                                               <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">})</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">paz_id</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="n">paz_id</span> <span class="o">=</span> <span class="n">paz_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                        <span class="c1"># hack for 0.2 schema</span>
                        <span class="k">if</span> <span class="n">paz_id</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;paz:&#39;</span><span class="p">):</span>
                            <span class="n">paz_id</span> <span class="o">=</span> <span class="n">paz_id</span><span class="p">[</span><span class="mi">4</span><span class="p">:]</span>
                        <span class="n">xml_paz</span> <span class="o">=</span> <span class="n">xml_doc</span><span class="o">.</span><span class="n">xpath</span><span class="p">(</span><span class="s1">&#39;ns:&#39;</span> <span class="o">+</span> <span class="n">resp_paz_ns</span> <span class="o">+</span> <span class="s1">&#39;[@&#39;</span> <span class="o">+</span>
                                                <span class="n">name_ns</span> <span class="o">+</span> <span class="s1">&#39;=&quot;&#39;</span> <span class="o">+</span> <span class="n">paz_id</span> <span class="o">+</span> <span class="s1">&#39;&quot;]&#39;</span><span class="p">,</span>
                                                <span class="n">namespaces</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ns&#39;</span><span class="p">:</span> <span class="n">xml_ns</span><span class="p">})</span>
                        <span class="k">if</span> <span class="ow">not</span> <span class="n">xml_paz</span><span class="p">:</span>
                            <span class="k">continue</span>
                        <span class="c1"># parse PAZ</span>
                        <span class="n">paz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parse_paz</span><span class="p">(</span><span class="n">xml_paz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xml_ns</span><span class="p">)</span>

                        <span class="c1"># convert from Hz (Analog) to rad/s (Laplace)</span>
                        <span class="k">if</span> <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;B&quot;</span><span class="p">:</span>

                            <span class="k">def</span> <span class="nf">x2pi</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                                <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>

                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">x2pi</span><span class="p">,</span> <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">]))</span>
                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">x2pi</span><span class="p">,</span> <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">]))</span>
                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_factor&#39;</span><span class="p">]</span> <span class="o">=</span> \
                                <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_factor&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">**</span> \
                                <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">paz</span><span class="p">[</span><span class="s1">&#39;poles&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">paz</span><span class="p">[</span><span class="s1">&#39;zeros&#39;</span><span class="p">]))</span>
                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;gain&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;normalization_factor&#39;</span><span class="p">]</span>
                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;response_type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span>

                        <span class="c1"># sensitivity</span>
                        <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;sensitivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity&#39;</span><span class="p">]</span>
                        <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;sensitivity_frequency&#39;</span><span class="p">]</span> <span class="o">=</span> \
                            <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity_frequency&#39;</span><span class="p">]</span>
                        <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;sensitivity_unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;sensitivity_unit&#39;</span><span class="p">]</span>
                        <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;paz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">paz</span>

                        <span class="c1"># add some seismometer-specific &quot;nice to have&quot; stuff</span>
                        <span class="n">public_id</span> <span class="o">=</span> <span class="n">xml_paz</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;publicID&#39;</span><span class="p">)</span>
                        <span class="k">try</span><span class="p">:</span>
                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;sensor_manufacturer&#39;</span><span class="p">]</span> <span class="o">=</span> \
                                <span class="n">sensors</span><span class="p">[</span><span class="n">public_id</span><span class="p">][</span><span class="s1">&#39;manufacturer&#39;</span><span class="p">]</span>
                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;sensor_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sensors</span><span class="p">[</span><span class="n">public_id</span><span class="p">][</span><span class="s1">&#39;model&#39;</span><span class="p">]</span>
                        <span class="k">except</span><span class="p">:</span>
                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;sensor_manufacturer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
                            <span class="n">paz</span><span class="p">[</span><span class="s1">&#39;sensor_model&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="n">data</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getNetworks&#39; has been renamed to &#39;get_networks&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getNetworks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_networks</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.get_networks"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.get_networks.html#obspy.clients.arclink.client.Client.get_networks">[docs]</a>    <span class="k">def</span> <span class="nf">get_networks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of available networks within the given time span.</span>

<span class="sd">        .. note::</span>
<span class="sd">            Currently the time span seems to be ignored by the ArcLink servers,</span>
<span class="sd">            therefore all possible networks are returned.</span>

<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Start date and time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: End date and time.</span>
<span class="sd">        :return: Dictionary of network data.</span>
<span class="sd">        :type route: bool, optional</span>
<span class="sd">        :param route: Enables ArcLink routing (default is ``False``).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span> <span class="n">starttime</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span>
                                  <span class="n">endtime</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="n">route</span><span class="p">)</span></div>

    <span class="nd">@deprecated</span><span class="p">(</span><span class="s2">&quot;&#39;getStations&#39; has been renamed to &#39;get_stations&#39;. Use &quot;</span>
                <span class="s2">&quot;that instead.&quot;</span><span class="p">)</span>  <span class="c1"># noqa</span>
    <span class="k">def</span> <span class="nf">getStations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_stations</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Client.get_stations"><a class="viewcode-back" href="../../../../packages/autogen/obspy.clients.arclink.client.Client.get_stations.html#obspy.clients.arclink.client.Client.get_stations">[docs]</a>    <span class="k">def</span> <span class="nf">get_stations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">starttime</span><span class="p">,</span> <span class="n">endtime</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dictionary of available stations in the given network(s).</span>

<span class="sd">        .. note::</span>
<span class="sd">            Currently the time span seems to be ignored by the ArcLink servers,</span>
<span class="sd">            therefore all possible stations are returned.</span>

<span class="sd">        :type starttime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param starttime: Start date and time.</span>
<span class="sd">        :type endtime: :class:`~obspy.core.utcdatetime.UTCDateTime`</span>
<span class="sd">        :param endtime: End date and time.</span>
<span class="sd">        :type network: str</span>
<span class="sd">        :param network: Network code, e.g. ``&#39;BW&#39;``.</span>
<span class="sd">        :return: Dictionary of station data.</span>
<span class="sd">        :type route: bool, optional</span>
<span class="sd">        :param route: Enables ArcLink routing (default is ``True``).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_inventory</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span> <span class="n">starttime</span><span class="o">=</span><span class="n">starttime</span><span class="p">,</span>
                                  <span class="n">endtime</span><span class="o">=</span><span class="n">endtime</span><span class="p">,</span> <span class="n">route</span><span class="o">=</span><span class="n">route</span><span class="p">)</span>
        <span class="n">stations</span> <span class="o">=</span> <span class="p">[</span><span class="n">value</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">key</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="n">network</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span> <span class="ow">and</span>
                    <span class="s2">&quot;code&quot;</span> <span class="ow">in</span> <span class="n">value</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">stations</span></div></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">doctest</span>
    <span class="n">doctest</span><span class="o">.</span><span class="n">testmod</span><span class="p">(</span><span class="n">exclude_empty</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>

</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a> &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, lafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Kufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaim, Sbastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clment</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Khler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>