<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>14. Seismometer Correction/Simulation &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="15. Clone an Existing Dataless SEED File" href="clone_dataless_seed.html" />
    <link rel="prev" title="13. Poles and Zeros, Frequency Response" href="frequency_response.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="http://docs.obspy.org/search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../py-modindex.html" title="Python Module Index"
         >modules</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="clone_dataless_seed.html" title="15. Clone an Existing Dataless SEED File"
         accesskey="N">next</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="frequency_response.html" title="13. Poles and Zeros, Frequency Response"
         accesskey="P">previous</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../index.html" accesskey="U">ObsPy Tutorial</a></li> 
    </ol>
  
  <div class="section" id="seismometer-correction-simulation">
<h1>14. Seismometer Correction/Simulation<a class="headerlink" href="#seismometer-correction-simulation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="calculating-response-from-filter-stages-using-evalresp">
<h2>14.1. Calculating response from filter stages using evalresp..<a class="headerlink" href="#calculating-response-from-filter-stages-using-evalresp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="using-a-stationxml-file-or-in-general-an-inventory-object">
<h3>14.1.1. ..using a StationXML file or in general an <a class="reference internal" href="../../packages/autogen/obspy.core.inventory.inventory.Inventory.html#obspy.core.inventory.inventory.Inventory" title="obspy.core.inventory.inventory.Inventory"><code class="xref py py-class docutils literal"><span class="pre">Inventory</span></code></a> object<a class="headerlink" href="#using-a-stationxml-file-or-in-general-an-inventory-object" title="Permalink to this headline">¶</a></h3>
<p>When using the <a class="reference internal" href="../../packages/autogen/obspy.clients.fdsn.client.Client.html#obspy.clients.fdsn.client.Client" title="obspy.clients.fdsn.client.Client"><code class="xref py py-class docutils literal"><span class="pre">FDSN</span> <span class="pre">client</span></code></a> the response can
directly be attached to the waveforms and then subsequently removed using
<a class="reference internal" href="../../packages/autogen/obspy.core.stream.Stream.remove_response.html#obspy.core.stream.Stream.remove_response" title="obspy.core.stream.Stream.remove_response"><code class="xref py py-meth docutils literal"><span class="pre">Stream.remove_response()</span></code></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">UTCDateTime</span>
<span class="kn">from</span> <span class="nn">obspy.clients.fdsn</span> <span class="kn">import</span> <span class="n">Client</span>

<span class="n">t1</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2010-09-3T16:30:00.000&quot;</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2010-09-3T17:00:00.000&quot;</span><span class="p">)</span>
<span class="n">fdsn_client</span> <span class="o">=</span> <span class="n">Client</span><span class="p">(</span><span class="s1">&#39;IRIS&#39;</span><span class="p">)</span>
<span class="c1"># Fetch waveform from IRIS FDSN web service into a ObsPy stream object</span>
<span class="c1"># and automatically attach correct response</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">fdsn_client</span><span class="o">.</span><span class="n">get_waveforms</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="s1">&#39;NZ&#39;</span><span class="p">,</span> <span class="n">station</span><span class="o">=</span><span class="s1">&#39;BFZ&#39;</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="s1">&#39;10&#39;</span><span class="p">,</span>
                               <span class="n">channel</span><span class="o">=</span><span class="s1">&#39;HHZ&#39;</span><span class="p">,</span> <span class="n">starttime</span><span class="o">=</span><span class="n">t1</span><span class="p">,</span> <span class="n">endtime</span><span class="o">=</span><span class="n">t2</span><span class="p">,</span>
                               <span class="n">attach_response</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="c1"># define a filter band to prevent amplifying noise during the deconvolution</span>
<span class="n">pre_filt</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">remove_response</span><span class="p">(</span><span class="n">output</span><span class="o">=</span><span class="s1">&#39;DISP&#39;</span><span class="p">,</span> <span class="n">pre_filt</span><span class="o">=</span><span class="n">pre_filt</span><span class="p">)</span>
</pre></div>
</div>
<p>Alternatively an <a class="reference internal" href="../../packages/autogen/obspy.core.inventory.inventory.Inventory.html#obspy.core.inventory.inventory.Inventory" title="obspy.core.inventory.inventory.Inventory"><code class="xref py py-class docutils literal"><span class="pre">Inventory</span></code></a> object can
be directly passed to the
<a class="reference internal" href="../../packages/autogen/obspy.core.stream.Stream.remove_response.html#obspy.core.stream.Stream.remove_response" title="obspy.core.stream.Stream.remove_response"><code class="xref py py-meth docutils literal"><span class="pre">Stream.remove_response()</span></code></a>:
method:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">read</span><span class="p">,</span> <span class="n">read_inventory</span>

<span class="c1"># simply use the included example waveform</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">read</span><span class="p">()</span>
<span class="c1"># the corresponding response is included in ObsPy as a StationXML file</span>
<span class="n">inv</span> <span class="o">=</span> <span class="n">read_inventory</span><span class="p">()</span>
<span class="c1"># the routine automatically picks the correct response for each trace</span>
<span class="c1"># define a filter band to prevent amplifying noise during the deconvolution</span>
<span class="n">pre_filt</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">remove_response</span><span class="p">(</span><span class="n">inventory</span><span class="o">=</span><span class="n">inv</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;DISP&#39;</span><span class="p">,</span> <span class="n">pre_filt</span><span class="o">=</span><span class="n">pre_filt</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the <cite>plot</cite> option it is possible to visualize the individual steps during
response removal in the frequency domain to check the chosen <cite>pre_filt</cite> and
<cite>water_level</cite> options to stabilize the deconvolution of the inverted instrument
response spectrum:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">obspy</span> <span class="kn">import</span> <span class="n">read</span><span class="p">,</span> <span class="n">read_inventory</span>

<span class="n">st</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="s2">&quot;/path/to/IU_ULN_00_LH1_2015-07-18T02.mseed&quot;</span><span class="p">)</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">inv</span> <span class="o">=</span> <span class="n">read_inventory</span><span class="p">(</span><span class="s2">&quot;/path/to/IU_ULN_00_LH1.xml&quot;</span><span class="p">)</span>
<span class="n">pre_filt</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
<span class="n">tr</span><span class="o">.</span><span class="n">remove_response</span><span class="p">(</span><span class="n">inventory</span><span class="o">=</span><span class="n">inv</span><span class="p">,</span> <span class="n">pre_filt</span><span class="o">=</span><span class="n">pre_filt</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;DISP&quot;</span><span class="p">,</span>
                   <span class="n">water_level</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_5.py">Source code</a>, <a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_5.png">png</a>, <a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_5.hires.png">hires.png</a>)</p>
<div class="figure">
<img alt="../../_images/seismometer_correction_simulation_51.png" class="img-responsive" src="../../_images/seismometer_correction_simulation_51.png" />
</div>
</div>
<div class="section" id="using-a-resp-file">
<h3>14.1.2. ..using a RESP file<a class="headerlink" href="#using-a-resp-file" title="Permalink to this headline">¶</a></h3>
<p>It is further possible to use <a class="reference external" href="https://ds.iris.edu/ds/nodes/dmc/software/downloads/evalresp/">evalresp</a> to evaluate the instrument
response information from a RESP file.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">obspy</span>
<span class="kn">from</span> <span class="nn">obspy.core.util</span> <span class="kn">import</span> <span class="n">NamedTemporaryFile</span>
<span class="kn">from</span> <span class="nn">obspy.clients.fdsn</span> <span class="kn">import</span> <span class="n">Client</span> <span class="k">as</span> <span class="n">FDSN_Client</span>
<span class="kn">from</span> <span class="nn">obspy.clients.iris</span> <span class="kn">import</span> <span class="n">Client</span> <span class="k">as</span> <span class="n">OldIris_Client</span>


<span class="c1"># MW 7.1 Darfield earthquake, New Zealand</span>
<span class="n">t1</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2010-09-3T16:30:00.000&quot;</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;2010-09-3T17:00:00.000&quot;</span><span class="p">)</span>

<span class="c1"># Fetch waveform from IRIS FDSN web service into a ObsPy stream object</span>
<span class="n">fdsn_client</span> <span class="o">=</span> <span class="n">FDSN_Client</span><span class="p">(</span><span class="s2">&quot;IRIS&quot;</span><span class="p">)</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">fdsn_client</span><span class="o">.</span><span class="n">get_waveforms</span><span class="p">(</span><span class="s1">&#39;NZ&#39;</span><span class="p">,</span> <span class="s1">&#39;BFZ&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;HHZ&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span>

<span class="c1"># Download and save instrument response file into a temporary file</span>
<span class="k">with</span> <span class="n">NamedTemporaryFile</span><span class="p">()</span> <span class="k">as</span> <span class="n">tf</span><span class="p">:</span>
    <span class="n">respf</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">name</span>
    <span class="n">old_iris_client</span> <span class="o">=</span> <span class="n">OldIris_Client</span><span class="p">()</span>
    <span class="c1"># fetch RESP information from &quot;old&quot; IRIS web service, see obspy.fdsn</span>
    <span class="c1"># for accessing the new IRIS FDSN web services</span>
    <span class="n">old_iris_client</span><span class="o">.</span><span class="n">resp</span><span class="p">(</span><span class="s1">&#39;NZ&#39;</span><span class="p">,</span> <span class="s1">&#39;BFZ&#39;</span><span class="p">,</span> <span class="s1">&#39;10&#39;</span><span class="p">,</span> <span class="s1">&#39;HHZ&#39;</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">respf</span><span class="p">)</span>

    <span class="c1"># make a copy to keep our original data</span>
    <span class="n">st_orig</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># define a filter band to prevent amplifying noise during the deconvolution</span>
    <span class="n">pre_filt</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.006</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">35.0</span><span class="p">)</span>

    <span class="c1"># this can be the date of your raw data or any date for which the</span>
    <span class="c1"># SEED RESP-file is valid</span>
    <span class="n">date</span> <span class="o">=</span> <span class="n">t1</span>

    <span class="n">seedresp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">respf</span><span class="p">,</span>  <span class="c1"># RESP filename</span>
                <span class="c1"># when using Trace/Stream.simulate() the &quot;date&quot; parameter can</span>
                <span class="c1"># also be omitted, and the starttime of the trace is then used.</span>
                <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="n">date</span><span class="p">,</span>
                <span class="c1"># Units to return response in (&#39;DIS&#39;, &#39;VEL&#39; or ACC)</span>
                <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;DIS&#39;</span>
                <span class="p">}</span>

    <span class="c1"># Remove instrument response using the information from the given RESP file</span>
    <span class="n">st</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">paz_remove</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">pre_filt</span><span class="o">=</span><span class="n">pre_filt</span><span class="p">,</span> <span class="n">seedresp</span><span class="o">=</span><span class="n">seedresp</span><span class="p">)</span>

<span class="c1"># plot original and simulated data</span>
<span class="n">tr</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tr_orig</span> <span class="o">=</span> <span class="n">st_orig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">tr</span><span class="o">.</span><span class="n">times</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">tr_orig</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;STS-2 [counts]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Displacement [m]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_3.py">Source code</a>, <a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_3.png">png</a>, <a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_3.hires.png">hires.png</a>)</p>
<div class="figure">
<img alt="../../_images/seismometer_correction_simulation_3.png" class="img-responsive" src="../../_images/seismometer_correction_simulation_3.png" />
</div>
</div>
<div class="section" id="using-a-dataless-full-seed-file-or-xmlseed-file">
<h3>14.1.3. ..using a Dataless/Full SEED file (or XMLSEED file)<a class="headerlink" href="#using-a-dataless-full-seed-file-or-xmlseed-file" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference internal" href="../../packages/autogen/obspy.io.xseed.parser.Parser.html#obspy.io.xseed.parser.Parser" title="obspy.io.xseed.parser.Parser"><code class="xref py py-class docutils literal"><span class="pre">Parser</span></code></a> object created using a Dataless SEED
file can also be used. For each trace the respective RESP response data is
extracted internally then. When using
<a class="reference internal" href="../../packages/autogen/obspy.core.stream.Stream.html#obspy.core.stream.Stream" title="obspy.core.stream.Stream"><code class="xref py py-class docutils literal"><span class="pre">Stream</span></code></a>/<a class="reference internal" href="../../packages/autogen/obspy.core.trace.Trace.html#obspy.core.trace.Trace" title="obspy.core.trace.Trace"><code class="xref py py-class docutils literal"><span class="pre">Trace</span></code></a>’s
<a class="reference internal" href="../../packages/autogen/obspy.core.trace.Trace.simulate.html#obspy.core.trace.Trace.simulate" title="obspy.core.trace.Trace.simulate"><code class="xref py py-meth docutils literal"><span class="pre">simulate()</span></code></a> convenience methods the “date”
parameter can be omitted (each trace’s start time is used internally).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">obspy</span>
<span class="kn">from</span> <span class="nn">obspy.io.xseed</span> <span class="k">import</span> <span class="n">Parser</span>


<span class="n">st</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;https://examples.obspy.org/BW.BGLD..EH.D.2010.037&quot;</span><span class="p">)</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">Parser</span><span class="p">(</span><span class="s2">&quot;https://examples.obspy.org/dataless.seed.BW_BGLD&quot;</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">seedresp</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;filename&#39;</span><span class="p">:</span> <span class="n">parser</span><span class="p">,</span> <span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s2">&quot;DIS&quot;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="using-a-paz-dictionary">
<h2>14.2. Using a PAZ dictionary<a class="headerlink" href="#using-a-paz-dictionary" title="Permalink to this headline">¶</a></h2>
<p>The following script shows how to simulate a 1Hz seismometer from a STS-2
seismometer with the given poles and zeros. Poles, zeros, gain
(<em>A0 normalization factor</em>) and sensitivity (<em>overall sensitivity</em>) are
specified as keys of a dictionary.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">obspy</span>
<span class="kn">from</span> <span class="nn">obspy.signal.invsim</span> <span class="kn">import</span> <span class="n">corn_freq_2_paz</span>


<span class="n">paz_sts2</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.037004</span> <span class="o">+</span> <span class="mf">0.037016j</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.037004</span> <span class="o">-</span> <span class="mf">0.037016j</span><span class="p">,</span> <span class="o">-</span><span class="mf">251.33</span> <span class="o">+</span> <span class="mi">0j</span><span class="p">,</span>
              <span class="o">-</span> <span class="mf">131.04</span> <span class="o">-</span> <span class="mf">467.29j</span><span class="p">,</span> <span class="o">-</span><span class="mf">131.04</span> <span class="o">+</span> <span class="mf">467.29j</span><span class="p">],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">60077000.0</span><span class="p">,</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">2516778400.0</span><span class="p">}</span>
<span class="n">paz_1hz</span> <span class="o">=</span> <span class="n">corn_freq_2_paz</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">damp</span><span class="o">=</span><span class="mf">0.707</span><span class="p">)</span>  <span class="c1"># 1Hz instrument</span>
<span class="n">paz_1hz</span><span class="p">[</span><span class="s1">&#39;sensitivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">st</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
<span class="c1"># make a copy to keep our original data</span>
<span class="n">st_orig</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Simulate instrument given poles, zeros and gain of</span>
<span class="c1"># the original and desired instrument</span>
<span class="n">st</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">paz_remove</span><span class="o">=</span><span class="n">paz_sts2</span><span class="p">,</span> <span class="n">paz_simulate</span><span class="o">=</span><span class="n">paz_1hz</span><span class="p">)</span>

<span class="c1"># plot original and simulated data</span>
<span class="n">st_orig</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">st</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_1.py">Source code</a>, <a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_1.png">png</a>, <a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_1.hires.png">hires.png</a>)</p>
<div class="figure">
<img alt="../../_images/seismometer_correction_simulation_11.png" class="img-responsive" src="../../_images/seismometer_correction_simulation_11.png" />
</div>
<p>For more customized plotting we could also work with <a class="reference external" href="http://matplotlib.org/">matplotlib</a> manually from
here:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">tr</span> <span class="o">=</span> <span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tr_orig</span> <span class="o">=</span> <span class="n">st_orig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">npts</span><span class="p">)</span> <span class="o">/</span> <span class="n">tr</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">sampling_rate</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tr_orig</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;STS-2 [counts]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">tr</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;1Hz Instrument [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time [s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_2.py">Source code</a>, <a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_2.png">png</a>, <a class="reference external" href="../../tutorial/code_snippets/seismometer_correction_simulation_2.hires.png">hires.png</a>)</p>
<div class="figure">
<img alt="../../_images/seismometer_correction_simulation_2.png" class="img-responsive" src="../../_images/seismometer_correction_simulation_2.png" />
</div>
</div>
</div>


</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a>™ &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, Ólafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>Käufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>Rothenhäusler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>Bonaimé, Sébastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, Clément</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>Köhler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement n° 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>