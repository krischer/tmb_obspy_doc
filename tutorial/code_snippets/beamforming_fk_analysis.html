<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>9. Beamforming - FK Analysis &#8212; ObsPy Documentation (1.0.3)</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/font.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/base.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.0.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-3.1.0/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="10. Seismogram Envelopes" href="seismogram_envelopes.html" />
    <link rel="prev" title="8. Merging Seismograms" href="merging_seismograms.html" />
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript">
  var shiftWindow = function() { scrollBy(0, -70) };
  if (location.hash) shiftWindow();
  window.addEventListener("hashchange", shiftWindow);
</script>

  </head>
  <body>
<div id="wrapper">
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
<div class="container-fluid">
<div class="navbar-header">
<button data-target=".navbar-collapse" data-toggle="collapse" class="navbar-toggle" type="button">
<span class="sr-only">Toggle navigation</span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a href="/" class="navbar-brand" title="Home"><span class="icon-obspy"></span>&nbsp;ObsPy</a>
</div>
<div class="navbar-collapse collapse">
<form class="navbar-form navbar-right" role="search" method="get" action="http://docs.obspy.org/search.html">
<div class="form-group">
<input type="text" class="form-control" placeholder="Search Docs" name="q">
</div>
</form>
<ul class="nav navbar-nav navbar-right">
<li><a href="https://github.com/obspy/obspy/" title="GitHub"><span class="icon-github iconx2"></span><span class="hidden-sm">&nbsp;GitHub</span></a></li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Documentation"><span class="glyphicon glyphicon-book iconx2"></span><span class="hidden-sm">&nbsp;Documentation</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Getting&nbsp;Started</li>
<li><a href="https://github.com/obspy/obspy/wiki#installation">Installation</a></li>
<li><a href="https://tutorial.obspy.org/">Tutorial</a></li>
<li><a href="http://gallery.obspy.org/">Gallery</a></li>
<li><a href="https://docs.obspy.org/">API&nbsp;Documentation&nbsp;(latest&nbsp;release)</a></li>
<li><a href="https://docs.obspy.org/master/">API&nbsp;Documentation&nbsp;(current&nbsp;master)</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Mailing&nbsp;Lists"><span class="glyphicon glyphicon-envelope iconx2"></span><span class="hidden-sm">&nbsp;Mailing&nbsp;Lists</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li class="dropdown-header">Announcements&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-announcements"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-announcements/"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archive</a></li>
<li class="divider"></li>
<li class="dropdown-header">Users&nbsp;Mailing&nbsp;List&nbsp;(public)</li>
<li><a href="http://lists.swapbytes.de/mailman/listinfo/obspy-users"><span class="glyphicon glyphicon-user"></span>&nbsp;Subscribe</a></li>
<li><a href="http://lists.swapbytes.de/archives/obspy-users"><span class="glyphicon glyphicon-inbox"></span>&nbsp;Archives</a></li>
<li><a href="mailto:users@obspy.org"><span class="glyphicon glyphicon-envelope"></span>&nbsp;Post&nbsp;a&nbsp;message</a></li>
</ul>
</li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" title="Developer&nbsp;Resources"><span class="glyphicon glyphicon-cog iconx2"></span><span class="hidden-sm">&nbsp;Developer&nbsp;Resources</span>&nbsp;<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://gitter.im/obspy/obspy">Gitter</a></li>
<li><a href="https://github.com/obspy/obspy/blob/master/.github/CONTRIBUTING.md">How&nbsp;to&nbsp;contribute</a></li>
<li><a href="http://docs.obspy.org/coding_style.html">Coding&nbsp;Style&nbsp;Guide</a></li>
<li><a href="https://github.com/obspy/obspy/releases/">All&nbsp;Releases</a></li>
<li class="divider"></li>
<li class="dropdown-header">Code&nbsp;Analysis</li>
<li><a href="http://docs.obspy.org/master/pep8/index.html">PEP8</a></li>
<li><a href="http://docs.obspy.org/master/coverage/index.html">Python&nbsp;Coverage</a></li>
<li><a href="http://docs.obspy.org/master/c_coverage/index.html">C&nbsp;Coverage</a></li>
<li><a href="https://coveralls.io/r/obspy/obspy?branch=master">Coveralls</a></li>
<li class="divider"></li>
<li class="dropdown-header">Continuous&nbsp;Integration</li>
<li><a href="http://tests.obspy.org/">Test&nbsp;Reports</a></li>
<li><a href="https://travis-ci.org/obspy/obspy/"><span class="icon-travis"></span>&nbsp;Travis&nbsp;CI</a></li>
<li><a href="https://ci.appveyor.com/project/obspy/obspy"><span class="icon-appveyor"></span>&nbsp;AppVeyor</a></li>
</ul>
</li>
</ul>
</div>
</div>
</nav>

<div id="content" class="container">
  
    <div class="breadcrumb pull-right"><a href="../../genindex.html" title="General Index"
         accesskey="I">index</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="../../py-modindex.html" title="Python Module Index"
         >modules</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="seismogram_envelopes.html" title="10. Seismogram Envelopes"
         accesskey="N">next</a><span style="color: #ccc; padding: 0 5px;">| </span><a href="merging_seismograms.html" title="8. Merging Seismograms"
         accesskey="P">previous</a>
    </div>
    <ol class="breadcrumb">
        <li><a href="../../contents.html">ObsPy Documentation (1.0.3)</a></li>
        <li><a href="../index.html" accesskey="U">ObsPy Tutorial</a></li> 
    </ol>
  
  <div class="section" id="beamforming-fk-analysis">
<h1>9. Beamforming - FK Analysis<a class="headerlink" href="#beamforming-fk-analysis" title="Permalink to this headline">Â¶</a></h1>
<p>The following code shows how to do an FK Analysis with ObsPy. The data are from
the blasting of the AGFA skyscraper in Munich. We execute
<a class="reference internal" href="../../packages/autogen/obspy.signal.array_analysis.array_processing.html#obspy.signal.array_analysis.array_processing" title="obspy.signal.array_analysis.array_processing"><code class="xref py py-func docutils literal"><span class="pre">array_processing()</span></code></a> using the following
settings:</p>
<ul class="simple">
<li>The slowness grid is set to corner values of -3.0 to 3.0 s/km with a step
fraction of <code class="docutils literal"><span class="pre">sl_s</span> <span class="pre">=</span> <span class="pre">0.03</span></code>.</li>
<li>The window length is 1.0 s, using a step fraction of 0.05 s.</li>
<li>The data is bandpass filtered, using corners at 1.0 and 8.0 Hz,
prewhitening is disabled.</li>
<li><code class="docutils literal"><span class="pre">semb_thres</span></code> and <code class="docutils literal"><span class="pre">vel_thres</span></code> are set to infinitesimally small numbers
and must not be changed.</li>
<li>The <code class="docutils literal"><span class="pre">timestamp</span></code> will be written in <code class="docutils literal"><span class="pre">'mlabday'</span></code>, which can be read
directly by our plotting routine.</li>
<li><code class="docutils literal"><span class="pre">stime</span></code> and <code class="docutils literal"><span class="pre">etime</span></code> have to be given in the UTCDateTime format.</li>
</ul>
<p>The output will be stored in <code class="docutils literal"><span class="pre">out</span></code>.</p>
<p>The second half shows how to plot the output. We use the output
<code class="docutils literal"><span class="pre">out</span></code> produced by <a class="reference internal" href="../../packages/autogen/obspy.signal.array_analysis.array_processing.html#obspy.signal.array_analysis.array_processing" title="obspy.signal.array_analysis.array_processing"><code class="xref py py-func docutils literal"><span class="pre">array_processing()</span></code></a>,
which are <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.13)"><code class="xref py py-class docutils literal"><span class="pre">numpy</span> <span class="pre">ndarrays</span></code></a> containing timestamp,
relative power, absolute power, backazimuth, slowness. The colorbar corresponds
to relative power.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="kn">as</span> <span class="nn">mdates</span>

<span class="kn">import</span> <span class="nn">obspy</span>
<span class="kn">from</span> <span class="nn">obspy.core.util</span> <span class="kn">import</span> <span class="n">AttribDict</span>
<span class="kn">from</span> <span class="nn">obspy.imaging.cm</span> <span class="kn">import</span> <span class="n">obspy_sequential</span>
<span class="kn">from</span> <span class="nn">obspy.signal.invsim</span> <span class="kn">import</span> <span class="n">corn_freq_2_paz</span>
<span class="kn">from</span> <span class="nn">obspy.signal.array_analysis</span> <span class="kn">import</span> <span class="n">array_processing</span>


<span class="c1"># Load data</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;https://examples.obspy.org/agfa.mseed&quot;</span><span class="p">)</span>

<span class="c1"># Set PAZ and coordinates for all 5 channels</span>
<span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">-</span> <span class="mf">0.03617j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">+</span> <span class="mf">0.03617j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">205479446.68601453</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108589</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.582967</span><span class="p">})</span>

<span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">-</span> <span class="mf">0.03617j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">+</span> <span class="mf">0.03617j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">205479446.68601453</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108192</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.583120</span><span class="p">})</span>

<span class="n">st</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">-</span> <span class="mf">0.03617j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">+</span> <span class="mf">0.03617j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">250000000.0</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108692</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.583414</span><span class="p">})</span>

<span class="n">st</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">4.39823</span> <span class="o">+</span> <span class="mf">4.48709j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.39823</span> <span class="o">-</span> <span class="mf">4.48709j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">222222228.10910088</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108456</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.583049</span><span class="p">})</span>

<span class="n">st</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">4.39823</span> <span class="o">+</span> <span class="mf">4.48709j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.39823</span> <span class="o">-</span> <span class="mf">4.48709j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.105</span> <span class="o">+</span> <span class="mi">0j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">222222228.10910088</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108730</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.583157</span><span class="p">})</span>


<span class="c1"># Instrument correction to 1Hz corner frequency</span>
<span class="n">paz1hz</span> <span class="o">=</span> <span class="n">corn_freq_2_paz</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">damp</span><span class="o">=</span><span class="mf">0.707</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">paz_remove</span><span class="o">=</span><span class="s1">&#39;self&#39;</span><span class="p">,</span> <span class="n">paz_simulate</span><span class="o">=</span><span class="n">paz1hz</span><span class="p">)</span>

<span class="c1"># Execute array_processing</span>
<span class="n">stime</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;20080217110515&quot;</span><span class="p">)</span>
<span class="n">etime</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;20080217110545&quot;</span><span class="p">)</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="c1"># slowness grid: X min, X max, Y min, Y max, Slow Step</span>
    <span class="n">sll_x</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">slm_x</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">sll_y</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">slm_y</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">sl_s</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
    <span class="c1"># sliding window properties</span>
    <span class="n">win_len</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">win_frac</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="c1"># frequency properties</span>
    <span class="n">frqlow</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">frqhigh</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">prewhiten</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="c1"># restrict output</span>
    <span class="n">semb_thres</span><span class="o">=-</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">vel_thres</span><span class="o">=-</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="s1">&#39;mlabday&#39;</span><span class="p">,</span>
    <span class="n">stime</span><span class="o">=</span><span class="n">stime</span><span class="p">,</span> <span class="n">etime</span><span class="o">=</span><span class="n">etime</span>
<span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">array_processing</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="c1"># Plot</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;rel.power&#39;</span><span class="p">,</span> <span class="s1">&#39;abs.power&#39;</span><span class="p">,</span> <span class="s1">&#39;baz&#39;</span><span class="p">,</span> <span class="s1">&#39;slow&#39;</span><span class="p">]</span>

<span class="n">xlocator</span> <span class="o">=</span> <span class="n">mdates</span><span class="o">.</span><span class="n">AutoDateLocator</span><span class="p">()</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">lab</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">out</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">out</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="n">out</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span>
               <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">obspy_sequential</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">out</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">out</span><span class="p">[:,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">xlocator</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mdates</span><span class="o">.</span><span class="n">AutoDateFormatter</span><span class="p">(</span><span class="n">xlocator</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;AGFA skyscraper blasting in Munich </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
    <span class="n">stime</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1">&#39;</span><span class="p">),</span> <span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">autofmt_xdate</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../tutorial/code_snippets/beamforming_fk_analysis_1.py">Source code</a>, <a class="reference external" href="../../tutorial/code_snippets/beamforming_fk_analysis_1.png">png</a>, <a class="reference external" href="../../tutorial/code_snippets/beamforming_fk_analysis_1.hires.png">hires.png</a>)</p>
<div class="figure">
<img alt="../../_images/beamforming_fk_analysis_11.png" class="img-responsive" src="../../_images/beamforming_fk_analysis_11.png" />
</div>
<p>Another representation would be a polar plot, which sums the relative power in
gridded bins, each defined by backazimuth and slowness of the analyzed signal
part. The backazimuth is counted clockwise from north, the slowness limits can
be set by hand.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.colorbar</span> <span class="kn">import</span> <span class="n">ColorbarBase</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">Normalize</span>

<span class="kn">import</span> <span class="nn">obspy</span>
<span class="kn">from</span> <span class="nn">obspy.core.util</span> <span class="kn">import</span> <span class="n">AttribDict</span>
<span class="kn">from</span> <span class="nn">obspy.imaging.cm</span> <span class="kn">import</span> <span class="n">obspy_sequential</span>
<span class="kn">from</span> <span class="nn">obspy.signal.invsim</span> <span class="kn">import</span> <span class="n">corn_freq_2_paz</span>
<span class="kn">from</span> <span class="nn">obspy.signal.array_analysis</span> <span class="kn">import</span> <span class="n">array_processing</span>


<span class="c1"># Load data</span>
<span class="n">st</span> <span class="o">=</span> <span class="n">obspy</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;https://examples.obspy.org/agfa.mseed&quot;</span><span class="p">)</span>

<span class="c1"># Set PAZ and coordinates for all 5 channels</span>
<span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">-</span> <span class="mf">0.03617j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">+</span> <span class="mf">0.03617j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">205479446.68601453</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108589</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.582967</span><span class="p">})</span>

<span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">-</span> <span class="mf">0.03617j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">+</span> <span class="mf">0.03617j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">205479446.68601453</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108192</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.583120</span><span class="p">})</span>

<span class="n">st</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">-</span> <span class="mf">0.03617j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.03736</span> <span class="o">+</span> <span class="mf">0.03617j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">250000000.0</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108692</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.583414</span><span class="p">})</span>

<span class="n">st</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">4.39823</span> <span class="o">+</span> <span class="mf">4.48709j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.39823</span> <span class="o">-</span> <span class="mf">4.48709j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">222222228.10910088</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108456</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.583049</span><span class="p">})</span>

<span class="n">st</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">paz</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;poles&#39;</span><span class="p">:</span> <span class="p">[(</span><span class="o">-</span><span class="mf">4.39823</span> <span class="o">+</span> <span class="mf">4.48709j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">4.39823</span> <span class="o">-</span> <span class="mf">4.48709j</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mf">2.105</span> <span class="o">+</span> <span class="mi">0j</span><span class="p">)],</span>
    <span class="s1">&#39;zeros&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">,</span> <span class="mi">0j</span><span class="p">],</span>
    <span class="s1">&#39;sensitivity&#39;</span><span class="p">:</span> <span class="mf">222222228.10910088</span><span class="p">,</span>
    <span class="s1">&#39;gain&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">})</span>
<span class="n">st</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">coordinates</span> <span class="o">=</span> <span class="n">AttribDict</span><span class="p">({</span>
    <span class="s1">&#39;latitude&#39;</span><span class="p">:</span> <span class="mf">48.108730</span><span class="p">,</span>
    <span class="s1">&#39;elevation&#39;</span><span class="p">:</span> <span class="mf">0.450000</span><span class="p">,</span>
    <span class="s1">&#39;longitude&#39;</span><span class="p">:</span> <span class="mf">11.583157</span><span class="p">})</span>


<span class="c1"># Instrument correction to 1Hz corner frequency</span>
<span class="n">paz1hz</span> <span class="o">=</span> <span class="n">corn_freq_2_paz</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">damp</span><span class="o">=</span><span class="mf">0.707</span><span class="p">)</span>
<span class="n">st</span><span class="o">.</span><span class="n">simulate</span><span class="p">(</span><span class="n">paz_remove</span><span class="o">=</span><span class="s1">&#39;self&#39;</span><span class="p">,</span> <span class="n">paz_simulate</span><span class="o">=</span><span class="n">paz1hz</span><span class="p">)</span>

<span class="c1"># Execute array_processing</span>
<span class="n">kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="c1"># slowness grid: X min, X max, Y min, Y max, Slow Step</span>
    <span class="n">sll_x</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">slm_x</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">sll_y</span><span class="o">=-</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">slm_y</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">sl_s</span><span class="o">=</span><span class="mf">0.03</span><span class="p">,</span>
    <span class="c1"># sliding window properties</span>
    <span class="n">win_len</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">win_frac</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
    <span class="c1"># frequency properties</span>
    <span class="n">frqlow</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">frqhigh</span><span class="o">=</span><span class="mf">8.0</span><span class="p">,</span> <span class="n">prewhiten</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="c1"># restrict output</span>
    <span class="n">semb_thres</span><span class="o">=-</span><span class="mf">1e9</span><span class="p">,</span> <span class="n">vel_thres</span><span class="o">=-</span><span class="mf">1e9</span><span class="p">,</span>
    <span class="n">stime</span><span class="o">=</span><span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;20080217110515&quot;</span><span class="p">),</span>
    <span class="n">etime</span><span class="o">=</span><span class="n">obspy</span><span class="o">.</span><span class="n">UTCDateTime</span><span class="p">(</span><span class="s2">&quot;20080217110545&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">array_processing</span><span class="p">(</span><span class="n">st</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="c1"># Plot</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">obspy_sequential</span>

<span class="c1"># make output human readable, adjust backazimuth to values between 0 and 360</span>
<span class="n">t</span><span class="p">,</span> <span class="n">rel_power</span><span class="p">,</span> <span class="n">abs_power</span><span class="p">,</span> <span class="n">baz</span><span class="p">,</span> <span class="n">slow</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">T</span>
<span class="n">baz</span><span class="p">[</span><span class="n">baz</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">360</span>

<span class="c1"># choose number of fractions in plot (desirably 360 degree/N is an integer!)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">36</span>
<span class="n">N2</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">abins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mf">360.</span> <span class="o">/</span> <span class="n">N</span>
<span class="n">sbins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">N2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># sum rel power in bins given by abins and sbins</span>
<span class="n">hist</span><span class="p">,</span> <span class="n">baz_edges</span><span class="p">,</span> <span class="n">sl_edges</span> <span class="o">=</span> \
    <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">baz</span><span class="p">,</span> <span class="n">slow</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="p">[</span><span class="n">abins</span><span class="p">,</span> <span class="n">sbins</span><span class="p">],</span> <span class="n">weights</span><span class="o">=</span><span class="n">rel_power</span><span class="p">)</span>

<span class="c1"># transform to radian</span>
<span class="n">baz_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">baz_edges</span><span class="p">)</span>

<span class="c1"># add polar and colorbar axes</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">cax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">])</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.70</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">],</span> <span class="n">polar</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_theta_direction</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_theta_zero_location</span><span class="p">(</span><span class="s2">&quot;N&quot;</span><span class="p">)</span>

<span class="n">dh</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">sl_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">sl_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dw</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">baz_edges</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">baz_edges</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># circle through backazimuth</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hist</span><span class="p">):</span>
    <span class="n">bars</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">dw</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N2</span><span class="p">),</span>
                  <span class="n">height</span><span class="o">=</span><span class="n">dh</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">N2</span><span class="p">),</span>
                  <span class="n">width</span><span class="o">=</span><span class="n">dw</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">dh</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N2</span><span class="p">),</span>
                  <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">row</span> <span class="o">/</span> <span class="n">hist</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">endpoint</span><span class="o">=</span><span class="bp">False</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;S&#39;</span><span class="p">,</span> <span class="s1">&#39;W&#39;</span><span class="p">])</span>

<span class="c1"># set slowness limits</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="p">[</span><span class="n">i</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">()]</span>
<span class="n">ColorbarBase</span><span class="p">(</span><span class="n">cax</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
             <span class="n">norm</span><span class="o">=</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">hist</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">hist</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../tutorial/code_snippets/beamforming_fk_analysis_2.py">Source code</a>, <a class="reference external" href="../../tutorial/code_snippets/beamforming_fk_analysis_2.png">png</a>, <a class="reference external" href="../../tutorial/code_snippets/beamforming_fk_analysis_2.hires.png">hires.png</a>)</p>
<div class="figure">
<img alt="../../_images/beamforming_fk_analysis_21.png" class="img-responsive" src="../../_images/beamforming_fk_analysis_21.png" />
</div>
</div>


</div>

<footer>
<p class="text-muted small">
By the <a href="https://github.com/orgs/obspy/people">ObsPy
Development Team</a> and many <a href="#contributers" role="button"
data-toggle="modal" data-target="#contributers">Awesome Contributors</a>â¢ &nbsp;|&nbsp; Built with
<a href="http://getbootstrap.com/">Bootstrap</a> and
<a href="http://glyphicons.com//">Glyphicons</a> &nbsp;|&nbsp; Copyright 2008-2016
</p>
</footer>
<div id="contributers" class="modal fade" tabindex="-1"
role="dialog" aria-labelledby="contributersLabel" aria-hidden="true">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<button type="button" class="close" data-dismiss="modal"
aria-hidden="true">&times;</button>
<h3 class="modal-title" id="contributersLabel">Thank you!</h3>
</div>
<div class="modal-body">
<p>We would like to thank our contributors, whose efforts make
this software what it is. These people have helped by writing code
and documentation, and by testing. They have created and
maintained this product, its associated libraries and
applications, our build tools and our web sites.</p>
<h4>Contributors</h4>
<div class="container-fluid">
<div class="row">
<div class="col-md-6">
<ul>
<li>Ammon, Charles J.</li>
<li>Arnarsson, Ãlafur St.</li>
<li>Barsch, Robert</li>
<li>Bernardi, Fabrizio</li>
<li>Beyreuther, Moritz</li>
<li>Carothers, Lloyd</li>
<li>Egdorf, Sven</li>
<li>Ermert, Laura</li>
<li>Fabbri, Tommaso</li>
<li>Grunberg, Marc</li>
<li>Heimann, Sebastian</li>
<li>Hope, Gaute</li>
<li>Inza, Adolfo</li>
<li>Ketchum, David</li>
<li>Kremers, Simon</li>
<li>Krieger, Lars</li>
<li>KÃ¤ufl, Paul</li>
<li>Lecocq, Thomas</li>
<li>Lesage, Philippe</li>
<li>Lopes, Rui L.</li>
<li>Maggi, Alessia</li>
<li>Megies, Tobias</li>
<li>Michelini, Alberto</li>
<li>Morgenstern, Bernhard</li>
<li>Panning, Mark P.</li>
<li>Reyes, Celso</li>
<li>RothenhÃ¤usler, Nicolas</li>
<li>Sales de Andrade, Elliott</li>
<li>Saul, Joachim</li>
<li>Sippl, Christian</li>
<li>Stange, Stefan</li>
<li>Trabant, Chad</li>
<li>Walker, Andrew</li>
<li>Wassermann, Joachim</li>
<li>Winkelman, Andrew</li>
<li>van Driel, Martin</li>
</ul>
</div>
<div class="col-md-6">
<ul>
<li>Antunes, Emanuel</li>
<li>Bank, Markus</li>
<li>Behr, Yannik</li>
<li>Bernauer, Felix</li>
<li>BonaimÃ©, SÃ©bastien</li>
<li>Danecek, Peter</li>
<li>Engels, Fabian</li>
<li>Eulenfeld, Tom</li>
<li>Grellier, ClÃ©ment</li>
<li>Hammer, Conny</li>
<li>Heiniger, Lukas</li>
<li>Igel, Heiner</li>
<li>Isken, Marius</li>
<li>Koymans, Mathijs</li>
<li>Kress, Victor</li>
<li>Krischer, Lion</li>
<li>KÃ¶hler, Andreas</li>
<li>Leeman, John</li>
<li>Lomax, Anthony</li>
<li>MacCarthy, Jonathan</li>
<li>Martin, Henri</li>
<li>Meschede, Matthias</li>
<li>Miller, Nathaniel C.</li>
<li>Nof, Ran Novitsky</li>
<li>Rapagnani, Giovanni</li>
<li>Ringler, Adam</li>
<li>Russo, Emiliano</li>
<li>Satriano, Claudio</li>
<li>Scheingraber, Chris</li>
<li>Snoke, Arthur</li>
<li>Sullivan, Benjamin</li>
<li>Uieda, Leonardo</li>
<li>Walther, Marcus</li>
<li>Williams, Mark C.</li>
<li>Zad, Seyed Kasra Hosseini</li>
</ul>
</div>
</div>
</div>
<h4>Funds</h4>
<p>ObsPy was partially funded by the</p>
<ul>
<li>German Science Foundation (DFG) via grant DFG IG 16/9-1</li>
<li>German Ministry for Education and Research (BMBF), GEOTECHNOLOGIEN grant 03G0646H.</li>
<li>NERA project (Network of European Research Infrastructures for Earthquake Risk Assessment and Mitigation) under the European Community&#39;s Seventh Framework Programme (FP7/2007-2013) grant agreement nÂ° 262330</li>
<li>Leibniz Institute for Applied Geophysics (LIAG)</li>
<li>VERCE EU-FP7 project (no. 283543)</li>
</ul>
</div>
<div class="modal-footer">
<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
</div>
</div>
</div>
</div>

</div>


  </body>
</html>